System.register(["./chakra-legacy-ZZbJd4T8.js","./react-legacy-BhHIMsrB.js","./main-legacy-P3831CTn.js","./index-legacy-DwB7h9wU.js","./rmg-fields-legacy-HD-2hFie.js"],(function(e,n){"use strict";var s,t,i,a,o,r,l,c,h,d,u,x,j,p,g,m,f,v,w,k,z,b,y,C,S,H,M,R,T,O,A,L,I,E,_,P,D,N,V,U,B,F,$,W,G,J,q,K,Y,Q,X,Z,ee,ne,se,te,ie,ae,oe,re,le,ce,he,de,ue,xe,je,pe,ge,me,fe,ve,we,ke,ze,be,ye,Ce,Se,He,Me,Re,Te,Oe,Ae,Le,Ie,Ee,_e,Pe,De,Ne,Ve,Ue,Be,Fe,$e,We,Ge,Je,qe,Ke,Ye,Qe,Xe,Ze,en,nn,sn,tn,an,on,rn,ln,cn,hn;return{setters:[e=>{s=e.j,t=e.aq,i=e.a,a=e.ar,o=e.H,r=e.T,l=e.B,c=e.as,h=e.at,d=e.F,u=e.au,x=e.af,j=e.av,p=e.b,g=e.aw,m=e.Z,f=e.ax,v=e.$,w=e.a0,k=e.a1,z=e.a2,b=e.a6,y=e.a7,C=e.a9,S=e.aa,H=e.ab,M=e.I,R=e.e,T=e.g,O=e.ay,A=e.az,L=e.aA,I=e.aB,E=e.a4,_=e.aC,P=e.aD,D=e.a5,N=e.aE,V=e.aF,U=e.D,B=e.ae,F=e.am,$=e.aG,W=e.aH,G=e.aI,J=e.aJ,q=e.aK,K=e.Q,Y=e.aL,Q=e.aM,X=e.W,Z=e.k,ee=e.P,ne=e.l,se=e.m,te=e.R,ie=e.U,ae=e.V,oe=e.X,re=e.aN,le=e.aO,ce=e.aP,he=e.N},e=>{de=e.m,ue=e.r,xe=e.n,je=e.b,pe=e.B},e=>{ge=e.F,me=e.u,fe=e.a,ve=e.f,we=e.g,ke=e.S,ze=e.b,be=e.A,ye=e.s,Ce=e.c,Se=e.n,He=e.d,Me=e.e,Re=e.l,Te=e.h,Oe=e.i,Ae=e.j,Le=e.k,Ie=e.m,Ee=e.E,_e=e.o,Pe=e.p,De=e.t,Ne=e.q,Ve=e.r,Ue=e.v,Be=e.w,Fe=e.x,$e=e.y,We=e.L,Ge=e.N,Je=e.z,qe=e.B,Ke=e.C,Ye=e.D,Qe=e.G},e=>{Xe=e.l,Ze=e.f,en=e.i,nn=e.e,sn=e.r,tn=e.b,an=e.j,on=e.u,rn=e.k,ln=e.g,cn=e.h},e=>{hn=e.R}],execute:function(){e("default",(function(){const{t:e}=de(),n=fe(),{isPrimary:t,isTerminated:i,isShowMenu:a}=me((e=>e.app)),[o,r]=ue.useState(!1);return ue.useEffect((()=>{sn.isAnalyticsQADone()||r(!0)}),[]),i?s.jsx(ln,{children:s.jsx(Is,{})}):!1===t?s.jsx(ln,{children:s.jsx(As,{})}):s.jsx(pe,{basename:"/",children:s.jsxs(ln,{className:a?"show-menu":"",children:[s.jsx(x,{variant:a?"ghost":"solid",colorScheme:a?void 0:"primary",size:"md","aria-label":e("Toggle menu"),title:e("Toggle menu"),icon:s.jsx(Hn,{}),position:"absolute",zIndex:110,borderRadius:0,onClick:()=>{sn.toggleNavMenu(!a),n(De()),sn.event(Ee.TOGGLE_NAV_MENU)}}),s.jsxs(cn,{sx:{flexDirection:"row"},children:[s.jsx(Rs,{}),s.jsx(mn,{})]}),s.jsx(Ts,{isOpen:o,onClose:()=>r(!1)})]})})}));var n=["en","zh-Hans","zh-Hant"],dn=["ja","ko"],un={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const xn="/assets/rmp-logo512-eHekupnf.png",jn={flex:1,justifyContent:"center",mb:10,"& > div":{mb:3},"& img":{w:120,p:2,backgroundColor:"white",borderRadius:12}};function pn(){const{t:e}=de();return s.jsxs(t,{sx:jn,children:[s.jsxs(i,{spacing:3,children:[s.jsx(a,{src:"/logo512.png"}),s.jsx(a,{src:xn,backgroundColor:"white"})]}),s.jsx(o,{children:e("Welcome to Rail Map Toolkit")}),s.jsx(r,{fontSize:"lg",textAlign:"center",children:e("Select an app to start your own rail map design!")})]})}function gn(e){const{tab:n,isActive:t}=e,i=ue.useMemo((()=>{var e;return null!==(e=n.url)&&void 0!==e?e:"/"+n.app+"/"}),[n.url,n.app]);return s.jsx(l,{display:t?"block":"none",flex:1,children:s.jsx("iframe",{id:ge+n.id,src:i,loading:"lazy",title:n.app,width:"100%",height:"100%"})})}function mn(){const{openedTabs:e,activeTab:n}=me((e=>e.app)),[,t]=xe();return ue.useEffect((()=>{if(n){var s;const i=null===(s=e.find((e=>e.id===n)))||void 0===s?void 0:s.app;t(i?{app:i}:{})}else t({})}),[n]),0===e.length?s.jsx(pn,{}):s.jsx(s.Fragment,{children:e.map((e=>s.jsx(gn,{tab:e,isActive:n===e.id},e.id)))})}function fn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"},child:[]}]})(e)}function vn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},child:[]}]})(e)}function wn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"},child:[]}]})(e)}function kn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(e)}function zn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function bn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"},child:[]}]})(e)}function yn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"},child:[]}]})(e)}function Cn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"},child:[]}]})(e)}function Sn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(e)}function Hn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(e)}function Mn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(e)}function Rn(e){return c({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"},child:[]}]})(e)}const Tn=()=>{const e=h(),{t:n}=de(),t=fe(),{isLoggedIn:i,name:a,token:o,refreshToken:c,saves:j,currentSaveId:p}=me((e=>e.account)),g=n=>e({title:n,status:"error",duration:9e3,isClosable:!0});je.useEffect((()=>{i&&t(ve())}),[i]),je.useEffect((()=>{p&&m()}),[p]);const m=async()=>{var e;const n=await we(ke.RMP);if(!n)return void f();const{hash:s}=n,t=null===(e=j.filter((e=>e.id===p)).at(0))||void 0===e?void 0:e.hash;t&&t!==s&&f()},f=async()=>{const{rep:e,token:s,refreshToken:i}=await ze(be.SAVES+"/"+p,{},o,c);i&&s?(t(ye({access:s,refresh:i})),200===e.status?(Xe.info(`Set ${ke.RMP} with save id: ${p}`),Ce(ke.RMP,await e.text()),Se()):g(await e.text())):g(n("Login status expired"))};return s.jsxs(d,{p:"1",flexDirection:"row",children:[s.jsx(u,{name:i?a:void 0}),s.jsx(l,{ml:"3",alignContent:"center",children:s.jsx(r,{as:"b",children:i?a:n("Log in / Sign up")})}),s.jsx(l,{ml:"auto",alignContent:"center",children:s.jsx(x,{"aria-label":"More account info",variant:"ghost",size:"md",onClick:()=>t(He("account")),icon:s.jsx(yn,{})})})]})},On=()=>{const{t:e}=de(),n=fe(),{isLoggedIn:t,email:a,name:o,refreshToken:l}=me((e=>e.account)),[c,h]=je.useState(void 0);return s.jsxs(Ze,{width:"100%",children:[s.jsxs(j,{width:"100%",children:[s.jsx(u,{size:"md",name:o}),s.jsxs(i,{width:"100%",children:[s.jsx(r,{as:"b",fontSize:"xl",children:a}),s.jsx(p,{size:"sm",ml:"auto",onClick:async()=>{t&&(await fetch(Me+be.AUTH_LOGOUT,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:l})}),n(Re()))},children:e("Log out")})]}),s.jsxs(i,{width:"100%",children:[s.jsx(r,{as:"b",fontSize:"xl",children:o}),s.jsx(p,{size:"sm",ml:"auto",onClick:()=>h("name"),children:e("Change name")})]}),s.jsx(i,{width:"100%",children:s.jsx(p,{size:"sm",ml:"auto",onClick:()=>h("password"),children:e("Change password")})})]}),s.jsx(An,{infoType:c,onClose:()=>h(void 0)})]})};function An(e){const{infoType:n,onClose:t}=e,{t:i}=de(),a=h(),o=fe(),{isLoggedIn:r,id:l,token:c,refreshToken:d}=me((e=>e.account)),[u,x]=je.useState(""),j=e=>a({title:e,status:"error",duration:9e3,isClosable:!0});return s.jsxs(g,{isOpen:!!n,onClose:t,size:"xl",scrollBehavior:"inside",children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsx(v,{children:i("Update account info")}),s.jsx(w,{}),s.jsx(k,{children:s.jsx(en,{defaultValue:u,onDebouncedChange:e=>x(e)})}),s.jsx(z,{children:s.jsx(p,{onClick:async()=>{if(!r||!n)return;const{rep:e,token:s,refreshToken:a}=await ze(be.USER+"/"+l,{method:"PATCH",body:JSON.stringify({[n]:u})},c,d);if(a&&s){if(o(ye({access:s,refresh:a})),200===e.status)return"password"===n?(o(Re()),void t()):"name"===n?(o(Te(u)),void t()):void 0;j(await e.text())}else j(i("Login status expired"))},children:i("Change")})})]})]})}const Ln=e=>{const n=h(),{t:t}=de(),i=fe(),[a,r]=je.useState(""),[l,c]=je.useState(""),[u,x]=je.useState(""),[g,m]=je.useState("");return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:t("Forgot password")})}),g&&s.jsxs(b,{status:"error"===g?"error":"info",children:[s.jsx(y,{}),s.jsx(C,{children:"error"===g?t("Check your email again!"):t("Email with reset link is sent to: ")+g})]}),s.jsxs(d,{p:"3",flexDirection:"column",children:[s.jsxs(S,{children:[s.jsx(H,{children:t("Email")}),s.jsxs(M,{size:"md",children:[s.jsx(R,{type:"email",value:a,onChange:e=>r(e.target.value)}),s.jsx(T,{width:"4.5rem",children:s.jsx(p,{h:"1.75rem",size:"sm",onClick:async()=>{const e=await fetch(Me+be.AUTH_SEND_RESET_PASSWORD_EMAIL,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:a})});204!==e.status?400!==e.status||m("error"):m(a)},children:t("Send reset link")})})]})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Reset password token")}),s.jsx(R,{value:u,onChange:e=>x(e.target.value)})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Password")}),s.jsx(R,{type:"password",value:l,onChange:e=>c(e.target.value)})]}),s.jsxs(j,{mt:"10",children:[s.jsx(p,{onClick:async()=>{const e=new URLSearchParams({token:u}),s=`${Me}${be.AUTH_RESET_PASSWORD}?${e.toString()}`,o=await fetch(s,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:l})});if(204!==o.status)return r=await o.text(),void n({title:r,status:"error",duration:9e3,isClosable:!0});var r;const{error:c,username:h}=(await i(Oe({email:a,password:l}))).payload;n(c?{title:c,status:"error",duration:9e3,isClosable:!0}:{title:t("Welcome ")+h,status:"success",duration:5e3,isClosable:!0})},children:t("Reset password")}),s.jsx(p,{onClick:()=>e.setLoginState("login"),children:t("Back to log in")})]})]})]})},In=e=>{const n=h(),{t:t}=de(),i=fe(),[a,r]=je.useState(""),[l,c]=je.useState("");return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:t("Log in")})}),s.jsxs(d,{p:"3",flexDirection:"column",children:[s.jsxs(S,{children:[s.jsx(H,{children:t("Email")}),s.jsx(R,{type:"email",value:a,onChange:e=>r(e.target.value)})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Password")}),s.jsx(R,{type:"password",value:l,onChange:e=>c(e.target.value)})]}),s.jsxs(j,{mt:"10",children:[s.jsx(p,{onClick:async()=>{const{error:e,username:s}=(await i(Oe({email:a,password:l}))).payload;n(e?{title:e,status:"error",duration:9e3,isClosable:!0}:{title:t("Welcome ")+s,status:"success",duration:5e3,isClosable:!0})},children:t("Log in")}),s.jsx(p,{onClick:()=>e.setLoginState("register"),children:t("Sign up")}),s.jsx(p,{onClick:()=>e.setLoginState("forgot-password"),children:t("Forgot password")})]})]})]})},En=e=>{const n=h(),{t:t}=de(),i=fe(),[a,r]=je.useState(""),[l,c]=je.useState(""),[u,x]=je.useState(""),[g,m]=je.useState(""),[f,v]=je.useState("");return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:t("Sign up")})}),f&&s.jsxs(b,{status:"error"===f?"error":"info",children:[s.jsx(y,{}),s.jsx(C,{children:"error"===f?t("The email is not valid!"):t("Verification email is sent to: ")+f})]}),s.jsxs(d,{p:"3",flexDirection:"column",children:[s.jsxs(j,{spacing:"25px",children:[s.jsxs(S,{children:[s.jsx(H,{children:t("Name")}),s.jsx(R,{type:"text",value:a,onChange:e=>r(e.target.value)}),s.jsx(O,{children:t("You may always change it later.")})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Email")}),s.jsxs(M,{size:"md",children:[s.jsx(R,{type:"email",value:l,onChange:e=>c(e.target.value)}),s.jsx(T,{width:"auto",children:s.jsx(p,{h:"1.75rem",size:"sm",onClick:async()=>{const e=await fetch(Me+be.AUTH_SEND_VERIFICATION_EMAIL,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:l})});204!==e.status?400!==e.status||v("error"):v(l)},children:t("Send verification code")})})]}),s.jsx(O,{children:t("We'll never share your email.")})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Verification code")}),s.jsx(R,{type:"number",value:g,onChange:e=>m(e.target.value)})]}),s.jsxs(S,{children:[s.jsx(H,{children:t("Password")}),s.jsx(R,{type:"password",value:u,onChange:e=>x(e.target.value)})]})]}),s.jsxs(j,{mt:"10",children:[s.jsx(p,{onClick:async()=>{const e=await fetch(Me+be.AUTH_REGISTER,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:a,email:l,password:u,emailVerificationToken:Number(g)})});if(201!==e.status)return s=await e.text(),void n({title:s,status:"error",duration:9e3,isClosable:!0});var s;const{error:o,username:r}=(await i(Oe({email:l,password:u}))).payload;n(o?{title:o,status:"error",duration:9e3,isClosable:!0}:{title:t("Welcome ")+r,status:"success",duration:5e3,isClosable:!0})},children:t("Sign up")}),s.jsx(p,{onClick:()=>e.setLoginState("login"),children:t("Back to log in")})]})]})]})},_n=()=>{const e=h(),{t:n}=de(),t=fe(),{isLoggedIn:a,token:l,refreshToken:c,activeSubscriptions:d,currentSaveId:u,saves:x}=me((e=>e.account)),g=a&&x&&(d.RMP_CLOUD?x.length<10:x.length<1),m=Math.min(...(null!=x?x:[]).map((e=>e.id))),f=e=>!d.RMP_CLOUD&&e!==m,[v,w]=je.useState(void 0),[k,z]=je.useState(void 0),b=n=>e({title:n,status:"error",duration:9e3,isClosable:!0});je.useEffect((()=>{u&&y()}),[u]);const y=async()=>{var e;const n=await we(ke.RMP);if(!n)return void C();const{hash:s}=n,t=null===(e=x.filter((e=>e.id===u)).at(0))||void 0===e?void 0:e.hash;t&&t!==s&&C()},C=async()=>{const{rep:e,token:s,refreshToken:i}=await ze(be.SAVES+"/"+u,{},l,c);i&&s?(t(ye({access:s,refresh:i})),200===e.status?(Xe.info(`Set ${ke.RMP} with save id: ${u}`),Ce(ke.RMP,await e.text()),Se()):b(await e.text())):b(n("Login status expired"))};return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsxs(i,{width:"100%",children:[s.jsx(o,{as:"h4",size:"md",my:1,children:n("Synced saves")}),s.jsxs(r,{ml:"auto",children:[n("Maximum save count:")," ",d.RMP_CLOUD?10:1]}),s.jsx(p,{size:"sm",isDisabled:!g,onClick:async()=>{const e=await we(ke.RMP);if(!a||!e||!l)return void b(n("Failed to get the RMP save!"));const{data:s,hash:i}=e,o=crypto.randomUUID(),{rep:r,token:h,refreshToken:d}=await ze(be.SAVES,{method:"POST",body:JSON.stringify({index:o,data:s,hash:i})},l,c);d&&h?(t(ye({access:h,refresh:d})),200===r.status?t(ve()):b(await r.text())):b(n("Login status expired"))},children:n("Create")})]})}),s.jsx(j,{mt:"2",children:x&&x.map((e=>s.jsx(A,{overflow:"hidden",variant:"outline",mb:"3",children:s.jsxs(j,{direction:{base:"column",sm:"row"},children:[s.jsxs(L,{children:[s.jsx(r,{py:"2",as:"b",children:e.id===u?n("Current save"):n("Cloud save")}),s.jsxs(r,{py:"2",children:[n("Last update at:")," ",new Date(e.lastUpdateAt).toLocaleString()]})]}),s.jsx(I,{children:s.jsxs(j,{children:[s.jsx(p,{variant:"solid",colorScheme:"red",isLoading:k===e.id,onClick:()=>(async e=>{if(!a||!e||!l)return;z(e);const{rep:s,token:i,refreshToken:o}=await ze(be.SAVES+"/"+u,{method:"DELETE"},l,c);return o&&i?(t(ye({access:i,refresh:o})),200!==s.status?(b(await s.text()),void z(void 0)):(t(ve()),void z(void 0))):(b(n("Login status expired")),void z(void 0))})(e.id),children:n("Delete this save")}),s.jsx(p,{variant:"solid",colorScheme:"blue",isDisabled:f(e.id),isLoading:v===e.id,onClick:()=>(async e=>{if(a&&l){if(e===u){if(w(u),!u||f(u))return b(n("Can not sync this save!")),void w(void 0);const e=await we(ke.RMP);if(!e)return b(n("Failed to get the RMP save!")),void w(void 0);const{data:s,hash:i}=e,{rep:a,token:o,refreshToken:r}=await ze(be.SAVES+"/"+u,{method:"PATCH",body:JSON.stringify({data:s,hash:i})},l,c);if(!r||!o)return b(n("Login status expired")),void w(void 0);if(t(ye({access:o,refresh:r})),200!==a.status)return b(await a.text()),void w(void 0);w(void 0)}else{w(e);const{rep:s,token:i,refreshToken:a}=await ze(be.SAVES+"/"+e,{},l,c);if(!a||!i)return b(n("Login status expired")),void w(void 0);if(t(ye({access:i,refresh:a})),200!==s.status)return b(await s.text()),void w(void 0);Xe.info(`Set ${ke.RMP} with save id: ${e}`),Ce(ke.RMP,await s.text()),Se(),w(void 0)}t(ve())}})(e.id),children:e.id===u?n("Sync now"):n("Sync this slot")})]})})]})},e.id)))})]})},Pn=e=>{const n=h(),{t:t}=de(),{isOpen:i,onClose:a,getSubscriptions:o}=e,{isLoggedIn:l,token:c,refreshToken:d}=me((e=>e.account)),u=fe(),x=E("primary.500","primary.300"),[b,y]=je.useState("");return s.jsxs(g,{isOpen:i,onClose:a,size:"xl",scrollBehavior:"inside",children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsx(v,{children:t("Redeem your subscription")}),s.jsx(w,{}),s.jsxs(k,{children:[s.jsx(r,{children:t("CDKey could be purchased in the following sites:")}),s.jsx(_,{children:s.jsx(P,{children:s.jsxs(D,{color:x,href:"https://afdian.com/item/9c8b220c614311efab2d52540025c377",isExternal:!0,children:["爱发电 ",s.jsx(N,{as:wn})]})})}),s.jsxs(j,{mt:"5",direction:{base:"column",sm:"row"},children:[s.jsx(r,{children:t("Enter your CDKey here:")}),s.jsx(R,{w:"auto",value:b,onChange:e=>y(e.target.value)}),s.jsx(p,{colorScheme:"teal",onClick:async()=>{if(!l)return;const{rep:e,token:s,refreshToken:i}=await ze(be.SUBSCRIPTION_REDEEM,{method:"POST",body:JSON.stringify({cdkey:b})},c,d);if(i&&s)if(u(ye({access:s,refresh:i})),202===e.status)await o(),a();else{const s=(await e.json()).message;n({title:t(s),status:"error",duration:5e3,isClosable:!0})}},children:t("Redeem")})]})]}),s.jsx(z,{})]})]})},Dn=()=>{const e=h(),{t:n}=de(),{isLoggedIn:t,token:a,refreshToken:l}=me((e=>e.account)),c=fe(),[d,u]=je.useState([]),[x,g]=je.useState(!1),m=n=>e({title:n,status:"error",duration:9e3,isClosable:!0}),f=async()=>{if(!t)return;const{rep:e,token:s,refreshToken:i}=await ze(be.SUBSCRIPTION,{},a,l);if(!i||!s)return void m(n("Login status expired"));if(c(ye({access:s,refresh:i})),200!==e.status)return void m(await e.text());const o=(await e.json()).subscriptions;if(!o.map((e=>e.type)).includes("RMP_CLOUD"))return;u([{type:"RMP",expires:o[0].expires}]);const r=structuredClone(Ae);for(const n of o){const e=n.type;e in r&&(r[e]=!0)}c(Le(r))};return je.useEffect((()=>{f()}),[]),s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsxs(i,{width:"100%",children:[s.jsx(o,{as:"h4",size:"md",my:1,children:n("All subscriptions")}),s.jsx(p,{size:"sm",ml:"auto",onClick:()=>g(!0),children:n("Redeem")})]})}),s.jsxs(j,{mt:"2",children:[0===d.length&&s.jsxs(A,{overflow:"hidden",variant:"outline",mb:"3",children:[s.jsx(V,{children:s.jsx(o,{size:"md",children:n("Rail Map Painter")})}),s.jsx(j,{direction:{base:"column",sm:"row"},children:s.jsx(L,{children:s.jsxs(j,{children:[s.jsx(r,{children:n("With this subscription, the following features are unlocked:")}),s.jsxs(_,{children:[s.jsx(P,{children:s.jsx(r,{children:n("PRO features")})}),s.jsx(P,{children:s.jsx(r,{children:n("Sync 9 more saves")})}),s.jsx(P,{children:s.jsx(r,{children:n("Unlimited master nodes")})}),s.jsx(P,{children:s.jsx(r,{children:n("Unlimited parallel lines")})})]}),s.jsxs(r,{children:[n("Expires at:")," ",n("Not applicable")]})]})})})]}),d.map((e=>s.jsxs(A,{overflow:"hidden",variant:"outline",mb:"3",children:[s.jsx(V,{children:s.jsx(o,{size:"md",children:n("RMP"===e.type?"Rail Map Painter":e.type)})}),s.jsxs(j,{direction:{base:"column",sm:"row"},children:[s.jsx(L,{children:s.jsxs(r,{py:"2",children:[n("Expires at:")," ",new Date(e.expires).toLocaleString()]})}),s.jsx(I,{children:s.jsx(p,{variant:"solid",colorScheme:"blue",onClick:()=>g(!0),children:n("Renew")})})]})]},e.type)))]}),s.jsx(Pn,{isOpen:x,onClose:()=>g(!1),getSubscriptions:f})]})},Nn=()=>{const{t:e}=de(),{isLoggedIn:n}=me((e=>e.account)),[t,i]=je.useState("login");return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:e("Account")})}),n?s.jsx(d,{flexDirection:"column",alignItems:"center",children:s.jsxs(j,{width:"100%",p:"2",spacing:"30px",children:[s.jsx(On,{}),s.jsx(U,{}),s.jsx(Dn,{}),s.jsx(U,{}),s.jsx(_n,{})]})}):"login"===t?s.jsx(In,{setLoginState:i}):"register"===t?s.jsx(En,{setLoginState:i}):s.jsx(Ln,{setLoginState:i})]})},Vn={"& button:first-of-type":{w:"100%",overflow:"hidden",justifyContent:"flex-start",textOverflow:"ellipsis",textAlign:"start","& span.chakra-button__icon":{ml:-1,color:"orange.300",'[data-theme="dark"] &':{color:"orange.200"}}},'&[aria-current="true"] > button':{bg:"primary.50",_hover:{bg:"primary.100"},'[data-theme="dark"] &':{bg:"primary.700",_hover:{bg:"primary.600"}}},"& > div":{zIndex:6}};function Un(e){var n;const{appId:t,onAboutOpen:i}=e,{t:a}=de(),o=fe(),r=B(`(min-width: ${F.breakpoints.sm})`),{activeTab:c,openedTabs:h}=me((e=>e.app)),d=Ie[t],u=d.name.split(" - ").map((e=>a(e))).join(" - "),j=h.some((e=>e.app===t)),g=!d.allowMultiInstances&&(null===(n=h.find((e=>e.id===c)))||void 0===n?void 0:n.app)===t,m=e=>{j||sn.event(Ee.OPEN_APP,{appId:t,isOpenInNew:e}),o(e?_e(t):Pe({appId:t})),r[0]||(o(De()),sn.toggleNavMenu(!1))};return s.jsxs(s.Fragment,{children:[s.jsxs($,{variant:g?"solid":"ghost",size:"md",isAttached:!0,"aria-current":g,sx:Vn,children:[s.jsx(p,{onClick:()=>m(!1),leftIcon:j?s.jsx(bn,{title:a("Running")}):s.jsx(l,{w:4}),children:u}),d.allowMultiInstances&&s.jsx(x,{"aria-label":a("New tab"),title:a("New tab"),icon:s.jsx(zn,{}),onClick:()=>m(!0)}),s.jsxs(W,{children:[s.jsx(G,{as:x,icon:s.jsx(Mn,{}),"aria-label":a("More"),title:a("More")}),s.jsxs(J,{children:[j&&s.jsx(q,{icon:s.jsx(Sn,{}),onClick:()=>{return o(Ue(e=t)),void sn.event(Ee.CLOSE_APP,{app:e});var e},children:d.allowMultiInstances?a("Close all tabs"):a("Close app")}),s.jsx(q,{icon:s.jsx(vn,{}),onClick:i,children:a("About")})]})]})]}),d.allowMultiInstances&&h.filter((e=>e.app===t)).map(((e,n)=>{var i;const l=e.id===c;return s.jsxs($,{variant:l?"solid":"ghost",size:"sm",ml:8,mr:1,isAttached:!0,"aria-current":l,sx:Vn,children:[s.jsxs(p,{onClick:()=>{return n=e.id,o(Ne(n)),void(r[0]||(o(De()),sn.toggleNavMenu(!1)));var n},children:[s.jsx(K,{mr:2,children:n+1}),null!==(i=e.title)&&void 0!==i?i:a("Tab")+" "+(n+1).toString()+" - "+u]}),s.jsx(x,{"aria-label":a("Close tab"),title:a("Close tab"),icon:s.jsx(Sn,{}),onClick:()=>{return n=e.id,o(Ve(n)),void sn.event(Ee.CLOSE_APP,{app:t});var n}})]},e.id)}))]})}const Bn=async e=>{const n=`/${e}/info.json`;try{const e=await fetch(n);return(await e.json()).version}catch(s){return Xe.info(`Failed to get version of ${e}`),"unknown"}},Fn=async(e,n)=>{const s=`/${e}/legacy-contributor-list.txt`,t=await fetch(s,{signal:n});return(await t.text()).split("\n")};function $n(e){var n;const{appId:t,onClose:i}=e,{t:a}=de(),[o,r]=ue.useState("Unknown"),l=t?null===(n=Ie[t])||void 0===n||null===(n=n.url)||void 0===n||null===(n=n.split("/"))||void 0===n?void 0:n[1]:void 0;return ue.useEffect((()=>{l?Bn(l).then((e=>r(e))):r("Unknown")}),[l]),s.jsxs(g,{isOpen:!!t,onClose:i,size:"xl",scrollBehavior:"inside",children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsxs(v,{children:[a("About")+" "+(t?Ie[t].name.split(" - ").map((e=>a(e))).join(" - "):""),s.jsx(K,{ml:1,children:o})]}),s.jsx(w,{}),s.jsx(k,{}),s.jsx(z,{children:s.jsx(p,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/"+l,"_blank"),children:a("Visit GitHub")})})]})]})}function Wn({assetType:e}){const{t:n}=de(),[t,i]=ue.useState(),a=Be(e,sn.getEnv(),sn.getInstance());return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:n("devtool"===e?"Devtools":"Apps")})}),s.jsx(d,{direction:"column",children:a.map((e=>s.jsx(Un,{appId:e,onAboutOpen:()=>i(e)},e)))}),s.jsx($n,{appId:t,onClose:()=>i(void 0)})]})}const Gn={"& button":{w:"100%",overflow:"hidden",justifyContent:"flex-start",textOverflow:"ellipsis",textAlign:"start","& span.chakra-button__icon:last-of-type":{ml:"auto"}}};function Jn(){const{t:e}=de(),n=Be("link",sn.getEnv(),sn.getInstance());return s.jsxs(nn,{sx:Gn,children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:e("Useful links")})}),s.jsx(d,{direction:"column",children:n.map((n=>s.jsx(p,{variant:"ghost",size:"md",leftIcon:s.jsx(l,{w:4}),rightIcon:s.jsx(wn,{}),onClick:()=>(e=>{sn.event(Ee.OPEN_LINK,{id:e}),window.open(Ie[e].url,"_blank")})(n),children:e(Ie[n].name)},n)))})]})}const qn={"& > span":{minW:"75%",borderRadius:"lg",cursor:"pointer","& > span:last-of-type":{display:"block"},"& p":{fontSize:"sm","&:first-of-type":{fontSize:"lg",fontWeight:"bold",mb:1}}},"& .chakra-avatar":{ml:1,mr:3,my:4}};function Kn(){const{t:e}=de();return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h5",size:"sm",children:e("Developer team")})}),s.jsxs(t,{sx:qn,children:[s.jsxs(Y,{size:"lg",onClick:()=>window.open("https://github.com/wongchito","_blank"),children:[s.jsx(u,{src:"https://github.com/wongchito.png",size:"lg"}),s.jsxs(Q,{children:[s.jsx(r,{children:"Chito Wong"}),s.jsx(r,{children:"Author of Rail Map Toolkit platform"}),s.jsx(r,{children:"Author of Rail Map Generator"})]})]}),s.jsxs(Y,{size:"lg",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),children:[s.jsx(u,{src:"https://github.com/thekingofcity.png",size:"lg"}),s.jsxs(Q,{children:[s.jsx(r,{children:"thekingofcity"}),s.jsx(r,{children:"Author of Rail Map Painter"}),s.jsx(r,{children:"Author of RMG (Shanghai Metro style)"})]})]}),s.jsxs(Y,{size:"lg",onClick:()=>window.open("https://github.com/langonginc","_blank"),children:[s.jsx(u,{src:"https://github.com/langonginc.png",size:"lg"}),s.jsxs(Q,{children:[s.jsx(r,{children:"langonginc"}),s.jsx(r,{children:"Author of Rail Map Painter"})]})]})]})]})}function Yn(e){const{login:n,urlRepo:t,...i}=e,a=t?`https://github.com/railmapgen/${t}/issues?q=is:issue+author:${n}`:`https://github.com/${n}`;return s.jsx(u,{name:n,title:n,src:`https://github.com/${n}.png`,loading:"lazy",onClick:()=>window.open(a,"_blank"),cursor:"pointer",...i})}const Qn=["Swiftiecott","linchen1965","28yfang","Windows-Taskmgr"];function Xn(){const{t:e}=de();return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h5",size:"sm",children:e("Resource administrators")})}),s.jsx(X,{spacing:1.5,px:2,children:Qn.map((e=>s.jsx(Z,{children:s.jsx(Yn,{login:e,size:"md"})},e)))})]})}const Zn="https://api.github.com/repos/railmapgen",es={},ns=async(e,n)=>{if(e in es)return es[e];const s=await fetch(e,n),t=await s.json();return es[e]=t,t},ss=async(e,n,s)=>{const t=`${Zn}/${e}/contributors`,i=new URLSearchParams({per_page:"100",page:n.toString()});return(await ns(t+"?"+i.toString(),{signal:s})).map((e=>e.login))},ts=async(e,n,s)=>{const t=`${Zn}/${e}/issues`,i=new URLSearchParams({state:"closed",labels:"donation",per_page:"100",page:n.toString()});return(await ns(t+"?"+i.toString(),{signal:s})).filter((e=>"completed"===e.state_reason)).map((e=>{var n;return null===(n=e.user)||void 0===n?void 0:n.login}))};function is(e){const[n,s]=ue.useState([]);return[n,e=>{s((n=>{const s=new Set(n?n.concat(e):e);return Array.from(s)}))}]}const as=["","wongchito","thekingofcity","github-actions[bot]"],os=e=>!as.includes(e);function rs(e){const[n,s]=is(),[t,i]=ue.useState(!0),[a,o]=ue.useState(!1),r=ue.useRef();return ue.useEffect((()=>((async()=>{let n=0;for(;++n;){var t;r.current=new AbortController;const i=await ss(e,n,null===(t=r.current)||void 0===t?void 0:t.signal);if(s(i.filter(os)),i.length<100)break}})().then((()=>{var n;return Ie[e].legacyContributors?(r.current=new AbortController,Fn(e,null===(n=r.current)||void 0===n?void 0:n.signal)):[]})).then((e=>s(e.filter(os)))).catch((n=>{Xe.error("unable to fetch contributors for:",e,n),o(!0)})).finally((()=>i(!1))),()=>{var e;null===(e=r.current)||void 0===e||e.abort(),i(!0),o(!1)})),[e]),{contributors:n,isLoading:t,isError:a}}const ls={position:"relative",minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function cs(e){const{appId:n}=e,{t:t}=de(),{contributors:i,isLoading:a,isError:o}=rs(n);return s.jsxs(d,{sx:ls,children:[a&&s.jsx(tn,{isIndeterminate:!0}),o&&s.jsxs(b,{status:"warning",children:[s.jsx(y,{}),t("Unable to load contributors")]}),!o&&i&&s.jsx(X,{spacing:1.5,children:null==i?void 0:i.map((e=>s.jsx(Z,{children:s.jsx(Yn,{login:e,urlRepo:n,size:"sm"})},e)))})]})}const hs={"& > *:not(.rmg-section__header)":{px:2},"& h6":{my:2}};function ds(){const{t:e}=de();return s.jsxs(nn,{sx:hs,children:[s.jsx(Ze,{children:s.jsx(o,{as:"h5",size:"sm",children:e("Resource contributors")})}),Object.entries(Ie).filter((([,e])=>e.showContributors)).map((([n,t])=>s.jsxs(ue.Fragment,{children:[s.jsx(o,{as:"h6",size:"xs",children:e(t.name)}),s.jsx(cs,{appId:n},n)]},n))),s.jsx(r,{as:"i",fontSize:"xs",mt:3,children:e("Notes: Contributors are sorted by number of commits and commit time.")})]})}function us(){const[e,n]=is(),[s,t]=ue.useState(!0),[i,a]=ue.useState(!1),o=ue.useRef();return ue.useEffect((()=>((async()=>{const e=Object.entries(Ie).filter((([,e])=>e.showDonators)).map((([e])=>e));for(const i of e)try{let e=0;for(;++e;){var s;o.current=new AbortController;const t=await ts(i,e,null===(s=o.current)||void 0===s?void 0:s.signal);if(n(t),t.length<100)break}}catch(t){throw Xe.error("unable to fetch donators for:",i,t),t}})().catch((()=>a(!0))).finally((()=>t(!1))),()=>{var e;null===(e=o.current)||void 0===e||e.abort(),t(!0),a(!1)})),[]),{donators:e,isLoading:s,isError:i}}const xs={position:"relative",px:2,minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function js(){const{t:e}=de(),{donators:n,isLoading:t,isError:i}=us();return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h5",size:"sm",children:"❤️ "+e("Donators")})}),s.jsxs(d,{sx:xs,children:[t&&s.jsx(tn,{isIndeterminate:!0}),i&&s.jsxs(b,{status:"warning",children:[s.jsx(y,{}),e("Unable to load donators")]}),!i&&n&&s.jsx(X,{spacing:1.5,children:null==n?void 0:n.map((e=>s.jsx(Z,{children:s.jsx(Yn,{login:e,size:"sm"})},e)))})]})]})}const ps={bg:"inherit",py:0,"& section:not(:last-of-type)":{mb:4}};function gs(e){const{isOpen:n,onClose:t}=e,{t:i}=de();return s.jsxs(g,{isOpen:n,onClose:t,size:"xl",scrollBehavior:"inside",children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsx(v,{children:i("Contributors")}),s.jsx(w,{}),s.jsxs(k,{sx:ps,children:[s.jsx(Kn,{}),s.jsx(js,{}),s.jsx(Xn,{}),s.jsx(ds,{})]}),s.jsx(z,{children:s.jsx(p,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/rmg/wiki/How-to-add-color-palette-and-line-templates","_blank"),children:i("Contribution Wiki")})})]})]})}function ms(){const{t:e}=de(),n=fe(),{isShowMenu:t,showFontAdvice:i}=me((e=>e.app)),[a,o]=ue.useState(t&&"show"===i);return ue.useEffect((()=>{let e;return t&&"show"===i?e=window.setTimeout((()=>{o(!0)}),5e3):o(!1),()=>{window.clearTimeout(e)}}),[t,i]),s.jsxs(ee,{isOpen:a,onClose:()=>n(Fe()),children:[s.jsx(ne,{children:s.jsx(p,{variant:"ghost",size:"sm",w:"100%",leftIcon:s.jsx(fn,{}),onClick:()=>{n(He("support")),n(Fe())},children:e("Help & support")})}),s.jsxs(se,{children:[s.jsx(te,{}),s.jsx(ie,{}),s.jsxs(ae,{children:["💡 ",e("Pro tip")]}),s.jsx(oe,{children:e("Fonts are slow to load? Learn how to speed it up!")}),s.jsxs(re,{display:"flex",children:[s.jsx(p,{variant:"ghost",size:"sm",ml:"auto",onClick:()=>{n($e()),sn.storage.set(We.SHOW_FONT_ADVICE,Ge)},children:e("Don't show again")}),s.jsx(p,{variant:"solid",colorScheme:"primary",size:"sm",ml:2,onClick:()=>n(Fe()),children:e("OK")})]})]})]})}function fs(){const{t:e}=de(),n=fe(),{menuView:t,refreshRequired:i}=me((e=>e.app)),[a,o]=ue.useState(!1);return s.jsxs(d,{direction:"column",children:[s.jsx(U,{}),"main"===t?s.jsxs(le,{templateColumns:"repeat(3, auto)",children:[s.jsx(ce,{children:s.jsx(p,{variant:"ghost",size:"sm",w:"100%",leftIcon:s.jsx(Rn,{}),onClick:()=>o(!0),children:e("Contributors")})}),s.jsx(ce,{children:s.jsx(ms,{})}),s.jsx(ce,{children:s.jsx(p,{variant:"ghost",size:"sm",w:"100%",leftIcon:s.jsx(kn,{}),onClick:()=>n(He("settings")),children:e("Settings")})})]}):s.jsx(p,{variant:"ghost",size:"sm",w:"100%",leftIcon:s.jsx(Cn,{}),onClick:()=>n(He("main")),isDisabled:i,children:e("Go back")}),s.jsx(gs,{isOpen:a,onClose:()=>o(!1)})]})}function vs(){const{t:e}=de();return{type:"select",label:e("Language"),value:sn.getLanguage(),options:{[e("Main languages")]:n.reduce(((e,n)=>({...e,[n]:un[n][n]})),{}),[e("Other languages")]:dn.reduce(((e,n)=>({...e,[n]:un[n][n]})),{})},onChange:e=>{const n=e;sn.setLanguage(n),sn.getI18nInstance().changeLanguage(n),sn.event(Ee.CHANGE_LANGUAGE,{language:n})}}}function ws(e){const{isOpen:n,onClose:i}=e,{t:a}=de(),o=Object.entries(localStorage);return s.jsxs(g,{isOpen:n,onClose:i,size:"xl",scrollBehavior:"inside",children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsx(v,{children:a("Local Storage")}),s.jsx(w,{}),s.jsx(k,{children:s.jsx(t,{p:1,children:o.map((e=>s.jsx(an,{label:e[0],minW:"full",children:s.jsx(he,{value:e[1],readOnly:!0,fontFamily:"monospace",fontSize:"xs"})},e[0])))})}),s.jsx(z,{children:s.jsx(p,{onClick:i,children:a("Go back")})})]})]})}function ks(){const{t:e}=de(),{setColourMode:n}=on(),t=fe(),{lastShowDevtools:i,refreshRequired:a}=me((e=>e.app)),[r,c]=ue.useState(sn.isAllowAnalytics()),[h,d]=ue.useState(!1),u=vs(),x={light:e("Light"),dark:e("Dark"),system:e("System")},j=[u,{type:"select",label:e("Appearance"),value:sn.getColourMode(),options:x,onChange:e=>n(e)},{type:"switch",label:e("Allow cookies to help improve our website"),isChecked:r,onChange:e=>{c(e),sn.allowAnalytics(e).refreshRequired&&t(Ye())},oneLine:!0,isDisabled:a},{type:"switch",label:e("Show dev tools for 1 day"),isChecked:Je(i),onChange:e=>{e?(t(qe()),sn.event(Ee.SHOW_DEVTOOLS)):t(Ke())},oneLine:!0}];return s.jsxs(nn,{children:[a&&s.jsxs(b,{status:"info",variant:"solid",size:"xs",children:[s.jsx(y,{}),e("Refreshing is required for changes to take effect.")]}),s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:e("Settings")})}),s.jsxs(l,{px:2,children:[s.jsx(hn,{fields:j,minW:"full"}),s.jsx(p,{width:"100%",onClick:()=>d(!0),children:e("Export Local Storage")})]}),s.jsx(ws,{isOpen:h,onClose:()=>d(!1)})]})}const zs={px:2,"& button":{w:"100%"}};function bs(){const{t:e}=de(),{remoteFonts:n}=me((e=>e.app));return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:e("Web fonts")})}),s.jsxs(t,{sx:zs,children:[s.jsxs(r,{as:"i",fontSize:"sm",children:[e("FontsSection.text1")," ",e("FontsSection.text2")," ",e("FontsSection.text3")," (",e("FontsSection.safari"),")"]}),Object.entries(n).map((([e,n])=>s.jsx(p,{size:"sm",rightIcon:n.url?s.jsx(wn,{}):void 0,isDisabled:!n.url,onClick:()=>{window.open(n.url,"_blank"),sn.event(Ee.DOWNLOAD_FONT,{family:e})},children:n.displayName?`${n.displayName} (${e})`:e},e)))]})]})}function ys(e){return c({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9a17.56 17.56 0 0 0 3.8.4c8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1a102.4 102.4 0 0 1-22.6 2.7c-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1a63 63 0 0 0 25.6-6c2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8a18.64 18.64 0 0 1 5-.5c8.1 0 26.4 3.1 56.6 24.1a208.21 208.21 0 0 1 112.2 0c30.2-21 48.5-24.1 56.6-24.1a18.64 18.64 0 0 1 5 .5c12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5a19.35 19.35 0 0 0 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"},child:[]}]})(e)}function Cs(e){return c({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M126.12 315.1A47.06 47.06 0 1 1 79.06 268h47.06zm23.72 0a47.06 47.06 0 0 1 94.12 0v117.84a47.06 47.06 0 1 1-94.12 0zm47.06-188.98A47.06 47.06 0 1 1 244 79.06v47.06zm0 23.72a47.06 47.06 0 0 1 0 94.12H79.06a47.06 47.06 0 0 1 0-94.12zm188.98 47.06a47.06 47.06 0 1 1 47.06 47.1h-47.06zm-23.72 0a47.06 47.06 0 0 1-94.12 0V79.06a47.06 47.06 0 1 1 94.12 0zM315.1 385.88a47.06 47.06 0 1 1-47.1 47.06v-47.06zm0-23.72a47.06 47.06 0 0 1 0-94.12h117.84a47.06 47.06 0 1 1 0 94.12z"},child:[]}]})(e)}const Ss={px:2,"& button":{w:"100%"}};function Hs(){const{t:e}=de();return s.jsxs(nn,{children:[s.jsx(Ze,{children:s.jsx(o,{as:"h4",size:"md",my:1,children:e("Help & support")})}),s.jsxs(t,{sx:Ss,children:[s.jsx(p,{size:"md",leftIcon:s.jsx(ys,{}),rightIcon:s.jsx(wn,{}),onClick:()=>{window.open("https://github.com/railmapgen/railmapgen.github.io/issues","_blank"),sn.event(Ee.RAISE_ISSUE)},children:e("Raise an Issue on GitHub")}),s.jsx(p,{size:"md",leftIcon:s.jsx(Cs,{}),rightIcon:s.jsx(wn,{}),onClick:()=>{window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),sn.event(Ee.JOIN_SLACK)},children:e("Join us on Slack")})]})]})}const Ms={flexShrink:0,flexDirection:"column",overflow:"hidden",alignItems:"flex-end",background:"inherit",transition:"0.3s ease-in-out",maxW:0,visibility:"hidden",boxShadow:"lg",zIndex:100,".show-menu &":{maxW:{base:"100%",md:420},w:{base:"100%",md:"unset"},visibility:"initial"},"& > div":{flexDirection:"column",h:"100%",w:{base:"100vw",md:420},background:"inherit","& .nav-menu__header":{flex:0,flexDirection:"row",alignItems:"center",minHeight:10,pl:12},"& .nav-menu__body":{flexDirection:"column",flex:1,overflowX:"hidden",overflowY:"auto",background:"inherit"}},"& .chakra-alert":{flexGrow:0,pl:3,pr:2,py:2,"& a":{fontWeight:"bold",textDecoration:"underline","&:hover, &:focus":{textDecoration:"none"}}}};function Rs(){const{t:e}=de(),{menuView:n,lastShowDevtools:t}=me((e=>e.app)),[i]=xe(),a=("GitLab"===sn.getInstance()?"https://railmapgen.gitlab.io/":"https://railmapgen.github.io/")+"?"+i.toString();return s.jsx(d,{sx:Ms,children:s.jsxs(d,{children:[s.jsxs(d,{className:"nav-menu__header",children:[s.jsx(o,{as:"h4",size:"md",children:e("Rail Map Toolkit")}),s.jsx(rn,{environment:sn.getEnv(),version:sn.getAppVersion()})]}),"PRD"!==sn.getEnv()&&s.jsxs(b,{status:"warning",children:[s.jsx(y,{}),s.jsxs(C,{children:[e("You're currently viewing a testing environment.")," ",s.jsx(D,{href:a,isExternal:!0,children:e("Back to production environment")})]})]}),s.jsxs(d,{className:"nav-menu__body",children:["main"===n&&s.jsx(Tn,{}),"main"===n?s.jsxs(s.Fragment,{children:[s.jsx(Wn,{assetType:"app"}),Je(t)&&s.jsx(Wn,{assetType:"devtool"}),s.jsx(Jn,{})]}):"settings"===n?s.jsx(ks,{}):"support"===n?s.jsxs(s.Fragment,{children:[s.jsx(Hs,{}),s.jsx(bs,{})]}):"account"===n?s.jsx(Nn,{}):s.jsx(s.Fragment,{})]}),s.jsx(fs,{})]})})}function Ts(e){const{isOpen:n,onClose:t}=e,{t:a}=de(),o=ue.useRef(null),l=vs();return s.jsxs(g,{initialFocusRef:o,isOpen:n,onClose:()=>{},children:[s.jsx(m,{}),s.jsxs(f,{children:[s.jsx(v,{children:a("CookiesModal.header")}),s.jsxs(k,{children:[s.jsx(d,{justifyContent:"flex-end",mt:-5,children:s.jsx(hn,{fields:[l]})}),s.jsx(r,{children:a("CookiesModal.text1")}),s.jsx(r,{mt:2,children:a("CookiesModal.text2")}),s.jsx(_,{children:s.jsxs(P,{children:[" ",a("CookiesModal.item1")]})}),s.jsx(r,{mt:2,children:a("CookiesModal.text3")})]}),s.jsx(z,{children:s.jsxs(i,{children:[s.jsx(p,{variant:"ghost",onClick:()=>{sn.allowAnalytics(!1).refreshRequired?window.location.reload():t()},children:a("CookiesModal.reject")}),s.jsx(p,{ref:o,colorScheme:"primary",onClick:()=>{sn.allowAnalytics(!0),t()},children:a("CookiesModal.accept")})]})})]})]})}const Os=()=>{};function As(){const{t:e}=de(),[n,t]=ue.useState(!1);return s.jsx(g,{isOpen:!0,onClose:Os,children:s.jsxs(f,{children:[s.jsx(v,{children:e("Rail Map Toolkit is opened in another window")}),s.jsx(k,{children:e("You cannot open multiple Rail Map Toolkit at the same time. Please close this window.")}),s.jsx(z,{children:s.jsx(p,{colorScheme:"primary",onClick:()=>{t(!0),Qe(),setTimeout((()=>{window.location.reload()}),1e3)},isLoading:n,children:e("Restart RMT in this window")})})]})})}const Ls=()=>{};function Is(){const{t:e}=de();return s.jsx(g,{isOpen:!0,onClose:Ls,children:s.jsxs(f,{children:[s.jsx(v,{children:e("Rail Map Toolkit is opened in another window")}),s.jsx(k,{children:e("Current session has been terminated. Please close this window.")})]})})}}}}));
