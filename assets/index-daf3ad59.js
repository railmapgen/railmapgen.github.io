import{r as c,i as P,d as M,R as r,a as O,c as _,b as I,e as D,u as L,f as N,g as k,h as G,j as l,P as U,I as $,k as x,l as V,m as H}from"./vendor-f259864b.js";function Ne(){import.meta.url,import("_").catch(()=>1);async function*e(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const W="modulepreload",B=function(e){return"/"+e},b={},j=function(t,o,s){if(!o||o.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(o.map(a=>{if(a=B(a),a in b)return;b[a]=!0;const i=a.endsWith(".css"),E=i?'[rel="stylesheet"]':"";if(!!s)for(let u=n.length-1;u>=0;u--){const g=n[u];if(g.href===a&&(!i||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${E}`))return;const p=document.createElement("link");if(p.rel=i?"stylesheet":W,i||(p.as="script",p.crossOrigin=""),p.href=a,document.head.appendChild(p),i)return new Promise((u,g)=>{p.addEventListener("load",u),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t())};const F={header:"Cookies on this website",text1:"At RMG we use cookies to help ensure that our website and services are able to function properly. These cookies are necessary and so are set automatically.",text2:"We would also like to use some cookies to:",item1:"improve our website based on how you use it",text3:"These cookies are optional. If you'd like to accept all optional cookies, select 'Accept all cookies'. If you'd like to reject them, select 'Reject'.",accept:"Accept all cookies",reject:"Reject"},q={CookiesModal:F},z={currentMirror:"你正在浏览 <1>{{mirror}}</1> 镜像"},J={header:"本网站的 Cookies",text1:"在 RMG，我们使用 Cookies 来确保本网站及服务可以正常运作。这些 Cookies 是必需的，因此已默认启动。",text2:"我们也会以 Cookies 的方式：",item1:"分析您的使用模式，用来改进本网站",text3:"这些 Cookies 是可选的。如果您想允许所有可选 Cookies，请选择“接受所有 Cookies”。如果您想禁用 Cookies，请选择“拒绝”。",accept:"接受所有 Cookies",reject:"拒绝"},X="关于",K="外观",Q="贡献者",Y="深色",Z="浅色",ee="保存",oe="跟随系统",te={NavMenuFooter:z,CookiesModal:J,About:X,"Allow cookies to help improve our website":"允许用 Cookies 帮助改进本网站",Appearance:K,"Contribution Wiki":"贡献者指南",Contributors:Q,"Core contributors":"核心贡献者",Dark:Y,Light:Z,"Open in new Workspace":"在新 Workspace 中打开","Privacy settings":"隐私设置","Refreshing is required for changes to take effect.":"刷新页面后变更才会生效","Resource contributors":"资源贡献者","Resource Administrator":"资源管理员",Save:ee,"Select an app to start your own rail map design!":"选择一个应用程序来开始你的线路图设计！","Switch to":"切换至",System:oe,"Terms and conditions":"条款与细则","Visit GitHub":"访问 GitHub","Welcome to Rail Map Toolkit":"欢迎使用线路图工具包"},ne={currentMirror:"你正在瀏覽 <1>{{mirror}}</1> 鏡像"},ae={header:"本網站的 Cookies",text1:"在 RMG，我們使用 Cookies 以確保本網站及服務可以正常運作。這些 Cookies 是必需的，因此已預設啟用。",text2:"我們亦會以 Cookies 的方式：",item1:"分析閣下的使用模式，用來改進本網站",text3:"這些 Cookies 是可選的。如果閣下想容許所有可選 Cookies，請選擇「接受所有 Cookies」。如果閣下想禁用 Cookies，請選擇「拒絕」。",accept:"接受所有 Cookies",reject:"拒絕"},se="關於",re="外觀",ie="貢獻者",ce="深色",pe="淺色",le="儲存",de="跟隨系統",ue={NavMenuFooter:ne,CookiesModal:ae,About:se,"Allow cookies to help improve our website":"容許以 Cookies 幫助改進本網站",Appearance:re,"Contribution Wiki":"貢獻者指南",Contributors:ie,"Core contributors":"主要貢獻者",Dark:ce,Light:pe,"Open in new Workspace":"在新 Workspace 中開啟","Privacy settings":"私隱設定","Refreshing is required for changes to take effect.":"重新整理頁面後變更才會生效","Resource contributors":"資源貢獻者","Resource Administrator":"資源管理員",Save:le,"Select an app to start your own rail map design!":"選擇一個應用程式以開始你的路綫圖設計！","Switch to":"切換至",System:de,"Terms and conditions":"條款及細則","Visit GitHub":"造訪 GitHub","Welcome to Rail Map Toolkit":"歡迎使用路綫圖工具組"},me={currentMirror:"당신은 미러를 <1>{{mirror}}</1> 훑어보고 있습니다"},ge={header:"이 웹 사이트의 쿠키",text1:"RMG에서는 쿠키를 사용하여 웹 사이트 및 서비스가 제대로 작동하는지 확인합니다.이러한 쿠키는 필수이므로 기본적으로 시작됩니다.",text2:"저희도 쿠키 방식으로：",item1:"당신의 사용 패턴을 분석하여, 본 사이트를 개선합니다",text3:"이 쿠키들은 선택 사항입니다.모든 선택 가능한 쿠키를 허용하려면 '모든 쿠키 허용'을 선택하십시오.쿠키를 사용하지 않으려면 '거부'를 선택하십시오.",accept:"모든 쿠키 허용",reject:"거부"},he="관한",be="화면 스타일",fe="기여자",Te="다크 모드",Ae="라이트 모드",we="저장",ke="시스템 모드",ve={NavMenuFooter:me,CookiesModal:ge,About:he,"Allow cookies to help improve our website":"쿠키를 사용하여 이 웹 사이트를 개선할 수 있도록 허용",Appearance:be,"Contribution Wiki":"기여자 안내",Contributors:fe,"Core contributors":"핵심 기여자",Dark:Te,Light:Ae,"Open in new Workspace":"새 Workspace에서 열기","Privacy settings":"개인 정보 보호 설정","Refreshing is required for changes to take effect.":"페이지를 새로 고친 후에만 변경 가능","Resource contributors":"자원 기여자","Resource Administrator":"자원 관리자",Save:we,"Select an app to start your own rail map design!":"응용 프로그램을 선택하여 노선도 설계를 시작하십시오.","Switch to":"곳으로 전환",System:ke,"Terms and conditions":"조항과 세칙","Visit GitHub":"GitHub 방문하기","Welcome to Rail Map Toolkit":"노선도 툴킷에 오신 것을 환영합니다"},Re=new c.I18nBuilder().use(P).withAppName("Rail Map Toolkit").withLng(c.getLanguage()).withDefaultResource(M).withResource("en",q).withResource("zh-Hans",te).withResource("zh-Hant",ue).withResource("ko",ve).build(),h={rmg:{name:"Rail Map Generator",url:"/rmg/",allowedEnvs:[r.DEV,r.UAT,r.PRD],allowMultiInstances:!0},rmp:{name:"Rail Map Painter",url:"/rmp/",allowedEnvs:[r.DEV,r.UAT,r.PRD]},"rmg-palette":{name:"Palette",url:"/rmg-palette/",allowedEnvs:[r.DEV,r.UAT,r.PRD]},"rmg-components":{name:"Components",url:"/rmg-components/",allowedEnvs:[r.DEV,r.UAT]},"rmg-templates":{name:"RMG Templates",url:"/rmg-templates/",allowedEnvs:[r.DEV,r.UAT,r.PRD]},"rmg-templates-upload":{name:"RMG Templates - Upload",url:"/rmg-templates/new",allowedEnvs:[r.DEV,r.UAT,r.PRD]},"seed-project":{name:"Seed Project",url:"/seed-project/",allowedEnvs:[r.DEV,r.UAT]},"rmg-translate":{name:"Translate",url:"/rmg-translate/",allowedEnvs:[r.DEV,r.UAT]}},v=e=>Object.entries(h).filter(([t,o])=>o.allowedEnvs.includes(e)).map(([t])=>t);var m=(e=>(e.OPENED_TABS="rmg-home__openedTabs",e.ACTIVE_TAB="rmg-home__activeTab",e))(m||{});const Ue={GitHub:"GitHub Pages",GitLab:"GitLab Pages",Bitbucket:"Bitbucket Cloud",localhost:"localhost",unknown:"unknown"},$e=(e,t)=>`https://${t===r.PRD?"":"uat-"}railmapgen.${e===O.GITLAB?"gitlab":"github"}.io`;var R=(e=>(e.APP_LOAD="APP_LOAD",e.OPEN_APP="OPEN_APP",e.CLOSE_APP="CLOSE_APP",e.TOGGLE_NAV_MENU="TOGGLE_NAV_MENU",e.CHANGE_LANGUAGE="CHANGE_LANGUAGE",e.SWITCH_MIRROR="SWITCH_MIRROR",e))(R||{});const Se="rmg-home:frame-",ye={isShowMenu:!0,openedTabs:[],activeTab:void 0},S=_({name:"app",initialState:ye,reducers:{toggleMenu:e=>{e.isShowMenu=!e.isShowMenu},setOpenedTabs:(e,t)=>{e.openedTabs=t.payload},updateTabUrl:(e,t)=>{const{id:o,url:s}=t.payload;e.openedTabs=e.openedTabs.map(n=>n.id===o?{...n,url:s}:n)},setActiveTab:(e,t)=>{e.activeTab=t.payload},openApp:(e,t)=>{const o=t.payload,s=e.openedTabs.find(({id:a})=>a===e.activeTab),n=e.openedTabs.find(({app:a})=>a===o);if((s==null?void 0:s.app)!==o)if(n)e.activeTab=n.id;else{const a=crypto.randomUUID();e.openedTabs.push({id:a,app:o,url:h[o].url}),e.activeTab=a}},openAppInNew:(e,t)=>{const o=crypto.randomUUID();e.openedTabs.push({id:o,app:t.payload}),e.activeTab=o},closeTab:(e,t)=>{const o=t.payload,s=e.openedTabs.filter(n=>n.id!==o);if(s.length===0)e.openedTabs=[],e.activeTab=void 0,e.isShowMenu=!0;else if(e.activeTab===o){const n=e.openedTabs.findIndex(a=>a.id===o);e.openedTabs=s,e.activeTab=s[Math.min(n,s.length-1)].id}else e.openedTabs=s}}}),{toggleMenu:xe,setOpenedTabs:f,updateTabUrl:Ce,setActiveTab:T,openApp:y,openAppInNew:Ve,closeTab:He}=S.actions,Ee=S.reducer,C=I(),d=D({reducer:{app:Ee},middleware:e=>e().prepend(C.middleware)}),We=()=>L(),Be=N,A=C.startListening;window.rmgStore=d;const Pe=e=>{try{const t=window.localStorage.getItem(m.OPENED_TABS),o=window.localStorage.getItem("rmg-home__openedApps");if(t){const s=JSON.parse(t);if(Array.isArray(s)){const n=s.filter(a=>a.app in h);e.dispatch(f(n))}else console.warn("initOpenedTabs():: Cannot parse invalid opened tabs state from local storage")}else if(o){const s=JSON.parse(o);if(Array.isArray(s)&&typeof s[0]=="string"){const n=s.map(a=>({id:crypto.randomUUID(),app:a}));e.dispatch(f(n))}else console.warn("initOpenedTabs():: cannot parse invalid opened apps state from local storage")}}catch(t){console.warn("initOpenedTabs():: cannot parse opened apps state from local storage",t)}},Me=e=>{var s;const t=window.localStorage.getItem(m.ACTIVE_TAB),o=e.getState().app.openedTabs;t&&o.some(({id:n})=>n===t)?e.dispatch(T(t)):e.dispatch(T((s=o[0])==null?void 0:s.id))},Oe=e=>{const o=new URLSearchParams(window.location.search).get("app");console.log(`openSearchedApp():: searchParams app=${o}`),v(c.getEnv()).includes(o)?e.dispatch(y(o)):console.warn(`openSearchedApp():: app ${o} not found`)};function _e(e){Pe(e),Me(e),A({predicate:(t,o,s)=>JSON.stringify(o.app.openedTabs)!==JSON.stringify(s.app.openedTabs),effect:(t,o)=>{window.localStorage.setItem(m.OPENED_TABS,JSON.stringify(o.getState().app.openedTabs))}}),A({predicate:(t,o,s)=>o.app.activeTab!==s.app.activeTab,effect:(t,o)=>{const s=o.getState().app.activeTab;s!==void 0&&window.localStorage.setItem(m.ACTIVE_TAB,s)}}),Oe(e)}let w;const Ie=k.lazy(()=>j(()=>import("./app-root-7ea74dbc.js"),["assets/app-root-7ea74dbc.js","assets/vendor-f259864b.js"])),De=()=>{w=G(document.getElementById("root")),w.render(l(k.StrictMode,{children:l(U,{store:d,children:l($,{i18n:Re,children:l(x,{children:l(V,{suspenseFallback:l(H,{isIndeterminate:!0}),allowReset:!0,children:l(Ie,{})})})})})}))};c.ready().then(()=>{_e(d),De(),c.onAppOpen(e=>{v(c.getEnv()).includes(e)&&d.dispatch(y(e))}),c.onUrlUpdate((e,t)=>{if(t){const o=t.slice(Se.length);console.log(`Received URL update for frame=${o}, url=${e}`),d.dispatch(Ce({id:o,url:e}))}}),c.event(R.APP_LOAD,{openedApps:d.getState().app.openedTabs.map(e=>e.app)})});export{R as E,Se as F,Ne as __vite_legacy_guard,Be as a,h as b,He as c,y as d,$e as e,v as g,Ue as m,Ve as o,T as s,xe as t,We as u};
