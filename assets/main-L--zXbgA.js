const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-root-E0oc2WZz.js","assets/mantine-DJ-xZ26H.js","assets/react-Bl-1YcU-.js","assets/index-ZBc0wcXx.js","assets/index-CeuGNdSU.css","assets/app-root-D-hon04q.css"])))=>i.map(i=>d[i]);
import{c as de}from"./index-ZBc0wcXx.js";import{r as c,l,j as S,R as pe,a as he,L as me}from"./mantine-DJ-xZ26H.js";import{i as ge,d as M,e as F,f as Ce,g as fe,h as we,u as Se,j as ve,k as V,r as J,P as Ae,I as be}from"./react-Bl-1YcU-.js";const Ee="modulepreload",ke=function(e){return"/"+e},_={},ye=function(t,o,a){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),u=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));n=Promise.allSettled(o.map(r=>{if(r=ke(r),r in _)return;_[r]=!0;const d=r.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${g}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Ee,d||(p.as="script"),p.crossOrigin="",p.href=r,u&&p.setAttribute("nonce",u),document.head.appendChild(p),d)return new Promise((v,f)=>{p.addEventListener("load",v),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})}))}function i(s){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s}return n.then(s=>{for(const u of s||[])u.status==="rejected"&&i(u.reason);return t().catch(i)})},Te="操作",Re="应用程序",De="返回",Be="黑",Me="取消",$e="城市",He="组件",Pe="确定",Le="继续",Oe="复制",xe="完成",Fe="编辑",Ge="语言/Language",Ue="理由",Ie="名称",ze="下一步",Ne="否",_e="好",We="打开",je="调色板",Ve="上一步",Je="删除",Ye="重置",Ke="设置",qe="提交",Xe="翻译",Qe="上传",Ze="警告",et="白",tt="是",ot={Action:Te,Apps:Re,Back:De,"Back to list":"返回列表","Background colour":"背景色",Black:Be,Cancel:Me,City:$e,Components:He,"Configuration file":"配置文件",Confirm:Pe,Continue:Le,"Country/Region":"国家/地区",Copy:Oe,Done:xe,Edit:Fe,"Foreground colour":"前景色","Go back":"返回",Language:Ge,Justification:Ue,"Multi-languages":"多语言",Name:Ie,Next:ze,No:Ne,OK:_e,Open:We,Palette:je,"Please select...":"请选择...",Previous:Ve,"Rail Map Announcer":"地铁线路图放送机","Rail Map Generator":"地铁线路图生成器","Rail Map Painter":"地铁线路图绘制器","Rail Map Toolkit":"地铁线路图工具包",Remove:Je,Reset:Ye,"RMG Templates":"RMG 模板","RMP Gallery":"RMP 画廊","RMP Designer":"RMP 设计师","Seed Project":"种子项目",Settings:Ke,Submit:qe,Translate:Xe,Upload:Qe,Warning:Ze,White:et,Yes:tt},at="動作",nt="應用程式",st="返回",it="黑",rt="取消",ut="城市",ct="元件",lt="確定",dt="繼續",pt="複製",ht="完成",mt="編輯",gt="語言/Language",Ct="理由",ft="名稱",wt="下一步",St="否",vt="好",At="開啟",bt="調色盤",Et="上一步",kt="移除",yt="重設",Tt="設定",Rt="提交",Dt="翻譯",Bt="上載",Mt="警告",$t="白",Ht="是",Pt={Action:at,Apps:nt,Back:st,"Back to list":"返回列表","Background colour":"背景色",Black:it,Cancel:rt,City:ut,Components:ct,"Configuration file":"設定檔",Confirm:lt,Continue:dt,Copy:pt,"Country/Region":"國家/地區",Done:ht,Edit:mt,"Foreground colour":"前景色","Go back":"返回",Language:gt,Justification:Ct,"Multi-languages":"多語言",Name:ft,Next:wt,No:St,OK:vt,Open:At,Palette:bt,"Please select...":"請選擇...",Previous:Et,"Rail Map Announcer":"地鐵路綫圖放送機","Rail Map Generator":"地鐵路綫圖產生器","Rail Map Painter":"地鐵路綫圖繪製器","Rail Map Toolkit":"地鐵路綫圖工具組",Remove:kt,Reset:yt,"RMG Templates":"RMG 範本","RMP Gallery":"RMP 畫廊","RMP Designer":"RMP 設計師","Seed Project":"種子項目",Settings:Tt,Submit:Rt,Translate:Dt,Upload:Bt,Warning:Mt,White:$t,Yes:Ht},Lt="言語/Language",Ot="調色板",xt="削除",Ft={Language:Lt,Palette:Ot,"Rail Map Generator":"地下鉄路線図ジェネレータ","Rail Map Painter":"地下鉄路線図画家","Rail Map Toolkit":"地下鉄路線図工具一式",Remove:xt,"RMG Templates":"RMG テンプレート","RMP Gallery":"RMP 画廊","RMP Designer":"RMP 図案家","Rail Map Announcer":"地下鉄路線図放送機"},Gt="조작",Ut="앱",It="블랙",zt="취소",Nt="도시",_t="요소",Wt="확인",jt="복사",Vt="편집",Jt="언어/Language",Yt="이유",Kt="명칭",qt="다음",Xt="열기",Qt="팔레트",Zt="나아가",eo="삭제",to="리셋",oo="설치",ao="제출",no="번역",so="업로드",io="화이트",ro={Action:Gt,Apps:Ut,"Back to list":"다시 목록으로","Background colour":"배경색",Black:It,Cancel:zt,City:Nt,Components:_t,"Configuration file":"환경 설정 파일",Confirm:Wt,Copy:jt,"Country/Region":"국가/지역",Edit:Vt,"Foreground colour":"전경색","Go back":"되돌아가",Language:Jt,Justification:Yt,Name:Kt,Next:qt,Open:Xt,Palette:Qt,"Please select...":"선택해주세요",Previous:Zt,"Rail Map Generator":"철도 노선도 생성기","Rail Map Painter":"철도 노선도 그리기","Rail Map Toolkit":"철도 노선도 툴킷",Remove:eo,Reset:to,"RMG Templates":"RMG 템플릿","RMP Gallery":"RMP 갤러리","RMP Designer":"RMP 디자이너","Seed Project":"종자 프로젝트",Settings:oo,Submit:ao,Translate:no,Upload:so,White:io,"Rail Map Announcer":"철도 노선도 방송 기계"},cs=["en","zh-Hans","zh-Hant"],ls=["ja","ko"],ds={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯语","zh-Hant":"阿拉伯語"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆语","zh-Hant":"阿塞拜疆語"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚语","zh-Hant":"加泰隆尼亞語"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦语","zh-Hant":"丹麥語"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德语","zh-Hant":"德語"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊语","zh-Hant":"希臘語"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英语","zh-Hant":"英語"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙语","zh-Hant":"西班牙語"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯语","zh-Hant":"波斯語"},fi:{en:"Finnish",fi:"Suomi","zh-Hans":"芬兰语","zh-Hant":"芬蘭語"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法语","zh-Hant":"法語"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰语","zh-Hant":"愛爾蘭語"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔语","zh-Hant":"蘇格蘭蓋爾語"},he:{en:"Hebrew",he:"עִבְרִית","zh-Hans":"希伯来语","zh-Hant":"希伯來語"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地语","zh-Hant":"印地語"},hr:{en:"Croatian",hr:"Hrvatski","zh-Hans":"克罗地亚语","zh-Hant":"克羅地亞語"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利语","zh-Hant":"匈牙利語"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼语","zh-Hant":"印尼語"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利语","zh-Hant":"意大利語"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日语","zh-Hant":"日語"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克语","zh-Hant":"哈薩克語"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩语","zh-Hant":"韓語"},mi:{en:"Māori",mi:"Māori","zh-Hans":"毛利语","zh-Hant":"毛利語"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来语","zh-Hant":"馬來語"},nl:{en:"Dutch",nl:"Nederlands","zh-Hans":"荷兰语","zh-Hant":"荷蘭語"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威语","zh-Hant":"挪威語"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰语","zh-Hant":"波蘭語"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙语","zh-Hant":"葡萄牙語"},rm:{en:"Romansh",rm:"Rumantsch","zh-Hans":"罗曼什语","zh-Hant":"羅曼什語"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚语","zh-Hant":"羅馬尼亞語"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄语","zh-Hant":"俄語"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典语","zh-Hant":"瑞典語"},ta:{en:"Tamil",ta:"தமிழ்","zh-Hans":"泰米尔语","zh-Hant":"泰米爾語"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰语","zh-Hant":"泰語"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其语","zh-Hant":"土耳其語"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰语","zh-Hant":"烏克蘭語"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都语","zh-Hant":"烏爾都語"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克语","zh-Hant":"烏茲別克語"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南语","zh-Hant":"越南語"},zh:{en:"Chinese",ja:"中国語",ko:"중국어",zh:"中文","zh-Hans":"中文","zh-Hant":"中文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}},uo={en:{},"zh-Hans":ot,"zh-Hant":Pt,ja:Ft,ko:ro},co={header:"Cookies on this website",text1:"At RMG we use cookies to help ensure that our website and services are able to function properly. These cookies are necessary and so are set automatically.",text2:"We would also like to use some cookies to:",item1:"improve our website based on how you use it",text3:"These cookies are optional. If you'd like to accept all optional cookies, select 'Accept all cookies'. If you'd like to reject them, select 'Reject'.",accept:"Accept all cookies",reject:"Reject"},lo={text1:"The fonts below used in your projects were loaded from our server instead of your device.",text2:"This may cause unnecessary network traffic and slowness especially if your connection is unstable.",text3:"You can download and install these open source and free fonts to get a better experience.",safari:"This is not applicable to Safari users. ☹️"},po={text1:"You're going to delete ",text2:" from local storage. This item is created and used by ",text3:". Deleting it may cause unrecoverable data loss or unexpected behaviour to the applications.",text4:"Please close this modal unless you're certain to do so or are supervised by our developers."},ho={CookiesModal:co,FontsSection:lo,LocalStorageModal:po},mo={header:"本网站的 Cookies",text1:"在 RMG，我们使用 Cookies 来确保本网站及服务可以正常运作。这些 Cookies 是必需的，因此已默认启动。",text2:"我们也会以 Cookies 的方式：",item1:"分析您的使用模式，用来改进本网站",text3:"这些 Cookies 是可选的。如果您想允许所有可选 Cookies，请选择“接受所有 Cookies”。如果您想禁用 Cookies，请选择“拒绝”。",accept:"接受所有 Cookies",reject:"拒绝"},go={text1:"您的项目使用的下列字体，是从我们的服务器而不是您的设备加载。",text2:"这可能导致非必要的网络流量，如您的连接不稳定，还会造成加载缓慢。",text3:"您可以下载和安装这些开源免费字体，以提升使用体验。",safari:"不适用于 Safari ☹️"},Co={text1:"您即将从本地存储中删除 ",text2:" 。这个项目是由 ",text3:" 创建及使用的。删除它可能导致数据丟失而无法恢复，或使应用程序出现异常。",text4:"如果您不确定，或者不是在我们的开发者的指引下操作，请关闭这个对话框。"},fo="关于",wo="外观",So="贡献者",vo="深色",Ao="开发者工具",bo="捐赠者",Eo="浅色",ko="更多",yo="正在运行",To="保存",Ro="切换",Do="跟随系统",Bo="标签页",Mo="使用教程",$o="变更",Ho="账号",Po="欢迎 ",Lo="邮件地址",Oo="密码",xo="创建",Fo="兑换",Go="续期",Uo={CookiesModal:mo,FontsSection:go,LocalStorageModal:Co,About:fo,"Allow cookies to help improve our website":"允许用 Cookies 帮助改进本网站",Appearance:wo,"Back to production environment":"返回生产环境","Close all tabs":"关闭所有标签页","Close app":"关闭应用程序","Close current tab":"关闭当前标签页","Close tab":"关闭标签页","Contribution Wiki":"贡献者指南",Contributors:So,"Current session has been terminated. Please close this window.":"当前会话已被终止，请关闭此窗口。",Dark:vo,"Delete and reload":"删除及重新加载","Developer team":"开发者团队",Devtools:Ao,"Export Local Storage":"导出本地存储",Donators:bo,"Don't show again":"不再显示","Download desktop app":"下载桌面应用程序","Follow us on Bilibili":"在哔哩哔哩关注我们","Fonts are slow to load? Learn how to speed it up!":"字体加载太慢？看看如何提速！","GitHub Pages mirror":"GitHub Pages 镜像","GitLab Pages mirror":"GitLab Pages 镜像","Happy Chinese New Year!":"新年快乐！","Help & support":"帮助与支持","Includes at least 8 characters":"含有至少8个字符","Join us on Slack":"加入我们的 Slack 群组",Light:Eo,"Login success":"成功登录","Main languages":"主要语言",More:ko,"More mirrors":"更多镜像","New tab":"新标签页","Notes: Contributors are sorted by number of commits and commit time.":"注：贡献者名单按提交次数和时间排序。","Official website":"官方网站","Other languages":"其他语言","Pro tip":"提示","Rail Map Toolkit is opened in another window":"线路图工具包已在另一窗口中打开","Raise an Issue on GitHub":"在 GitHub 提交一个 Issue","Refreshing is required for changes to take effect.":"刷新页面后变更才会生效","Remove this item":"删除此项目","Resource administrators":"资源管理员","Resource contributors":"资源贡献者","Restart RMT in this window":"在此窗口重新启动工具包",Running:yo,Save:To,"Select an app to start your own rail map design!":"选择一个应用程序来开始你的线路图设计！","Show dev tools for 1 day":"显示开发者工具 1 天",Switch:Ro,"Switch to":"切换至",System:Do,Tab:Bo,"Terms and conditions":"条款与细则",Tutorial:Mo,"Official Website":"官方网站","Mini Metro Web":"迷你地铁绘制工具","Unable to create your account":"无法创建您的账户","Unable to reset your password":"无法重置您的密码","Unable to load contributors":"无法加载贡献者名单","Unable to load donators":"无法加载捐赠者名单","Unable to login":"无法登录","Unable to redeem":"无法兑换","Unable to retrieve your subscriptions":"无法获取您的订阅","Unable to sync your save":"无法同步您的存档","Unable to update account info":"无法更新账户信息","Unknown app":"未知应用","Useful links":"实用链接","Visit GitHub":"访问 GitHub","Web fonts":"网络字体","Welcome to Rail Map Toolkit":"欢迎使用地铁线路图工具包","We'll never share your email.":"我们绝不会透露您的邮箱地址。","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"您不能同时打开多个线路图工具包，请关闭当前窗口。","Your account is created successfully.":"已成功创建您的账户。","Your password has been reset successfully.":"已成功重置您的密码。","You're currently viewing a testing environment.":"您正在浏览测试环境。","Login status expired":"登录过期","Log in / Sign up":"登录 / 注册","Log out":"登出","Change name":"更名","Change password":"更改密码","Update account info":"修改账户信息",Change:$o,Account:Ho,Welcome:Po,"Forgot password":"忘记密码","Check your email again!":"检查您的邮箱地址！","Email with reset link is sent to":"重置密码的邮件已发送至",Email:Lo,"Send reset link":"发送重置邮件","Reset link sent":"重置邮件已发送","Reset password token":"重置密码的验证码",Password:Oo,"Reset password":"重置密码","Back to log in":"返回登录","Log in":"登录","Create an account":"创建新账号","Sign up":"注册","The email is not valid!":"邮箱地址不合法","Verification email is sent to":"验证邮件已发送至","You may always change it later.":"之后可随时修改","Send verification code":"发送验证码","Verification code sent":"验证码已发送","Verification code":"验证码","Minimum 8 characters. Contain at least 1 letter and 1 number.":"8个字符以上，包含至少1个字母和1个数字。","Failed to get the RMP save!":"无法获取RMP存档","Can not sync this save!":"无法同步此存档","Synced saves":"同步的存档","Maximum save count:":"最大存档数：",Create:xo,"Current save":"当前存档","Cloud save":"云存档","Last update at:":"上次更新于：","Delete this save":"删除此存档","Sync now":"同步","Sync this slot":"同步此存档","All subscriptions":"所有订阅",Redeem:Fo,"With this subscription, the following features are unlocked:":"订阅后以下功能将会解锁","PRO features":"专业功能","Sync 9 more saves":"同步额外9个存档","Unlimited master nodes":"大师节点无数量限制","Unlimited parallel lines":"平行线段无数量限制","Expires at:":"过期于：","Not applicable":"不适用",Renew:Go,"Redeem your subscription":"兑换您的订阅","CDKey could be purchased in the following sites:":"兑换码可在以下网站获取：","Enter your CDKey here":"输入您的兑换码","Oops! It seems there's a conflict":"哎呀！好像有冲突","The local save is newer than the cloud one. Which one would you like to keep?":"本地存档比云端的新。您想保留哪个版本？","Local save":"本地存档","Replace cloud with local":"用本地存档替换云端","Download Local save":"下载本地存档","Replace local with cloud":"用云端存档替换本地","Download Cloud save":"下载云端存档"},Io={header:"本網站的 Cookies",text1:"在 RMG，我們使用 Cookies 以確保本網站及服務可以正常運作。這些 Cookies 是必需的，因此已預設啟用。",text2:"我們亦會以 Cookies 的方式：",item1:"分析閣下的使用模式，用來改進本網站",text3:"這些 Cookies 是可選的。如果閣下想容許所有可選 Cookies，請選擇「接受所有 Cookies」。如果閣下想禁用 Cookies，請選擇「拒絕」。",accept:"接受所有 Cookies",reject:"拒絕"},zo={text1:"你的專案使用的下列字型，是從我們的伺服器而非你的裝置載入。",text2:"這可能導致非必要的網絡流量，如你的連線不穩，還會造成載入緩慢。",text3:"你可以下載及安裝這些開源免費字型，以提升使用體驗。",safari:"不適用於 Safari ☹️"},No={text1:"你即將從本地儲存中移除 ",text2:" 。該項目是由 ",text3:" 建立及使用的。將其移除可能導致資料丟失而無法復原，或令應用程式出現異常。",text4:"若你未能確定，或不是在我們的開發人員的指引下操作，請關閉這個視窗。"},_o="關於",Wo="外觀",jo="貢獻者",Vo="深色",Jo="開發人員工具",Yo="捐贈者",Ko="淺色",qo="更多",Xo="運行中",Qo="儲存",Zo="切換",ea="跟隨系統",ta="分頁",oa="使用指南",aa="更改",na="帳戶",sa="歡迎",ia="電郵地址",ra="密碼",ua="建立",ca="兌換",la="續期",da={CookiesModal:Io,FontsSection:zo,LocalStorageModal:No,About:_o,"Allow cookies to help improve our website":"容許以 Cookies 幫助改進本網站",Appearance:Wo,"Back to production environment":"返回生產環境","Close all tabs":"關閉所有分頁","Close app":"關閉應用程式","Close current tab":"關閉當前分頁","Close tab":"關閉分頁","Contribution Wiki":"貢獻者指南",Contributors:jo,"Current session has been terminated. Please close this window.":"當前工作階段已被終止，請關閉該視窗。",Dark:Vo,"Delete and reload":"移除及重新載入","Developer team":"開發人員團隊",Devtools:Jo,"Export Local Storage":"導出本地存儲",Donators:Yo,"Don't show again":"不再顯示","Download desktop app":"下載桌面應用程式","Follow us on Bilibili":"在嗶哩嗶哩關注我們","Fonts are slow to load? Learn how to speed it up!":"字型載入太慢？看看如何提速！","GitHub Pages mirror":"GitHub Pages 鏡像","GitLab Pages mirror":"GitLab Pages 鏡像","Happy Chinese New Year!":"新年快樂！","Help & support":"幫助及支援","Includes at least 8 characters":"含有至少8个字元","Join us on Slack":"加入我們的 Slack 羣組",Light:Ko,"Login success":"成功登入","Main languages":"主要語言",More:qo,"More mirrors":"更多鏡像","New tab":"新分頁","Notes: Contributors are sorted by number of commits and commit time.":"註：貢獻者列表按提交次數及時間排序。","Official website":"官方網站","Other languages":"其他語言","Pro tip":"小貼士","Rail Map Toolkit is opened in another window":"路綫圖工具組已於另一視窗中開啟","Raise an Issue on GitHub":"於 GitHub 提交一個 Issue","Refreshing is required for changes to take effect.":"重新整理頁面後變更才會生效","Remove this item":"移除該項目","Resource administrators":"資源管理員","Resource contributors":"資源貢獻者","Restart RMT in this window":"於該視窗重新啟動工具組",Running:Xo,Save:Qo,"Select an app to start your own rail map design!":"選擇一個應用程式以開始你的路綫圖設計！","Show dev tools for 1 day":"顯示開發人員工具 1 日",Switch:Zo,"Switch to":"切換至",System:ea,Tab:ta,"Terms and conditions":"條款及細則",Tutorial:oa,"Official Website":"官方網站","Mini Metro Web":"迷你捷運繪製工具","Unable to create your account":"無法建立你的帳戶","Unable to reset your password":"無法重設你的密碼","Unable to load contributors":"無法載入貢獻者列表","Unable to load donators":"無法載入捐贈者列表","Unable to login":"无法登入","Unable to redeem":"无法兌換","Unable to retrieve your subscriptions":"无法取得你的訂閱","Unable to sync your save":"无法同步你的存檔","Unable to update account info":"无法更新帳戶資料","Unknown app":"未知應用","Useful links":"實用連結","Visit GitHub":"造訪 GitHub","Web fonts":"網絡字型","Welcome to Rail Map Toolkit":"歡迎使用地鐵路綫圖工具組","We'll never share your email.":"我們絕不會透露你的電郵地址。","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"你不能同時開啟多個路綫圖工具組，請關閉當前視窗。","Your account is created successfully.":"已成功建立你的帳戶。","Your password has been reset successfully.":"已成功重設你的密碼。","You're currently viewing a testing environment.":"你正在檢視測試環境。","Login status expired":"登入狀態已過期","Log in / Sign up":"登入 / 註冊","Log out":"登出","Change name":"更改名稱","Change password":"更改密碼","Update account info":"更新帳戶資料",Change:aa,Account:na,Welcome:sa,"Forgot password":"忘記密碼","Check your email again!":"請再次檢查您的電郵地址！","Email with reset link is sent to":"重設密碼的連結已傳送至",Email:ia,"Send reset link":"傳送重設連結","Reset link":"重設連結已傳送","Reset password token":"重設密碼驗證碼",Password:ra,"Reset password":"重設密碼","Back to log in":"返回登入","Log in":"登入","Create an account":"建立新帳戶","Sign up":"註冊","The email is not valid!":"電郵地址無效！","Verification email is sent to":"驗證電郵已傳送至","You may always change it later.":"您可以隨時更改。","Send verification code":"傳送驗證碼","Verification code sent":"驗證碼已傳送","Verification code":"驗證碼","Mininum 8 characters. Contain at least 1 letter and 1 number.":"8个字元以上，包含至少1個字母和1個數字。","Failed to get the RMP save!":"無法獲取RMP存檔","Can not sync this save!":"無法同步此存檔","Synced saves":"已同步的存檔","Maximum save count:":"最大存檔數：",Create:ua,"Current save":"當前存檔","Cloud save":"雲端存檔","Last update at:":"最後更新時間：","Delete this save":"刪除此存檔","Sync now":"立即同步","Sync this slot":"同步此存檔","All subscriptions":"所有訂閱",Redeem:ca,"With this subscription, the following features are unlocked:":"訂閱後將解鎖以下功能：","PRO features":"專業功能","Sync 9 more saves":"同步額外9個存檔","Unlimited master nodes":"無限大師節點","Unlimited parallel lines":"無限平行線段","Expires at:":"過期於：","Not applicable":"不適用",Renew:la,"Redeem your subscription":"兌換您的訂閱","CDKey could be purchased in the following sites:":"CDKey可在以下網站購買：","Enter your CDKey here":"在此輸入您的CDKey","Oops! It seems there's a conflict":"哎呀！好像有衝突","The local save is newer than the cloud one. Which one would you like to keep?":"本地存檔比雲端的新。您想保留哪個版本？","Local save":"本地存檔","Replace cloud with local":"用本地存檔替換雲端","Download Local save":"下載本地存檔","Replace local with cloud":"用雲端存檔替換本地","Download Cloud save":"下載雲端存檔"},pa={header:"本網頁のクッキー",text1:"RMGでは、網頁およびサービスが正常に動作するようにするため、クッキーを使用しています。これらのクッキーは必須であり、デフォルトで有効化されています。",text2:"また、クッキーを使用して以下を行います：",item1:"利用パターンを分析し、網頁の改善に役立てる",text3:"これらのクッキーは任意です。すべての任意クッキーを許可したい場合は「すべてのクッキーを受け入れる」を選択してください。クッキーを無効にしたい場合は「拒否」を選択してください。",accept:"すべてのクッキーを受け入れる",reject:"拒否"},ha={text1:"プロジェクトで使用している以下のフォントは、デバイスではなく当社のサーバーから読み込まれています。",text2:"これにより不要なネットワークトラフィックが発生し、接続が不安定な場合、読み込みが遅くなることがあります。",text3:"これらのオープンソースの無料フォントをダウンロードしてインストールすると、使用体験を向上させることができます。",safari:"Safariでは使用できません ☹️"},ma="概要",ga="外観",Ca="貢献者",fa="ダーク",wa="開発者ツール",Sa="寄付者",va="ライト",Aa="もっと見る",ba="OK",Ea="実行中",ka="保存",ya="切り替え",Ta="システムに従う",Ra="タブ",Da="チュートリアル",Ba="変更",Ma="アカウント",$a="ようこそ",Ha="メールアドレス",Pa="パスワード",La="名前",Oa="作成",xa="引き換え",Fa="更新",Ga={CookiesModal:pa,FontsSection:ha,About:ma,"Allow cookies to help improve our website":"クッキーを許可して網頁の改善に協力する",Appearance:ga,"Back to production environment":"本番環境に戻る","Close all tabs":"すべてのタブを閉じる","Close app":"アプリを閉じる","Close current tab":"現在のタブを閉じる","Close tab":"タブを閉じる","Contribution Wiki":"コントリビューションガイド",Contributors:Ca,"Current session has been terminated. Please close this window.":"現在のセッションは終了しました。このウィンドウを閉じてください。",Dark:fa,"Developer team":"開発チーム",Devtools:wa,"Export Local Storage":"ローカルストレージのエクスポート",Donators:Sa,"Don't show again":"再度表示しない","Download desktop app":"デスクトップアプリをダウンロード","Fonts are slow to load? Learn how to speed it up!":"フォントの読み込みが遅い？スピードアップの方法を学びましょう！","Official website":"公式網頁","GitHub Pages mirror":"GitHub Pages ミラー","GitLab Pages mirror":"GitLab Pages ミラー","Happy Chinese New Year!":"新年あけましておめでとうございます！","Help & support":"助けと支援","Join us on Slack":"Slackに参加する","Follow us on Bilibili":"ビリビリでフォローしてください",Light:va,"Main languages":"主要言語",More:Aa,"More mirrors":"他のミラー","New tab":"新しいタブ","Notes: Contributors are sorted by number of commits and commit time.":"注：貢献者はコミット数とコミット時間に基づいて並べられています。",OK:ba,"Other languages":"他の言語","Pro tip":"プロのコツ","Rail Map Toolkit is opened in another window":"レールマップツールキットは別のウィンドウで開かれています","Raise an Issue on GitHub":"GitHubにIssueを報告","Refreshing is required for changes to take effect.":"変更を適用するには再読み込みが必要です。","Resource administrators":"リソース管理者","Resource contributors":"リソース提供者","Restart RMT in this window":"このウィンドウでRMTを再起動する",Running:Ea,Save:ka,"Select an app to start your own rail map design!":"アプリを選択して自分のレールマップデザインを始めましょう！","Show dev tools for 1 day":"1日間開発ツールを表示",Switch:ya,"Switch to":"切り替え",System:Ta,Tab:Ra,"Terms and conditions":"利用規約",Tutorial:Da,"Official Website":"公式網頁","Mini Metro Web":"ミニ地下鉄描画ツール","Unable to load contributors":"貢献者を読み込めません","Unable to load donators":"寄付者を読み込めません","Useful links":"便利なリンク","Visit GitHub":"GitHubを訪問","Web fonts":"ウェブフォント","Welcome to Rail Map Toolkit":"レールマップツールキットへようこそ","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"複数のレールマップツールキットを同時に開くことはできません。このウィンドウを閉じてください。","You're currently viewing a testing environment.":"現在、テスト環境を閲覧しています。","Login status expired":"ログイン状態が期限切れです","Log in / Sign up":"ログイン / サインアップ","Log out":"ログアウト","Change name":"名前を変更","Change password":"パスワードを変更","Update account info":"アカウント情報を更新",Change:Ba,Account:Ma,Welcome:$a,"Forgot password":"パスワードを忘れた","Check your email again!":"メールを再確認してください！","Email with reset link is sent to":"リセットリンクを含むメールが送信されました",Email:Ha,"Send reset link":"リセットリンクを送信","Reset password token":"パスワードリセットトークン",Password:Pa,"Reset password":"パスワードをリセット","Back to log in":"ログインに戻る","Log in":"ログイン","Sign up":"サインアップ","The email is not valid!":"メールアドレスが無効です！","Verification email is sent to":"確認メールが送信されました",Name:La,"You may always change it later.":"後でいつでも変更できます。","Send verification code":"確認コードを送信","Verification code":"確認コード","Failed to get the RMP save!":"RMP保存を取得できませんでした！","Can not sync this save!":"この保存を同期できません！","Synced saves":"同期された保存","Maximum save count:":"最大保存数：",Create:Oa,"Current save":"現在の保存","Cloud save":"クラウド保存","Last update at:":"最終更新日：","Delete this save":"この保存を削除","Sync now":"今すぐ同期","Sync this slot":"このスロットを同期","All subscriptions":"すべてのサブスクリプション",Redeem:xa,"With this subscription, the following features are unlocked:":"このサブスクリプションで次の機能がアンロックされます：","PRO features":"PRO機能","Sync 9 more saves":"追加の9つの保存を同期","Unlimited master nodes":"大師節点無制限","Unlimited parallel lines":"平行路線無制限","Expires at:":"期限：","Not applicable":"該当なし",Renew:Fa,"Redeem your subscription":"サブスクリプションを引き換え","CDKey could be purchased in the following sites:":"CD鍵は以下の網頁で購入できます：","Enter your CDKey here":"ここにCD鍵を入力","Oops! It seems there's a conflict":"おっと！競合が発生したようです","The local save is newer than the cloud one. Which one would you like to keep?":"本地の保存が雲の保存より新しいです。どちらを保持しますか？","Local save":"本地保存","Replace cloud with local":"雲を本地で置き換える","Download Local save":"本地保存をダウンロード","Replace local with cloud":"本地を雲で置き換える","Download Cloud save":"雲保存をダウンロード"},Ua={header:"본 사이트의 쿠키",text1:"RMG에서는 본 사이트 및 서비스가 정상적으로 작동하도록 쿠키를 사용합니다. 이러한 쿠키는 필수적이며 기본적으로 활성화되어 있습니다.",text2:"또한 우리는 다음과 같은 방법으로 쿠키를 사용합니다:",item1:"사이트 개선을 위해 사용자의 사용 패턴을 분석합니다.",text3:"이 쿠키들은 선택 사항입니다. 모든 선택적 쿠키를 허용하려면 '모든 쿠키 허용'을 선택하세요. 쿠키를 비활성화하려면 '거부'를 선택하세요.",accept:"모든 쿠키 허용",reject:"거부"},Ia={text1:"프로젝트에서 사용하는 다음 글꼴은 사용자의 장치가 아닌 우리의 서버에서 로드됩니다.",text2:"이로 인해 불필요한 네트워크 트래픽이 발생할 수 있으며, 연결이 불안정할 경우 로딩이 느려질 수 있습니다.",text3:"이 오픈 소스 무료 글꼴을 다운로드하고 설치하여 사용 경험을 향상시킬 수 있습니다.",safari:"Safari에서는 지원되지 않음 ☹️"},za="정보",Na="외관",_a="기여자",Wa="어두운 모드",ja="개발자 도구",Va="기부자",Ja="밝은 모드",Ya="더보기",Ka="확인",qa="실행 중",Xa="저장",Qa="전환",Za="시스템 설정 따르기",en="탭",tn="튜토리얼",on="변경",an="계정",nn="환영합니다",sn="이메일 주소",rn="비밀번호",un="이름",cn="생성",ln="교환",dn="갱신",pn={CookiesModal:Ua,FontsSection:Ia,About:za,"Allow cookies to help improve our website":"쿠키를 허용하여 웹사이트 개선에 도움을 주세요",Appearance:Na,"Back to production environment":"프로덕션 환경으로 돌아가기","Close all tabs":"모든 탭 닫기","Close app":"앱 닫기","Close current tab":"현재 탭 닫기","Close tab":"탭 닫기","Contribution Wiki":"기여자 안내서",Contributors:_a,"Current session has been terminated. Please close this window.":"현재 세션이 종료되었습니다. 이 창을 닫아주세요.",Dark:Wa,"Developer team":"개발자 팀",Devtools:ja,"Export Local Storage":"로컬 저장소 내보내기",Donators:Va,"Don't show again":"다시 보지 않기","Download desktop app":"데스크탑 앱 다운로드","Fonts are slow to load? Learn how to speed it up!":"글꼴 로딩이 느린가요? 속도를 높이는 방법을 알아보세요!","Official website":"공식 웹사이트","GitHub Pages mirror":"GitHub Pages 미러","GitLab Pages mirror":"GitLab Pages 미러","Happy Chinese New Year!":"새해 복 많이 받으세요!","Help & support":"도움말 및 지원","Join us on Slack":"Slack에 참여하기","Follow us on Bilibili":"빌리빌리에서 팔로우해주세요",Light:Ja,"Main languages":"주요 언어",More:Ya,"More mirrors":"더 많은 미러","New tab":"새 탭","Notes: Contributors are sorted by number of commits and commit time.":"참고: 기여자는 커밋 수와 커밋 시간을 기준으로 정렬됩니다.",OK:Ka,"Other languages":"기타 언어","Pro tip":"팁","Rail Map Toolkit is opened in another window":"철도 노선도 도구가 다른 창에서 열려 있습니다.","Raise an Issue on GitHub":"GitHub에서 이슈 제기","Refreshing is required for changes to take effect.":"변경 사항이 적용되려면 새로 고침이 필요합니다.","Resource administrators":"자원 관리자","Resource contributors":"자원 기여자","Restart RMT in this window":"이 창에서 RMT 재시작",Running:qa,Save:Xa,"Select an app to start your own rail map design!":"앱을 선택하여 나만의 철도 노선도 디자인을 시작하세요!","Show dev tools for 1 day":"1일 동안 개발자 도구 표시",Switch:Qa,"Switch to":"로 전환",System:Za,Tab:en,"Terms and conditions":"이용 약관",Tutorial:tn,"Official Website":"공식 웹사이트","Mini Metro Web":"미니 지하철 그리기 도구","Unable to load contributors":"기여자 목록을 불러올 수 없습니다","Useful links":"유용한 링크","Visit GitHub":"GitHub 방문","Web fonts":"웹 글꼴","Welcome to Rail Map Toolkit":"철도 노선도 도구에 오신 것을 환영합니다","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"여러 철도 노선도 도구를 동시에 열 수 없습니다. 이 창을 닫아주세요.","You're currently viewing a testing environment.":"현재 테스트 환경을 보고 있습니다.","Login status expired":"로그인 상태가 만료되었습니다","Log in / Sign up":"로그인 / 가입","Log out":"로그아웃","Change name":"이름 변경","Change password":"비밀번호 변경","Update account info":"계정 정보 업데이트",Change:on,Account:an,Welcome:nn,"Forgot password":"비밀번호를 잊으셨나요","Check your email again!":"이메일을 다시 확인하세요!","Email with reset link is sent to":"비밀번호 재설정 링크가 이메일로 전송되었습니다",Email:sn,"Send reset link":"재설정 링크 전송","Reset password token":"비밀번호 재설정 토큰",Password:rn,"Reset password":"비밀번호 재설정","Back to log in":"로그인으로 돌아가기","Log in":"로그인","Sign up":"가입","The email is not valid!":"이메일 주소가 유효하지 않습니다!","Verification email is sent to":"인증 이메일이 전송되었습니다",Name:un,"You may always change it later.":"나중에 언제든지 변경할 수 있습니다.","Send verification code":"인증 코드 전송","Verification code":"인증 코드","Failed to get the RMP save!":"RMP 저장을 가져오지 못했습니다!","Can not sync this save!":"이 저장을 동기화할 수 없습니다!","Synced saves":"동기화된 저장","Maximum save count:":"최대 저장 수:",Create:cn,"Current save":"현재 저장","Cloud save":"클라우드 저장","Last update at:":"마지막 업데이트:","Delete this save":"이 저장 삭제","Sync now":"지금 동기화","Sync this slot":"이 슬롯 동기화","All subscriptions":"모든 구독",Redeem:ln,"With this subscription, the following features are unlocked:":"이 구독으로 다음 기능이 잠금 해제됩니다:","PRO features":"PRO 기능","Sync 9 more saves":"추가 9개 저장 동기화","Unlimited master nodes":"마스터 노드 무제한","Unlimited parallel lines":"평행선 무제한","Expires at:":"만료일:","Not applicable":"해당 없음",Renew:dn,"Redeem your subscription":"구독을 교환하세요","CDKey could be purchased in the following sites:":"CDKey는 다음 사이트에서 구매할 수 있습니다:","Enter your CDKey here":"여기에 CDKey를 입력하세요","Oops! It seems there's a conflict":"이런! 충돌이 발생한 것 같습니다","The local save is newer than the cloud one. Which one would you like to keep?":"로컬 저장이 클라우드 저장보다 최신입니다. 어느 것을 유지하시겠습니까?","Local save":"로컬 저장","Replace cloud with local":"클라우드를 로컬로 교체","Download Local save":"로컬 저장 다운로드","Replace local with cloud":"로컬을 클라우드로 교체","Download Cloud save":"클라우드 저장 다운로드"},hn=new c.I18nBuilder().use(ge).withAppName("Rail Map Toolkit").withLng(c.getLanguage()).withDefaultResource(uo).withResource("en",ho).withResource("zh-Hans",Uo).withResource("zh-Hant",da).withResource("ja",Ga).withResource("ko",pn).build(),mn=()=>{document.querySelector('link[rel="canonical"]').setAttribute("href",window.location.origin)};mn();var m=(e=>(e.OPENED_TABS="openedTabs",e.ACTIVE_TAB="activeTab",e.LAST_SHOW_DEVTOOLS="lastShowDevtools",e.SHOW_FONT_ADVICE="showFontAdvice",e.ACCOUNT="account",e.RMP_SAVE="rmp-save",e))(m||{}),Y=(e=>(e.APP_LOAD="APP_LOAD",e.OPEN_APP="OPEN_APP",e.CLOSE_APP="CLOSE_APP",e.OPEN_LINK="OPEN_LINK",e.TOGGLE_NAV_MENU="TOGGLE_NAV_MENU",e.CHANGE_LANGUAGE="CHANGE_LANGUAGE",e.SHOW_DEVTOOLS="SHOW_DEVTOOLS",e.RAISE_ISSUE="RAISE_ISSUE",e.JOIN_SLACK="JOIN_SLACK",e.FOLLOW_BILIBILI="FOLLOW_BILIBILI",e.DOWNLOAD_FONT="DOWNLOAD_FONT",e))(Y||{});const gn="rmg-home:frame-",L={APP:"app",SEARCH_PARAMS:"searchParams",HASH_PARAMS:"hashParams"};var A=(e=>(e.AUTH_REGISTER="/auth/register",e.AUTH_LOGIN="/auth/login",e.AUTH_SEND_VERIFICATION_EMAIL="/auth/send-verification-email",e.AUTH_SEND_RESET_PASSWORD_EMAIL="/auth/forgot-password",e.AUTH_RESET_PASSWORD="/auth/reset-password",e.AUTH_REFRESH="/auth/refresh-tokens",e.AUTH_LOGOUT="/auth/logout",e.USER="/users",e.SUBSCRIPTION="/subscription",e.SUBSCRIPTION_REDEEM="/subscription/redeem",e.SAVES="/saves",e))(A||{});const G="https://railmapgen.org/v1";var k=(e=>(e.RMP="rmp__param",e))(k||{});const Cn={lastChangedAtTimeStamp:0,resolveConflictModal:{isOpen:!1,lastChangedAtTimeStamp:0,lastUpdatedAtTimeStamp:0,cloudData:""}},K=M({name:"save",initialState:Cn,reducers:{setLastChangedAtTimeStamp:(e,t)=>{e.lastChangedAtTimeStamp=t.payload},setResolveConflictModal:(e,t)=>{e.resolveConflictModal={isOpen:!0,lastChangedAtTimeStamp:t.payload.lastChangedAtTimeStamp,lastUpdatedAtTimeStamp:t.payload.lastUpdatedAtTimeStamp,cloudData:t.payload.cloudData}},clearResolveConflictModal:e=>{e.resolveConflictModal={isOpen:!1,lastChangedAtTimeStamp:0,lastUpdatedAtTimeStamp:0,cloudData:""}}}}),{setLastChangedAtTimeStamp:R,setResolveConflictModal:fn,clearResolveConflictModal:ps}=K.actions,wn=K.reducer,U=async(e,t,o)=>{const a={accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache"},n=structuredClone(a);o&&(n.Authorization=`Bearer ${o}`);const i=await fetch(`${G}${e}`,{headers:n,...t});if(i.status!==401)return i},Sn=async e=>{const t={accept:"application/json","Content-Type":"application/json"},o=await fetch(`${G}${A.AUTH_REFRESH}`,{method:"POST",headers:t,body:JSON.stringify({refreshToken:e})});return o.status!==200?void 0:await o.json()},q=async e=>{const t=e.getState().account;if(!t.isLoggedIn)return;const o=new Date(t.expires);if(l.debug(`Current time: ${new Date}, access token expires time: ${o}`),new Date().getTime()>o.getTime()){l.debug(`Token expires on ${o} needs to be refreshed on ${new Date}`);const a=new Date(t.refreshExpires);if(new Date().getTime()>a.getTime()){l.debug(`Refresh token expires on ${a}, logout!`),e.dispatch(y());return}const n=await Sn(t.refreshToken);if(l.debug(`Token refreshed with ${JSON.stringify(n)}`),!n){e.dispatch(y());return}e.dispatch(Mn({access:n.access.token,refresh:n.refresh.token})),e.dispatch($n({expires:n.access.expires,refreshExpires:n.refresh.expires}))}},vn=e=>new Promise(t=>{setTimeout(t,e,`Timeout after ${e/1e3} seconds`)}),An=()=>{const e=navigator.userAgent;return e.includes("Safari")&&!e.includes("Chrome")},T=(e,t,o)=>{const a=new URL(e,window.location.href);return a.search=t??a.search,a.hash=o??a.hash,a.pathname+a.search+a.hash},bn=async(e,t="SHA-256")=>{const a=new TextEncoder().encode(e),n=await crypto.subtle.digest(t,a);return Array.from(new Uint8Array(n)).map(s=>s.toString(16).padStart(2,"0")).join("")},X=async e=>{const t=localStorage.getItem(e);if(!t)return;const o=await bn(t);return{data:t,hash:o}},En=(e,t)=>{localStorage.setItem(e,t)},kn="rmt-save-manager",Q=new BroadcastChannel(kn),yn=()=>{Q.postMessage({type:"SAVE_CHANGED",key:k.RMP,from:"rmt"})};let O;const Tn=60*1e3,Rn=e=>{const t=async o=>{const{type:a,key:n,from:i}=o.data;a==="SAVE_CHANGED"&&i==="rmp"&&(l.info(`Received save changed event on key: ${n}`),e.dispatch(R(new Date().valueOf()))),!O&&(O=window.setTimeout(async()=>{O=void 0;const{isLoggedIn:s,currentSaveId:u,token:r,refreshToken:d}=e.getState().account;if(!s||!u||!r||!d)return;const{type:g,key:p,from:v}=o.data;if(g==="SAVE_CHANGED"&&v==="rmp"){if(l.info(`Update save after timeout on key: ${p}`),!s||!u){l.warn("Not logged in or no current save id. No save update.");return}const{saves:f}=e.getState().account,b=f.filter(le=>le.id===u).at(0);if(!b){l.error(`Save id: ${u} is not in saveList!`);return}const $=new Date(b.lastUpdateAt),{lastChangedAtTimeStamp:H}=e.getState().rmpSave;if(new Date(H)<$){l.warn(`Save id: ${u} is newer in the cloud via local compare.`),e.dispatch(B());return}l.info(`Update remote save id: ${u} with local key: ${p}`);const P=await Dn(u,r,d,p);if(!P){e.dispatch(y());return}if(P.status===409){l.warn(`Save id: ${u} is newer in the cloud via server response.`),e.dispatch(B());return}if(P.status!==200)return;e.dispatch(D())}},Tn))};Q.addEventListener("message",t)},Dn=async(e,t,o,a)=>{const n=await X(a);if(!n)return;const{data:i,hash:s}=n;return await U(A.SAVES+"/"+e,{method:"PATCH",body:JSON.stringify({data:i,hash:s})},t)},x={RMP_CLOUD:!1,RMP_EXPORT:!1},Bn={isLoggedIn:!1,id:void 0,name:"",email:void 0,token:void 0,expires:void 0,refreshToken:void 0,refreshExpires:void 0,activeSubscriptions:x,currentSaveId:void 0,saves:[]},D=F("account/getSaveList",async(e,{getState:t,dispatch:o,rejectWithValue:a})=>{const{isLoggedIn:n,token:i}=t().account;if(!n||!i)return a("No token.");const s=await U(A.SAVES,{},i);return s?s.status!==200?a(s.text):await s.json():(o(y()),a("Can not recover from expired refresh token."))}),hs=F("account/fetchLogin",async(e,{dispatch:t})=>{const{email:o,password:a}=e;try{const n=await fetch(G+A.AUTH_LOGIN,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:o,password:a})});if(n.status!==200)return{error:await n.text(),username:void 0};const{user:{name:i,id:s},tokens:{access:{token:u,expires:r},refresh:{token:d,expires:g}}}=await n.json();return t(ee({id:s,name:i,email:o,token:u,expires:r,refreshToken:d,refreshExpires:g})),await t(D()),await t(B()),{error:void 0,username:i}}catch(n){return{error:n.message,username:void 0}}}),B=F("account/syncAfterLogin",async(e,{getState:t,dispatch:o,rejectWithValue:a})=>{l.debug("Sync after login - check if local save is newer");const n=t(),{account:{isLoggedIn:i,token:s,currentSaveId:u,saves:r},rmpSave:{lastChangedAtTimeStamp:d}}=n,g=new Date(d),p=r.filter(H=>H.id===u).at(0);if(!i||!p)return a(`Save id: ${u} is not in saveList!`);const v=new Date(p.lastUpdateAt),f=await U(A.SAVES+"/"+u,{},s);if(!f)return o(y()),a("Login status expired.");if(f.status!==200)return a(await f.text());const b=await f.text(),$=await X(k.RMP);g<=v||!$?(l.info(`Set ${k.RMP} with save id: ${u}`),En(k.RMP,b),o(R(new Date().valueOf())),yn()):o(fn({lastChangedAtTimeStamp:g.valueOf(),lastUpdatedAtTimeStamp:v.valueOf(),cloudData:b}))}),Z=M({name:"account",initialState:Bn,reducers:{login:(e,t)=>{e.isLoggedIn=!0,e.id=t.payload.id,e.name=t.payload.name,e.email=t.payload.email,e.token=t.payload.token,e.expires=t.payload.expires,e.refreshToken=t.payload.refreshToken,e.refreshExpires=t.payload.refreshExpires,e.activeSubscriptions=x,e.currentSaveId=void 0,e.saves=[]},logout:e=>{e.isLoggedIn=!1,e.id=void 0,e.name=void 0,e.email=void 0,e.token=void 0,e.expires=void 0,e.refreshToken=void 0,e.refreshExpires=void 0,e.activeSubscriptions=x,e.currentSaveId=void 0,e.saves=[]},updateName:(e,t)=>{e.name=t.payload},setToken:(e,t)=>{e.token=t.payload.access,e.refreshToken=t.payload.refresh},setExpires:(e,t)=>{e.expires=t.payload.expires,e.refreshExpires=t.payload.refreshExpires},setActiveSubscriptions:(e,t)=>{e.activeSubscriptions=t.payload}},extraReducers:e=>{e.addCase(D.fulfilled,(t,o)=>{t.currentSaveId=o.payload.currentSaveId,t.saves=o.payload.saves}).addCase(D.rejected,(t,o)=>{console.log(t,o.payload)})}}),{login:ee,logout:y,updateName:ms,setActiveSubscriptions:gs,setToken:Mn,setExpires:$n}=Z.actions,Hn=Z.reducer,I=e=>e?["app","devtool"]:["app"],Pn=()=>{const e="https://ghfast.top/https://github.com/railmapgen/railmapgen.github.io/releases/download",t=new Date,o=`${t.getFullYear()}${String(t.getMonth()+1).padStart(2,"0")}01`,a=`${String(t.getFullYear()).slice(-2)}.${t.getMonth()+1}.1`,n=navigator.platform,i=n.includes("Linux")?"amd64.deb":n.includes("Mac")?"aarch64.dmg":"x64-setup.exe";return e+`/tauri-${o}/railmapgen_${a}_${i}`},C={rmg:{name:"Rail Map Generator",url:"/rmg/",assetType:"app",allowMultiInstances:!0},rmp:{name:"Rail Map Painter",url:"/rmp/",assetType:"app"},"rmg-palette":{name:"Palette",url:"/rmg-palette/",assetType:"app",showContributors:!0,legacyContributors:"legacy-contributor-list.txt"},"rmg-palette-upload":{name:"Palette - Upload",url:"/rmg-palette/#/new",assetType:"app"},"rmg-templates":{name:"RMG Templates",url:"/rmg-templates/",assetType:"app",showContributors:!0,legacyContributors:"legacy-contributor-list.txt",allowedInstances:["Org","GitHub","GitLab","Tauri","localhost","unknown"]},"rmg-templates-upload":{name:"RMG Templates - Upload",url:"/rmg-templates/#/new",assetType:"app",allowedInstances:["Org","GitHub","GitLab","Tauri","localhost","unknown"]},"rmp-gallery":{name:"RMP Gallery",url:"/rmp-gallery/",assetType:"app",showContributors:!0,showDonators:!0,allowedInstances:["Org","GitHub","GitLab","Tauri","localhost","unknown"]},"rmp-designer":{name:"RMP Designer",url:"/rmp-designer/",assetType:"app"},"mantine-components":{name:"Components",url:"/mantine-components/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"svg-assets":{name:"SVG Assets",url:"/svg-assets/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"rmg-translate":{name:"Translate",url:"/rmg-translate/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"seed-project":{name:"Seed Project",url:"/__APP_NAME__/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"rmg-runtime":{name:"Runtime Documentation",url:"/rmg-runtime/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"runtime-demo":{name:"Runtime Demo",url:"/runtime-demo/",assetType:"devtool",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"],allowMultiInstances:!0},tutorial:{name:"Tutorial",url:"https://rmttutorial.wordpress.com",assetType:"link"},"official-website":{name:"Official website",url:"https://railmapgen.org",assetType:"link",allowedInstances:["GitHub","GitLab","localhost","unknown"]},"github-pages":{name:"GitHub Pages mirror",url:"https://railmapgen.github.io",assetType:"link",allowedInstances:["Org","GitLab","localhost","unknown"]},"gitlab-pages":{name:"GitLab Pages mirror",url:"https://railmapgen.gitlab.io",assetType:"link",allowedInstances:["Org","GitHub","localhost","unknown"]},tauri:{name:"Download desktop app",url:Pn(),assetType:"link",allowedInstances:["Org","GitHub","GitLab","localhost","unknown"]},"mini-metro-web":{name:"Mini Metro Web",url:"https://mini-metro-web.gitlab.io/",assetType:"link"},busLineDesigner:{name:"Bus Line Designer",url:"https://buslinedesigner.bobliu.tech",assetType:"link"},linesPaper:{name:"LinesPaper线图荟",url:"https://space.bilibili.com/3546659889875715",assetType:"link"}},te=(e,t,o)=>Object.entries(C).filter(([,a])=>{const n=a.assetType===e,i=!a.allowedEnvs||a.allowedEnvs.includes(t),s=!a.allowedInstances||a.allowedInstances.includes(o);return n&&i&&s}).map(([a])=>a),Ln={isShowMenu:!0,menuView:"apps",refreshRequired:!1,lastShowDevtools:0,openedTabs:[],activeTab:void 0,remoteFonts:{},showFontAdvice:"hide"},oe=M({name:"app",initialState:Ln,reducers:{setIsPrimary:(e,t)=>{e.isPrimary=t.payload},terminateSession:e=>{e.isTerminated=!0},toggleMenu:e=>{e.isShowMenu=!e.isShowMenu},setMenuView:(e,t)=>{e.menuView=t.payload},requireRefresh:e=>{e.refreshRequired=!0},showDevtools:(e,t)=>{const o=Date.now();t.payload?t.payload<o&&(e.lastShowDevtools=t.payload):e.lastShowDevtools=o},hideDevtools:e=>{e.lastShowDevtools=0},setOpenedTabs:(e,t)=>{e.openedTabs=t.payload},setActiveTab:(e,t)=>{e.activeTab=t.payload},openApp:(e,t)=>{const{appId:o,search:a,hash:n}=t.payload,i=e.openedTabs.find(({id:r})=>r===e.activeTab),s=e.openedTabs.find(({app:r})=>r===o),u=C[o].allowMultiInstances??!1;if(a!==void 0||n!==void 0)if(u||!s){const r=crypto.randomUUID();e.openedTabs.push({id:r,app:o,url:T(C[o].url,a,n)}),e.activeTab=r}else e.openedTabs=e.openedTabs.map(r=>r.id===s.id?{...r,url:T(r.url??C[r.app].url,a,n)}:r),e.activeTab=s.id;else if(s)(i==null?void 0:i.app)!==o&&(e.activeTab=s.id);else{const r=crypto.randomUUID();e.openedTabs.push({id:r,app:o,url:T(C[o].url)}),e.activeTab=r}},openAppInNew:(e,t)=>{const o=crypto.randomUUID();e.openedTabs.push({id:o,app:t.payload}),e.activeTab=o},closeTab:(e,t)=>{var n;const o=t.payload,a=e.openedTabs.slice().sort((i,s)=>{const u=Object.keys(C);return u.indexOf(i.app)-u.indexOf(s.app)});if(e.openedTabs=e.openedTabs.filter(i=>i.id!==o),e.activeTab===o){const i=a.findIndex(s=>s.id===o);e.activeTab=(n=a.filter(s=>s.id!==o)[Math.max(0,i-1)])==null?void 0:n.id}},closeApp:(e,t)=>{var s,u;const o=t.payload;if(!e.openedTabs.some(r=>r.app===o))return;const a=Object.keys(C).filter(r=>e.openedTabs.some(d=>d.app===r)),n=(s=e.openedTabs.find(r=>r.id===e.activeTab))==null?void 0:s.app,i=e.openedTabs.filter(r=>r.app!==o);if(e.openedTabs=i,n===o){const r=a.findIndex(d=>d===o);e.activeTab=(u=i.find(d=>d.app===a[Math.max(0,r-1)]))==null?void 0:u.id}},updateTabMetadata:(e,t)=>{const{id:o,title:a,search:n,hash:i}=t.payload;e.openedTabs=e.openedTabs.map(s=>s.id===o?{...s,title:a??s.title,url:T(s.url??C[s.app].url,n,i)}:s)},addRemoteFont:(e,t)=>{const{family:o,config:a}=t.payload;o in e.remoteFonts||(e.remoteFonts[o]=a,e.showFontAdvice==="hide"&&(e.showFontAdvice="show"))},hideFontAdvice:e=>{e.showFontAdvice="hide"},neverShowFontAdvice:e=>{e.showFontAdvice="never"}}}),z=e=>{const t=Date.now();return e+864e5>=t},{setIsPrimary:On,terminateSession:xn,toggleMenu:Cs,setMenuView:fs,requireRefresh:ws,showDevtools:Fn,hideDevtools:Ss,setOpenedTabs:Gn,setActiveTab:W,openApp:ae,openAppInNew:vs,closeTab:As,closeApp:Un,updateTabMetadata:In,addRemoteFont:zn,hideFontAdvice:bs,neverShowFontAdvice:Nn}=oe.actions,_n=oe.reducer,Wn={notifications:[]},ne=M({name:"notification",initialState:Wn,reducers:{addNotification:(e,t)=>{e.notifications.push({...t.payload,id:crypto.randomUUID(),source:c.getAppName()})},removeNotification:(e,t)=>{const o=e.notifications.findIndex(a=>a.id===t.payload);o>-1&&e.notifications.splice(o,1)}}}),{addNotification:Es,removeNotification:ks}=ne.actions,jn=ne.reducer,Vn=Ce({app:_n,account:Hn,notification:jn,rmpSave:wn}),se=fe(),Jn=(e={})=>we({reducer:Vn,middleware:t=>t().prepend(se.middleware),preloadedState:e}),h=Jn(),ys=()=>Se(),Ts=ve,E=se.startListening;window.rmgStore=h;const Yn="rmt-instance-checker",N=crypto.randomUUID(),ie="ping",re="pong",ue="restart",w=new BroadcastChannel(Yn),ce=e=>{const{event:t,instance:o}=e.data;t===ie&&(l.info(`Received ping from another RMT instance ${o}.`),w.postMessage({event:re,instance:N}))};w.addEventListener("message",ce);w.addEventListener("message",e=>{const{event:t,instance:o}=e.data;t===ue&&(l.info(`Received restart from another RMT instance ${o}. Closing current session...`),w.close(),h.dispatch(xn()),h.dispatch(V()))});const Rs=()=>{w.postMessage({event:ue,instance:N})},Kn=async()=>{let e=!0;w.addEventListener("message",o=>{const{event:a,instance:n}=o.data;a===re&&(l.warn(`Received pong from another RMT instance ${n}. This instance is not primary.`),e=!1,w.removeEventListener("message",ce))}),w.postMessage({event:ie,instance:N});let t=5;for(;t--;)if(await vn(500),!e)return!1;return l.info("This instance is primary."),!0},qn=e=>{const t=Number(c.storage.get(m.LAST_SHOW_DEVTOOLS));t&&e.dispatch(Fn(t))},Xn=e=>{try{const t=c.storage.get(m.OPENED_TABS);if(t){const o=JSON.parse(t);if(Array.isArray(o)){const a=I(z(e.getState().app.lastShowDevtools)),n=o.filter(i=>a.includes(C[i.app].assetType));e.dispatch(Gn(n))}else l.warn("initOpenedTabs(), Cannot parse invalid opened tabs state from local storage")}}catch(t){l.warn("initOpenedTabs(), cannot parse opened apps state from local storage",t)}},Qn=e=>{var a;const t=c.storage.get(m.ACTIVE_TAB),o=e.getState().app.openedTabs;t&&o.some(({id:n})=>n===t)?e.dispatch(W(t)):e.dispatch(W((a=o[0])==null?void 0:a.id))},Zn=e=>{const t=new URLSearchParams(window.location.search),o=t.get(L.APP)??"",a=t.get(L.SEARCH_PARAMS)??void 0,n=t.get(L.HASH_PARAMS)??void 0;l.info(`openSearchedApp(), searchParams app=${o}, extraSearchParams are [${a}], extraHashParams are [${n}]`),I(z(e.getState().app.lastShowDevtools)).map(u=>te(u,c.getEnv(),c.getInstance())).flat().includes(o)?e.dispatch(ae({appId:o,search:a,hash:n})):l.warn(`openSearchedApp(), app ${o} not found`)},es=e=>{const t=c.storage.get(m.ACCOUNT);if(t){const a=JSON.parse(t);l.debug(`Get account data from local storage: ${JSON.stringify(a)}`),e.dispatch(ee(a))}setInterval(()=>q(e),6e4)},ts=e=>{const t=c.storage.get(m.RMP_SAVE);if(t){const o=JSON.parse(t);l.debug(`Get RMP save data from local storage: ${JSON.stringify(o)}`),e.dispatch(R(o.lastChangedAtTimeStamp))}else l.warn("No RMP save data from local storage. Setting lastChangedAtTimeStamp to 0."),e.dispatch(R(0))};function os(e){qn(e),Xn(e),Qn(e),es(e),ts(e),(An()||c.storage.get(m.SHOW_FONT_ADVICE)==="never")&&e.dispatch(Nn()),E({predicate:(t,o,a)=>o.app.lastShowDevtools!==a.app.lastShowDevtools,effect:(t,o)=>{c.storage.set(m.LAST_SHOW_DEVTOOLS,o.getState().app.lastShowDevtools.toString())}}),E({predicate:(t,o,a)=>JSON.stringify(o.app.openedTabs)!==JSON.stringify(a.app.openedTabs),effect:(t,o)=>{c.storage.set(m.OPENED_TABS,JSON.stringify(o.getState().app.openedTabs))}}),E({predicate:(t,o,a)=>o.app.activeTab!==a.app.activeTab,effect:(t,o)=>{const a=o.getState().app.activeTab;a!==void 0&&c.storage.set(m.ACTIVE_TAB,a)}}),E({predicate:(t,o,a)=>JSON.stringify(o.account)!==JSON.stringify(a.account),effect:(t,o)=>{const{isLoggedIn:a,id:n,name:i,email:s,token:u,expires:r,refreshToken:d,refreshExpires:g}=o.getState().account;a?c.storage.set(m.ACCOUNT,JSON.stringify({id:n,name:i,email:s,token:u,expires:r,refreshToken:d,refreshExpires:g})):(l.debug("Remove account from local storage due to logout."),c.storage.remove(m.ACCOUNT))}}),E({predicate:(t,o,a)=>o.rmpSave.lastChangedAtTimeStamp!==a.rmpSave.lastChangedAtTimeStamp,effect:(t,o)=>{const{lastChangedAtTimeStamp:a}=o.getState().rmpSave;c.storage.set(m.RMP_SAVE,JSON.stringify({lastChangedAtTimeStamp:a}))}}),Zn(e),Kn().then(t=>{e.dispatch(On(t)),t||e.dispatch(V())})}let j;const as=J.lazy(()=>ye(()=>import("./app-root-E0oc2WZz.js"),__vite__mapDeps([0,1,2,3,4,5]))),ns=()=>{j=de.createRoot(document.getElementById("root")),j.render(S.jsx(J.StrictMode,{children:S.jsx(Ae,{store:h,children:S.jsx(be,{i18n:hn,children:S.jsx(pe,{children:S.jsx(he,{suspenseFallback:S.jsx(me,{visible:!0}),allowReset:!0,children:S.jsx(as,{})})})})})}))};c.ready().then(async()=>{var t,o;os(h),await q(h),await h.dispatch(B()),ns();const e=c.getColourMode();e==="system"?(o=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-color-scheme: dark)"))!=null&&o.matches?window.localStorage.setItem("chakra-ui-color-mode","dark"):window.localStorage.setItem("chakra-ui-color-mode","light"):window.localStorage.setItem("chakra-ui-color-mode",e),c.onAppOpen(a=>{I(z(h.getState().app.lastShowDevtools)).map(s=>te(s,c.getEnv(),c.getInstance())).flat().includes(a.appId)&&h.dispatch(ae(a))}),c.onAppClose(a=>{h.dispatch(Un(a))}),c.onAppMetadataUpdate((a,n)=>{if(n){const i=n.slice(gn.length);l.info(`Received metadata update for frame=${i}, metadata is`,a),h.dispatch(In({...a,id:i}))}}),c.onRemoteFontLoaded(({family:a,definition:{displayName:n,url:i}})=>{h.dispatch(zn({family:a,config:{displayName:n,url:i}}))}),c.event(Y.APP_LOAD,{openedApps:h.getState().app.openedTabs.map(a=>a.app)}),Rn(h)});export{G as A,cs as B,z as C,Fn as D,Y as E,gn as F,Ss as G,ws as H,fs as I,Rs as J,ks as K,ds as L,ls as O,k as S,ys as a,Dn as b,En as c,R as d,ps as e,D as f,X as g,A as h,U as i,ms as j,Es as k,y as l,hs as m,yn as n,x as o,gs as p,C as q,vs as r,B as s,ae as t,Ts as u,Cs as v,W as w,As as x,Un as y,te as z};
