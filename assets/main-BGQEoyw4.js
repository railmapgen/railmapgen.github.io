const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-root-DCKyq2od.js","assets/mantine-DWzt5WZY.js","assets/react-DsRUXmja.js","assets/asset-enablements-CUa9RaDE.js","assets/index-DUJk8-tT.js","assets/index-B8SAUPxP.css","assets/app-root-BN2-hppM.css"])))=>i.map(i=>d[i]);
import{c as he}from"./index-DUJk8-tT.js";import{l as d,r as p,j as w,R as Se,a as me,L as ve}from"./mantine-DWzt5WZY.js";import{d as k,e as D,f as Ae,g as ge,h as Te,u as we,j as ye,k as q,r as W,P as Re,I as be}from"./react-DsRUXmja.js";import{i as L,a as A,t as Ee,g as $,b as z}from"./asset-enablements-CUa9RaDE.js";const _e="modulepreload",Oe=function(e){return"/"+e},V={},Ce=function(t,a,s){let o=Promise.resolve();if(a&&a.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=n?.nonce||n?.getAttribute("nonce");o=c(a.map(l=>{if(l=Oe(l),l in V)return;V[l]=!0;const u=l.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":_e,u||(h.as="script"),h.crossOrigin="",h.href=l,r&&h.setAttribute("nonce",r),document.head.appendChild(h),u)return new Promise((v,T)=>{h.addEventListener("load",v),h.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(n){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n}return o.then(n=>{for(const r of n||[])r.status==="rejected"&&i(r.reason);return t().catch(i)})},Le=()=>{document.querySelector('link[rel="canonical"]').setAttribute("href",window.location.origin)};Le();var S=(e=>(e.OPENED_TABS="openedTabs",e.ACTIVE_TAB="activeTab",e.LAST_SHOW_DEVTOOLS="lastShowDevtools",e.SHOW_FONT_ADVICE="showFontAdvice",e.ACCOUNT="account",e.RMP_SAVE="rmp-save",e))(S||{}),X=(e=>(e.APP_LOAD="APP_LOAD",e.OPEN_APP="OPEN_APP",e.CLOSE_APP="CLOSE_APP",e.OPEN_LINK="OPEN_LINK",e.TOGGLE_NAV_MENU="TOGGLE_NAV_MENU",e.CHANGE_LANGUAGE="CHANGE_LANGUAGE",e.SHOW_DEVTOOLS="SHOW_DEVTOOLS",e.RAISE_ISSUE="RAISE_ISSUE",e.JOIN_SLACK="JOIN_SLACK",e.FOLLOW_BILIBILI="FOLLOW_BILIBILI",e.DOWNLOAD_FONT="DOWNLOAD_FONT",e))(X||{});const Me="rmg-home:frame-",b={APP:"app",SEARCH_PARAMS:"searchParams",SEARCH_PARAMS_SHORT:"s",HASH_PARAMS:"hashParams",HASH_PARAMS_SHORT:"h"};var y=(e=>(e.AUTH_REGISTER="/auth/register",e.AUTH_LOGIN="/auth/login",e.AUTH_SEND_VERIFICATION_EMAIL="/auth/send-verification-email",e.AUTH_SEND_RESET_PASSWORD_EMAIL="/auth/forgot-password",e.AUTH_RESET_PASSWORD="/auth/reset-password",e.AUTH_REFRESH="/auth/refresh-tokens",e.AUTH_LOGOUT="/auth/logout",e.USER="/users",e.SUBSCRIPTION="/subscription",e.SUBSCRIPTION_REDEEM="/subscription/redeem",e.SAVES="/saves",e.SHARE="/share",e))(y||{});const Q="https://railmapgen.org/v1";var _=(e=>(e.RMP="rmp__param",e))(_||{});const O=async(e,t,a)=>{const s={accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache"},o=structuredClone(s);return a&&(o.Authorization=`Bearer ${a}`),await fetch(`${Q}${e}`,{headers:o,...t})},xe=async e=>{const t={accept:"application/json","Content-Type":"application/json"},a=await fetch(`${Q}${y.AUTH_REFRESH}`,{method:"POST",headers:t,body:JSON.stringify({refreshToken:e}),signal:AbortSignal.timeout(3e3)});if(a.status!==200)throw new Error(`Failed to refresh token with status ${a.status}: ${await a.text()}`);return await a.json()},Y=async(e,t=!1)=>{const a=e.getState().account;if(!a.isLoggedIn)return;const s=new Date(a.expires);if(d.debug(`Current time: ${new Date}, access token expires time: ${s}`),t||new Date().getTime()>s.getTime()){d.debug(`Token expires on ${s} needs to be refreshed on ${new Date}`);const o=new Date(a.refreshExpires);if(new Date().getTime()>o.getTime()){d.debug(`Refresh token expires on ${o}, logout!`),e.dispatch(R());return}try{const i=await xe(a.refreshToken);d.debug(`Token refreshed with ${JSON.stringify(i)}`),e.dispatch(Xe({access:i.access.token,refresh:i.refresh.token})),e.dispatch(Qe({expires:i.access.expires,refreshExpires:i.refresh.expires}))}catch(i){d.error(`Failed to refresh token: ${i}, logout!`),e.dispatch(R())}}},Ie={lastChangedAtTimeStamp:0,resolveConflictModal:{isOpen:!1,lastChangedAtTimeStamp:0,lastUpdatedAtTimeStamp:0,cloudData:""}},Z=k({name:"save",initialState:Ie,reducers:{setLastChangedAtTimeStamp:(e,t)=>{e.lastChangedAtTimeStamp=t.payload},setResolveConflictModal:(e,t)=>{e.resolveConflictModal={isOpen:!0,lastChangedAtTimeStamp:t.payload.lastChangedAtTimeStamp,lastUpdatedAtTimeStamp:t.payload.lastUpdatedAtTimeStamp,cloudData:t.payload.cloudData}},clearResolveConflictModal:e=>{e.resolveConflictModal={isOpen:!1,lastChangedAtTimeStamp:0,lastUpdatedAtTimeStamp:0,cloudData:""}}}}),{setLastChangedAtTimeStamp:M,setResolveConflictModal:ke,clearResolveConflictModal:_t}=Z.actions,De=Z.reducer,Ne=e=>new Promise(t=>{setTimeout(t,e,`Timeout after ${e/1e3} seconds`)}),Pe=()=>{const e=navigator.userAgent;return e.includes("Safari")&&!e.includes("Chrome")},C=(e,t,a)=>{const s=new URL(e,window.location.href);return s.search=t??s.search,s.hash=a??s.hash,s.pathname+s.search+s.hash},Ue=async(e,t="SHA-256")=>{const s=new TextEncoder().encode(e),o=await crypto.subtle.digest(t,s);return Array.from(new Uint8Array(o)).map(n=>n.toString(16).padStart(2,"0")).join("")},K=async e=>{const t=localStorage.getItem(e);if(!t)return;const a=await Ue(t);return{data:t,hash:a}},He=(e,t)=>{localStorage.setItem(e,t)},$e="rmt-save-manager",ee=new BroadcastChannel($e),Fe=()=>{ee.postMessage({type:"SAVE_CHANGED",key:_.RMP,from:"rmt"})};let H;const Ge=60*1e3,Ve=e=>{const t=async a=>{const{type:s,key:o,from:i}=a.data;s==="SAVE_CHANGED"&&i==="rmp"&&(d.info(`Received save changed event on key: ${o}`),e.dispatch(M(new Date().valueOf()))),!H&&(H=window.setTimeout(async()=>{H=void 0;const{isLoggedIn:n,currentSaveId:r,token:c,refreshToken:l}=e.getState().account;if(!n||!r||!c||!l)return;const{type:u,key:m,from:h}=a.data;if(u==="SAVE_CHANGED"&&h==="rmp"){if(d.info(`Update save after timeout on key: ${m}`),!n||!r){d.warn("Not logged in or no current save id. No save update.");return}const{saves:v}=e.getState().account,T=v.filter(fe=>fe.id===r).at(0);if(!T){d.error(`Save id: ${r} is not in saveList!`);return}const N=new Date(T.lastUpdateAt),{lastChangedAtTimeStamp:P}=e.getState().rmpSave;if(new Date(P)<N){d.warn(`Save id: ${r} is newer in the cloud via local compare.`);return}d.info(`Update remote save id: ${r} with local key: ${m}`);const U=await Be(r,c,l,m);if(!U){e.dispatch(R());return}if(U.status===409){d.warn(`Save id: ${r} is newer in the cloud via server response.`);return}if(U.status!==200)return;e.dispatch(I())}},Ge))};ee.addEventListener("message",t)},Be=async(e,t,a,s)=>{const o=await K(s);if(!o)return;const{data:i,hash:n}=o,r=await O(y.SAVES+"/"+e,{method:"PATCH",body:JSON.stringify({data:i,hash:n})},t);if(r.status!==401)return r},je={notifications:[]},te=k({name:"notification",initialState:je,reducers:{addNotification:(e,t)=>{e.notifications.push({...t.payload,id:crypto.randomUUID(),source:p.getAppName()})},addRemoteNotification:(e,t)=>{e.notifications.push(t.payload)},removeNotification:(e,t)=>{const a=e.notifications.findIndex(s=>s.id===t.payload);a>-1&&e.notifications.splice(a,1)}}}),{addNotification:B,addRemoteNotification:Je,removeNotification:Ot}=te.actions,qe=te.reducer,x={RMP_CLOUD:void 0,RMP_EXPORT:void 0},We={isLoggedIn:!1,id:void 0,name:"",email:void 0,token:void 0,expires:void 0,refreshToken:void 0,refreshExpires:void 0,activeSubscriptions:x,currentSaveId:void 0,saves:[]},I=D("account/getSaveList",async(e,{getState:t,dispatch:a,rejectWithValue:s})=>{const{isLoggedIn:o,token:i}=t().account;if(!o||!i)return s("No token.");const n=await O(y.SAVES,{},i);return n.status===401?(a(R()),s("Can not recover from expired refresh token.")):n.status!==200?s(n.text):await n.json()}),Ct=D("account/fetchLogin",async(e,{dispatch:t})=>{const{email:a,password:s}=e;try{const o=await O(y.AUTH_LOGIN,{method:"POST",body:JSON.stringify({email:a,password:s})});if(o.status!==200)return{error:await o.text(),username:void 0};const{user:{name:i,id:n},tokens:{access:{token:r,expires:c},refresh:{token:l,expires:u}}}=await o.json();return t(oe({id:n,name:i,email:a,token:r,expires:c,refreshToken:l,refreshExpires:u})),t(se()),await t(I()),await t(ae()),{error:void 0,username:i}}catch(o){return{error:o.message,username:void 0}}}),ae=D("account/syncAfterLogin",async(e,{getState:t,dispatch:a,rejectWithValue:s})=>{d.debug("Sync after login - check if local save is newer");const o=t(),{account:{isLoggedIn:i,token:n,currentSaveId:r,saves:c},rmpSave:{lastChangedAtTimeStamp:l}}=o,u=new Date(l),m=c.filter(P=>P.id===r).at(0);if(!i||!m)return s(`Save id: ${r} is not in saveList!`);const h=new Date(m.lastUpdateAt),v=await O(y.SAVES+"/"+r,{},n);if(v.status===401)return a(R()),s("Login status expired.");if(v.status!==200)return s(await v.text());const T=await v.text(),N=await K(_.RMP);u<=h||!N?(d.info(`Set ${_.RMP} with save id: ${r}`),He(_.RMP,T),a(M(new Date().valueOf())),Fe()):a(ke({lastChangedAtTimeStamp:u.valueOf(),lastUpdatedAtTimeStamp:h.valueOf(),cloudData:T}))}),se=D("account/fetchSubscription",async(e,{getState:t,dispatch:a,rejectWithValue:s})=>{const{isLoggedIn:o,token:i}=t().account;if(!o||!i)return s("No token.");const n=await O(y.SUBSCRIPTION,{},i);if(n.status===401)return a(B({title:L.t("Unable to retrieve your subscriptions"),message:L.t("Login status expired."),duration:60,type:"error"})),a(R()),s("Login status expired.");if(n.status!==200)return a(B({title:L.t("Unable to retrieve your subscriptions"),message:await n.text(),duration:60,type:"error"})),s(await n.text());const r=(await n.json()).subscriptions,c=structuredClone(x);for(const l of r){const u=l.type;u in c&&(c[u]=l.expires)}a(ze(c))}),ne=k({name:"account",initialState:We,reducers:{login:(e,t)=>{e.isLoggedIn=!0,e.id=t.payload.id,e.name=t.payload.name,e.email=t.payload.email,e.token=t.payload.token,e.expires=t.payload.expires,e.refreshToken=t.payload.refreshToken,e.refreshExpires=t.payload.refreshExpires,e.activeSubscriptions=x,e.currentSaveId=void 0,e.saves=[]},logout:e=>{e.isLoggedIn=!1,e.id=void 0,e.name=void 0,e.email=void 0,e.token=void 0,e.expires=void 0,e.refreshToken=void 0,e.refreshExpires=void 0,e.activeSubscriptions=x,e.currentSaveId=void 0,e.saves=[]},updateName:(e,t)=>{e.name=t.payload},setToken:(e,t)=>{e.token=t.payload.access,e.refreshToken=t.payload.refresh},setExpires:(e,t)=>{e.expires=t.payload.expires,e.refreshExpires=t.payload.refreshExpires},setActiveSubscriptions:(e,t)=>{e.activeSubscriptions=t.payload}},extraReducers:e=>{e.addCase(I.fulfilled,(t,a)=>{t.currentSaveId=a.payload.currentSaveId,t.saves=a.payload.saves}).addCase(I.rejected,(t,a)=>{console.log(t,a.payload)})}}),{login:oe,logout:R,updateName:Lt,setActiveSubscriptions:ze,setToken:Xe,setExpires:Qe}=ne.actions,Ye=ne.reducer,Ze={isShowMenu:!0,menuView:"apps",refreshRequired:!1,lastShowDevtools:0,openedTabs:[],activeTab:void 0,remoteFonts:{},showFontAdvice:"hide"},ie=k({name:"app",initialState:Ze,reducers:{setIsPrimary:(e,t)=>{e.isPrimary=t.payload},terminateSession:e=>{e.isTerminated=!0},toggleMenu:e=>{e.isShowMenu=!e.isShowMenu},setMenuView:(e,t)=>{e.menuView=t.payload},requireRefresh:e=>{e.refreshRequired=!0},showDevtools:(e,t)=>{const a=Date.now();t.payload?t.payload<a&&(e.lastShowDevtools=t.payload):e.lastShowDevtools=a},hideDevtools:e=>{e.lastShowDevtools=0},setOpenedTabs:(e,t)=>{e.openedTabs=t.payload},setActiveTab:(e,t)=>{e.activeTab=t.payload},openApp:(e,t)=>{const{appId:a,search:s,hash:o}=t.payload,i=e.openedTabs.find(({id:c})=>c===e.activeTab),n=e.openedTabs.find(({app:c})=>c===a),r=A[a].allowMultiInstances??!1;if(s!==void 0||o!==void 0)if(r||!n){const c=crypto.randomUUID();e.openedTabs.push({id:c,app:a,url:C(A[a].url,s,o)}),e.activeTab=c}else e.openedTabs=e.openedTabs.map(c=>c.id===n.id?{...c,url:C(c.url??A[c.app].url,s,o)}:c),e.activeTab=n.id;else if(n)i?.app!==a&&(e.activeTab=n.id);else{const c=crypto.randomUUID();e.openedTabs.push({id:c,app:a,url:C(A[a].url)}),e.activeTab=c}},openAppInNew:(e,t)=>{const a=crypto.randomUUID();e.openedTabs.push({id:a,app:t.payload}),e.activeTab=a},openTempApp:(e,t)=>{const a=t.payload;e.openedTabs.some(o=>o.id===a)||e.openedTabs.push({id:a,app:a,url:Ee[a]}),e.activeTab=a},closeTab:(e,t)=>{const a=t.payload,s=e.openedTabs.slice().sort((o,i)=>{const n=Object.keys(A);return n.indexOf(o.app)-n.indexOf(i.app)});if(e.openedTabs=e.openedTabs.filter(o=>o.id!==a),e.activeTab===a){const o=s.findIndex(i=>i.id===a);e.activeTab=s.filter(i=>i.id!==a)[Math.max(0,o-1)]?.id}},closeApp:(e,t)=>{const a=t.payload;if(!e.openedTabs.some(n=>n.app===a))return;const s=Object.keys(A).filter(n=>e.openedTabs.some(r=>r.app===n)),o=e.openedTabs.find(n=>n.id===e.activeTab)?.app,i=e.openedTabs.filter(n=>n.app!==a);if(e.openedTabs=i,o===a){const n=s.findIndex(r=>r===a);e.activeTab=i.find(r=>r.app===s[Math.max(0,n-1)])?.id}},updateTabMetadata:(e,t)=>{const{id:a,title:s,search:o,hash:i}=t.payload;e.openedTabs=e.openedTabs.map(n=>n.id===a?{...n,title:s??n.title,url:C(n.url??A[n.app].url,o,i)}:n)},addRemoteFont:(e,t)=>{const{family:a,config:s}=t.payload;a in e.remoteFonts||(e.remoteFonts[a]=s,e.showFontAdvice==="hide"&&(e.showFontAdvice="show"))},hideFontAdvice:e=>{e.showFontAdvice="hide"},neverShowFontAdvice:e=>{e.showFontAdvice="never"}}}),F=e=>{const t=Date.now();return e+864e5>=t},{setIsPrimary:Ke,terminateSession:et,toggleMenu:Mt,setMenuView:xt,requireRefresh:It,showDevtools:tt,hideDevtools:kt,setOpenedTabs:at,setActiveTab:j,openApp:re,openAppInNew:Dt,openTempApp:Nt,closeTab:Pt,closeApp:st,updateTabMetadata:nt,addRemoteFont:ot,hideFontAdvice:Ut,neverShowFontAdvice:it}=ie.actions,rt=ie.reducer,ct=Ae({app:rt,account:Ye,notification:qe,rmpSave:De}),ce=ge(),dt=(e={})=>Te({reducer:ct,middleware:t=>t().prepend(ce.middleware),preloadedState:e}),f=dt(),Ht=()=>we(),$t=ye,E=ce.startListening;window.rmgStore=f;const pt="rmt-instance-checker",G=crypto.randomUUID(),de="ping",pe="pong",le="restart",g=new BroadcastChannel(pt),ue=e=>{const{event:t,instance:a}=e.data;t===de&&(d.info(`Received ping from another RMT instance ${a}.`),g.postMessage({event:pe,instance:G}))};g.addEventListener("message",ue);g.addEventListener("message",e=>{const{event:t,instance:a}=e.data;t===le&&(d.info(`Received restart from another RMT instance ${a}. Closing current session...`),g.close(),f.dispatch(et()),f.dispatch(q()))});const Ft=()=>{g.postMessage({event:le,instance:G})},lt=async()=>{let e=!0;g.addEventListener("message",a=>{const{event:s,instance:o}=a.data;s===pe&&(d.warn(`Received pong from another RMT instance ${o}. This instance is not primary.`),e=!1,g.removeEventListener("message",ue))}),g.postMessage({event:de,instance:G});let t=5;for(;t--;)if(await Ne(500),!e)return!1;return d.info("This instance is primary."),!0},ut=e=>{const t=Number(p.storage.get(S.LAST_SHOW_DEVTOOLS));t&&e.dispatch(tt(t))},ft=e=>{try{const t=p.storage.get(S.OPENED_TABS);if(t){const a=JSON.parse(t);if(Array.isArray(a)){const s=$(F(e.getState().app.lastShowDevtools)),o=a.filter(i=>s.includes(A[i.app].assetType));e.dispatch(at(o))}else d.warn("initOpenedTabs(), Cannot parse invalid opened tabs state from local storage")}}catch(t){d.warn("initOpenedTabs(), cannot parse opened apps state from local storage",t)}},ht=e=>{const t=p.storage.get(S.ACTIVE_TAB),a=e.getState().app.openedTabs;t&&a.some(({id:s})=>s===t)?e.dispatch(j(t)):e.dispatch(j(a[0]?.id))},St=e=>{const t=new URLSearchParams(window.location.search),a=t.get(b.APP)??"",s=t.get(b.SEARCH_PARAMS)??t.get(b.SEARCH_PARAMS_SHORT)??void 0,o=t.get(b.HASH_PARAMS)??t.get(b.HASH_PARAMS_SHORT)??void 0;d.info(`openSearchedApp(), searchParams app=${a}, extraSearchParams are [${s}], extraHashParams are [${o}]`),$(F(e.getState().app.lastShowDevtools)).map(r=>z(r,p.getEnv(),p.getInstance())).flat().includes(a)?e.dispatch(re({appId:a,search:s,hash:o})):d.warn(`openSearchedApp(), app ${a} not found`)},mt=e=>{const t=p.storage.get(S.ACCOUNT);if(t){const s=JSON.parse(t);d.debug(`Get account data from local storage: ${JSON.stringify(s)}`),e.dispatch(oe(s))}setInterval(()=>Y(e),6e4)},vt=e=>{const t=p.storage.get(S.RMP_SAVE);if(t){const a=JSON.parse(t);d.debug(`Get RMP save data from local storage: ${JSON.stringify(a)}`),e.dispatch(M(a.lastChangedAtTimeStamp))}else d.warn("No RMP save data from local storage. Setting lastChangedAtTimeStamp to 0."),e.dispatch(M(0))};function At(e){ut(e),ft(e),ht(e),mt(e),vt(e),(Pe()||p.storage.get(S.SHOW_FONT_ADVICE)==="never")&&e.dispatch(it()),E({predicate:(t,a,s)=>a.app.lastShowDevtools!==s.app.lastShowDevtools,effect:(t,a)=>{p.storage.set(S.LAST_SHOW_DEVTOOLS,a.getState().app.lastShowDevtools.toString())}}),E({predicate:(t,a,s)=>JSON.stringify(a.app.openedTabs)!==JSON.stringify(s.app.openedTabs),effect:(t,a)=>{p.storage.set(S.OPENED_TABS,JSON.stringify(a.getState().app.openedTabs))}}),E({predicate:(t,a,s)=>a.app.activeTab!==s.app.activeTab,effect:(t,a)=>{const s=a.getState().app.activeTab;s!==void 0&&p.storage.set(S.ACTIVE_TAB,s)}}),E({predicate:(t,a,s)=>JSON.stringify(a.account)!==JSON.stringify(s.account),effect:(t,a)=>{const{isLoggedIn:s,id:o,name:i,email:n,token:r,expires:c,refreshToken:l,refreshExpires:u}=a.getState().account;s?p.storage.set(S.ACCOUNT,JSON.stringify({id:o,name:i,email:n,token:r,expires:c,refreshToken:l,refreshExpires:u})):(d.debug("Remove account from local storage due to logout."),p.storage.remove(S.ACCOUNT))}}),E({predicate:(t,a,s)=>a.rmpSave.lastChangedAtTimeStamp!==s.rmpSave.lastChangedAtTimeStamp,effect:(t,a)=>{const{lastChangedAtTimeStamp:s}=a.getState().rmpSave;p.storage.set(S.RMP_SAVE,JSON.stringify({lastChangedAtTimeStamp:s}))}}),St(e),lt().then(t=>{e.dispatch(Ke(t)),t||e.dispatch(q())})}let J;const gt=W.lazy(()=>Ce(()=>import("./app-root-DCKyq2od.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Tt=()=>{J=he.createRoot(document.getElementById("root")),J.render(w.jsx(W.StrictMode,{children:w.jsx(Re,{store:f,children:w.jsx(be,{i18n:L,children:w.jsx(Se,{children:w.jsx(me,{suspenseFallback:w.jsx(ve,{visible:!0}),allowReset:!0,children:w.jsx(gt,{})})})})})}))};p.ready().then(async()=>{At(f),await Y(f,!0),await f.dispatch(ae()),f.dispatch(se()),Tt();const e=p.getColourMode();e==="system"?window.matchMedia?.("(prefers-color-scheme: dark)")?.matches?window.localStorage.setItem("chakra-ui-color-mode","dark"):window.localStorage.setItem("chakra-ui-color-mode","light"):window.localStorage.setItem("chakra-ui-color-mode",e),p.onAppOpen(t=>{$(F(f.getState().app.lastShowDevtools)).map(o=>z(o,p.getEnv(),p.getInstance())).flat().includes(t.appId)&&f.dispatch(re(t))}),p.onAppClose(t=>{f.dispatch(st(t))}),p.onAppMetadataUpdate((t,a)=>{if(a){const s=a.slice(Me.length);d.info(`Received metadata update for frame=${s}, metadata is`,t),f.dispatch(nt({...t,id:s}))}}),p.onRemoteFontLoaded(({family:t,definition:{displayName:a,url:s}})=>{f.dispatch(ot({family:t,config:{displayName:a,url:s}}))}),p.onNewNotification(t=>{f.dispatch(Je(t))}),p.event(X.APP_LOAD,{openedApps:f.getState().app.openedTabs.map(t=>t.app)}),Ve(f)});export{y as A,Nt as B,xt as C,Ft as D,X as E,Me as F,Ot as G,_ as S,$t as a,Be as b,He as c,M as d,_t as e,I as f,K as g,O as h,Lt as i,B as j,Ct as k,R as l,se as m,Fe as n,re as o,Dt as p,j as q,Pt as r,ae as s,Mt as t,Ht as u,st as v,F as w,tt as x,kt as y,It as z};
