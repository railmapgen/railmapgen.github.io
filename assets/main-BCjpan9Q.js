import{r as p,R as a,c as O,a as x,b as I,d as _}from"./rmg-theme-provider-8iDCBseT.js";import{j as g}from"./chakra--OYt8vue.js";import{i as U,d as j,e as B,f as H,h as V,u as W,j as J,k as y,r as $,P as z,I as Y}from"./react-ChmrgLrp.js";function Uo(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const F="modulepreload",q=function(e){return"/"+e},v={},X=function(t,o,s){let i=Promise.resolve();if(o&&o.length>0){const r=document.getElementsByTagName("link");i=Promise.all(o.map(n=>{if(n=q(n),n in v)return;v[n]=!0;const c=n.endsWith(".css"),l=c?'[rel="stylesheet"]':"";if(!!s)for(let h=r.length-1;h>=0;h--){const C=r[h];if(C.href===n&&(!c||C.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(n,'"]').concat(l)))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":F,c||(m.as="script",m.crossOrigin=""),m.href=n,document.head.appendChild(m),c)return new Promise((h,C)=>{m.addEventListener("load",h),m.addEventListener("error",()=>C(new Error("Unable to preload CSS for ".concat(n))))})}))}return i.then(()=>t()).catch(r=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=r,window.dispatchEvent(n),!n.defaultPrevented)throw r})},Q=()=>{document.querySelector('link[rel="canonical"]').setAttribute("href",window.location.origin)};Q();const Z="操作",K="应用程序",ee="黑",te="取消",oe="城市",ne="组件",ae="确定",se="继续",ie="复制",re="编辑",ce="语言/Language",le="理由",pe="名称",de="下一步",ue="打开",me="调色板",ge="上一步",be="删除",he="重置",Te="设置",Re="提交",Ce="翻译",we="上传",fe="白",ve={Action:Z,Apps:K,"Back to list":"返回列表","Background colour":"背景色",Black:ee,Cancel:te,City:oe,Components:ne,"Configuration file":"配置文件",Confirm:ae,Continue:se,"Country/Region":"国家/地区",Copy:ie,Edit:re,"Foreground colour":"前景色","Go back":"返回",Language:ce,Justification:le,Name:pe,Next:de,Open:ue,Palette:me,"Please select...":"请选择...",Previous:ge,"Rail Map Generator":"铁路线路图生成器","Rail Map Painter":"地铁线路图绘制器","Rail Map Toolkit":"线路图工具包",Remove:be,Reset:he,"RMG Templates":"RMG 模板","RMP Gallery":"RMP 画廊","Seed Project":"种子项目",Settings:Te,Submit:Re,Translate:Ce,Upload:we,White:fe},ke="動作",Ae="應用程式",Pe="黑",ye="取消",$e="城市",Me="元件",Se="確定",Ee="繼續",Ge="複製",De="編輯",Le="語言/Language",Ne="理由",Oe="名稱",xe="下一步",Ie="開啟",_e="調色盤",Ue="上一步",je="移除",Be="重設",He="設定",Ve="提交",We="翻譯",Je="上載",ze="白",Ye={Action:ke,Apps:Ae,"Back to list":"返回列表","Background colour":"背景色",Black:Pe,Cancel:ye,City:$e,Components:Me,"Configuration file":"設定檔",Confirm:Se,Continue:Ee,Copy:Ge,"Country/Region":"國家/地區",Edit:De,"Foreground colour":"前景色","Go back":"返回",Language:Le,Justification:Ne,Name:Oe,Next:xe,Open:Ie,Palette:_e,"Please select...":"請選擇...",Previous:Ue,"Rail Map Generator":"鐵路路綫圖產生器","Rail Map Painter":"地鐵路綫圖繪製器","Rail Map Toolkit":"路綫圖工具組",Remove:je,Reset:Be,"RMG Templates":"RMG 範本","RMP Gallery":"RMP 畫廊","Seed Project":"種子項目",Settings:He,Submit:Ve,Translate:We,Upload:Je,White:ze},Fe="言語/Language",qe="パレット",Xe="削除",Qe={Language:Fe,Palette:qe,"Rail Map Generator":"鉄道路線図ジェネレータ","Rail Map Toolkit":"路線図ツールキット",Remove:Xe,"RMG Templates":"RMG テンプレート"},Ze="조작",Ke="앱",et="블랙",tt="취소",ot="도시",nt="요소",at="확인",st="복사",it="편집",rt="언어/Language",ct="이유",lt="명칭",pt="다음",dt="열기",ut="팔레트",mt="나아가",gt="삭제",bt="리셋",ht="설치",Tt="제출",Rt="번역",Ct="업로드",wt="화이트",ft={Action:Ze,Apps:Ke,"Back to list":"다시 목록으로","Background colour":"배경색",Black:et,Cancel:tt,City:ot,Components:nt,"Configuration file":"환경 설정 파일",Confirm:at,Copy:st,"Country/Region":"국가/지역",Edit:it,"Foreground colour":"전경색","Go back":"되돌아가",Language:rt,Justification:ct,Name:lt,Next:pt,Open:dt,Palette:ut,"Please select...":"선택해주세요",Previous:mt,"Rail Map Generator":"철도 노선도 생성기","Rail Map Painter":"지하철 노선도 그리기","Rail Map Toolkit":"노선도 툴킷",Remove:gt,Reset:bt,"RMG Templates":"RMG 템플릿","RMP Gallery":"RMP 갤러리","Seed Project":"종자 프로젝트",Settings:ht,Submit:Tt,Translate:Rt,Upload:Ct,White:wt};var vt={en:{},"zh-Hans":ve,"zh-Hant":Ye,ja:Qe,ko:ft};const kt={header:"Cookies on this website",text1:"At RMG we use cookies to help ensure that our website and services are able to function properly. These cookies are necessary and so are set automatically.",text2:"We would also like to use some cookies to:",item1:"improve our website based on how you use it",text3:"These cookies are optional. If you'd like to accept all optional cookies, select 'Accept all cookies'. If you'd like to reject them, select 'Reject'.",accept:"Accept all cookies",reject:"Reject"},At={CookiesModal:kt},Pt={header:"本网站的 Cookies",text1:"在 RMG，我们使用 Cookies 来确保本网站及服务可以正常运作。这些 Cookies 是必需的，因此已默认启动。",text2:"我们也会以 Cookies 的方式：",item1:"分析您的使用模式，用来改进本网站",text3:"这些 Cookies 是可选的。如果您想允许所有可选 Cookies，请选择“接受所有 Cookies”。如果您想禁用 Cookies，请选择“拒绝”。",accept:"接受所有 Cookies",reject:"拒绝"},yt="关于",$t="外观",Mt="贡献者",St="深色",Et="捐赠者",Gt="Gitee (码云)",Dt="浅色",Lt="更多",Nt="隐私",Ot="正在运行",xt="保存",It="切换",_t="跟随系统",Ut="标签页",jt="使用教程",Bt={CookiesModal:Pt,About:yt,"Allow cookies to help improve our website":"允许用 Cookies 帮助改进本网站",Appearance:$t,"Back to production environment":"返回生产环境","Close all tabs":"关闭所有标签页","Close app":"关闭应用程序","Close current tab":"关闭当前标签页","Close tab":"关闭标签页","Contribution Wiki":"贡献者指南",Contributors:Mt,"Current session has been terminated. Please close this window.":"当前会话已被终止，请关闭此窗口。",Dark:St,"Developer team":"开发者团队",Donators:Et,"Download desktop app":"下载桌面应用程序",Gitee:Gt,Light:Dt,"Main languages":"主要语言",More:Lt,"More mirrors":"更多镜像","New tab":"新标签页","Notes: Contributors are sorted by number of commits and commit time.":"注：贡献者名单按提交次数和时间排序。","Other languages":"其他语言",Privacy:Nt,"Privacy settings":"隐私设置","Rail Map Toolkit is opened in another window":"线路图工具包已在另一窗口中打开","Refreshing is required for changes to take effect.":"刷新页面后变更才会生效","Resource administrators":"资源管理员","Resource contributors":"资源贡献者","Restart RMT in this window":"在此窗口重新启动工具包",Running:Ot,Save:xt,"Select an app to start your own rail map design!":"选择一个应用程序来开始你的线路图设计！",Switch:It,"Switch to":"切换至",System:_t,Tab:Ut,"Terms and conditions":"条款与细则",Tutorial:jt,"Unable to load contributors":"无法加载贡献者名单","Visit GitHub":"访问 GitHub","Welcome to Rail Map Toolkit":"欢迎使用线路图工具包","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"您不能同时打开多个线路图工具包，请关闭当前窗口。","You're currently viewing a testing environment.":"您正在浏览测试环境。","Happy Chinese New Year!":"新年快乐！"},Ht={header:"本網站的 Cookies",text1:"在 RMG，我們使用 Cookies 以確保本網站及服務可以正常運作。這些 Cookies 是必需的，因此已預設啟用。",text2:"我們亦會以 Cookies 的方式：",item1:"分析閣下的使用模式，用來改進本網站",text3:"這些 Cookies 是可選的。如果閣下想容許所有可選 Cookies，請選擇「接受所有 Cookies」。如果閣下想禁用 Cookies，請選擇「拒絕」。",accept:"接受所有 Cookies",reject:"拒絕"},Vt="關於",Wt="外觀",Jt="貢獻者",zt="深色",Yt="捐贈者",Ft="Gitee (碼雲)",qt="淺色",Xt="更多",Qt="私隱",Zt="運行中",Kt="儲存",eo="切換",to="跟隨系統",oo="分頁",no="使用指南",ao={CookiesModal:Ht,About:Vt,"Allow cookies to help improve our website":"容許以 Cookies 幫助改進本網站",Appearance:Wt,"Back to production environment":"返回生產環境","Close all tabs":"關閉所有分頁","Close app":"關閉應用程式","Close current tab":"關閉當前分頁","Close tab":"關閉分頁","Contribution Wiki":"貢獻者指南",Contributors:Jt,"Current session has been terminated. Please close this window.":"當前工作階段已被終止，請關閉該視窗。",Dark:zt,"Developer team":"開發人員團隊",Donators:Yt,"Download desktop app":"下載桌面應用程式",Gitee:Ft,Light:qt,"Main languages":"主要語言",More:Xt,"More mirrors":"更多鏡像","New tab":"新分頁","Notes: Contributors are sorted by number of commits and commit time.":"註：貢獻者列表按提交次數及時間排序。","Other languages":"其他語言",Privacy:Qt,"Privacy settings":"私隱設定","Rail Map Toolkit is opened in another window":"路綫圖工具組已於另一視窗中開啟","Refreshing is required for changes to take effect.":"重新整理頁面後變更才會生效","Resource administrators":"資源管理員","Resource contributors":"資源貢獻者","Restart RMT in this window":"於該視窗重新啟動工具組",Running:Zt,Save:Kt,"Select an app to start your own rail map design!":"選擇一個應用程式以開始你的路綫圖設計！",Switch:eo,"Switch to":"切換至",System:to,Tab:oo,"Terms and conditions":"條款及細則",Tutorial:no,"Unable to load contributors":"無法載入貢獻者列表","Visit GitHub":"造訪 GitHub","Welcome to Rail Map Toolkit":"歡迎使用路綫圖工具組","You cannot open multiple Rail Map Toolkit at the same time. Please close this window.":"你不能同時開啟多個路綫圖工具組，請關閉當前視窗。","You're currently viewing a testing environment.":"你正在檢視測試環境。","Happy Chinese New Year!":"新年快樂！"},so="貢献者",io="プライバシー",ro="タブ",co={Contributors:so,"Main languages":"主要言語",Privacy:io,"Privacy settings":"プライバシー設定",Tab:ro,"Welcome to Rail Map Toolkit":"路線図ツールキットへようこそ","Happy Chinese New Year!":"旧正月おめでとう！"},lo={header:"이 웹 사이트의 쿠키",text1:"RMG에서는 쿠키를 사용하여 웹 사이트 및 서비스가 제대로 작동하는지 확인합니다.이러한 쿠키는 필수이므로 기본적으로 시작됩니다.",text2:"저희도 쿠키 방식으로：",item1:"당신의 사용 패턴을 분석하여, 본 사이트를 개선합니다",text3:"이 쿠키들은 선택 사항입니다.모든 선택 가능한 쿠키를 허용하려면 '모든 쿠키 허용'을 선택하십시오.쿠키를 사용하지 않으려면 '거부'를 선택하십시오.",accept:"모든 쿠키 허용",reject:"거부"},po="관한",uo="화면 스타일",mo="기여자",go="다크 모드",bo="라이트 모드",ho="저장",To="시스템 모드",Ro={CookiesModal:lo,About:po,"Allow cookies to help improve our website":"쿠키를 사용하여 이 웹 사이트를 개선할 수 있도록 허용",Appearance:uo,"Contribution Wiki":"기여자 안내",Contributors:mo,"Core contributors":"핵심 기여자",Dark:go,Light:bo,"Privacy settings":"개인 정보 보호 설정","Refreshing is required for changes to take effect.":"페이지를 새로 고친 후에만 변경 가능","Resource administrators":"자원 관리자","Resource contributors":"자원 기여자",Save:ho,"Select an app to start your own rail map design!":"응용 프로그램을 선택하여 노선도 설계를 시작하십시오.","Switch to":"곳으로 전환",System:To,"Terms and conditions":"조항과 세칙","Visit GitHub":"GitHub 방문하기","Welcome to Rail Map Toolkit":"노선도 툴킷에 오신 것을 환영합니다","Happy Chinese New Year!":"새해 복 많이 받으세요!"},Co=new p.I18nBuilder().use(U).withAppName("Rail Map Toolkit").withLng(p.getLanguage()).withDefaultResource(vt).withResource("en",At).withResource("zh-Hans",Bt).withResource("zh-Hant",ao).withResource("ja",co).withResource("ko",Ro).build(),T={rmg:{name:"Rail Map Generator",url:"/rmg/",allowedEnvs:[a.DEV,a.UAT,a.PRD],allowMultiInstances:!0},rmp:{name:"Rail Map Painter",url:"/rmp/",allowedEnvs:[a.DEV,a.UAT,a.PRD]},"rmg-palette":{name:"Palette",url:"/rmg-palette/",allowedEnvs:[a.DEV,a.UAT,a.PRD],showContributors:!0,legacyContributors:"legacy-contributor-list.txt"},"rmg-palette-upload":{name:"Palette - Upload",url:"/rmg-palette/#/new",allowedEnvs:[a.DEV,a.UAT,a.PRD]},"rmg-components":{name:"Components",url:"/rmg-components/",allowedEnvs:[a.DEV,a.UAT]},"rmg-templates":{name:"RMG Templates",url:"/rmg-templates/",allowedEnvs:[a.DEV,a.UAT,a.PRD],showContributors:!0,legacyContributors:"legacy-contributor-list.txt"},"rmg-templates-upload":{name:"RMG Templates - Upload",url:"/rmg-templates/#/new",allowedEnvs:[a.DEV,a.UAT,a.PRD]},"rmp-gallery":{name:"RMP Gallery",url:"/rmp-gallery/",allowedEnvs:[a.DEV,a.UAT,a.PRD],showContributors:!0,showDonators:!0},"seed-project":{name:"Seed Project",url:"/seed-project/",allowedEnvs:[a.DEV,a.UAT]},"rmg-translate":{name:"Translate",url:"/rmg-translate/",allowedEnvs:[a.DEV,a.UAT]},"runtime-demo":{name:"Runtime Demo",url:"/runtime-demo/",allowedEnvs:[a.DEV,a.UAT]}},w=e=>Object.entries(T).filter(([t,o])=>o.allowedEnvs.includes(e)).map(([t])=>t);var R=(e=>(e.OPENED_TABS="rmg-home__openedTabs",e.ACTIVE_TAB="rmg-home__activeTab",e))(R||{});const Vo=["GitHub","GitLab","Tauri"],Wo={GitHub:"https://railmapgen.github.io",GitLab:"https://railmapgen.gitlab.io",Gitee:"https://railmapgen.gitee.io",Tauri:"https://mirror.ghproxy.com/https://github.com/railmapgen/railmapgen.github.io/releases/download"};var M=(e=>(e.APP_LOAD="APP_LOAD",e.OPEN_APP="OPEN_APP",e.CLOSE_APP="CLOSE_APP",e.TOGGLE_NAV_MENU="TOGGLE_NAV_MENU",e.CHANGE_LANGUAGE="CHANGE_LANGUAGE",e.SWITCH_MIRROR="SWITCH_MIRROR",e.DOWNLOAD_APP="DOWNLOAD_APP",e))(M||{});const wo="rmg-home:frame-",fo={isShowMenu:!0,openedTabs:[],activeTab:void 0},S=j({name:"app",initialState:fo,reducers:{setIsPrimary:(e,t)=>{e.isPrimary=t.payload},terminateSession:e=>{e.isTerminated=!0},toggleMenu:e=>{e.isShowMenu=!e.isShowMenu},setOpenedTabs:(e,t)=>{e.openedTabs=t.payload},updateTabUrl:(e,t)=>{const{id:o,url:s}=t.payload;e.openedTabs=e.openedTabs.map(i=>i.id===o?{...i,url:s}:i)},setActiveTab:(e,t)=>{e.activeTab=t.payload},openApp:(e,t)=>{const{appId:o,url:s}=t.payload,i=e.openedTabs.find(({id:n})=>n===e.activeTab),r=e.openedTabs.find(({app:n})=>n===o);if((i==null?void 0:i.app)!==o)if(r)e.activeTab=r.id;else{const n=crypto.randomUUID();e.openedTabs.push({id:n,app:o,url:s!=null?s:T[o].url}),e.activeTab=n}},openAppInNew:(e,t)=>{const o=crypto.randomUUID();e.openedTabs.push({id:o,app:t.payload}),e.activeTab=o},closeTab:(e,t)=>{var i;const o=t.payload,s=e.openedTabs.slice().sort((r,n)=>{const c=Object.keys(T);return c.indexOf(r.app)-c.indexOf(n.app)});if(e.openedTabs=e.openedTabs.filter(r=>r.id!==o),e.activeTab===o){const r=s.findIndex(n=>n.id===o);e.activeTab=(i=s.filter(n=>n.id!==o)[Math.max(0,r-1)])==null?void 0:i.id}},closeApp:(e,t)=>{var n,c;const o=t.payload;if(!e.openedTabs.some(l=>l.app===o))return;const s=Object.keys(T).filter(l=>e.openedTabs.some(b=>b.app===l)),i=(n=e.openedTabs.find(l=>l.id===e.activeTab))==null?void 0:n.app,r=e.openedTabs.filter(l=>l.app!==o);if(e.openedTabs=r,i===o){const l=s.findIndex(b=>b===o);e.activeTab=(c=r.find(b=>b.app===s[Math.max(0,l-1)]))==null?void 0:c.id}}}}),{setIsPrimary:vo,terminateSession:ko,toggleMenu:Jo,setOpenedTabs:Ao,updateTabUrl:Po,setActiveTab:k,openApp:f,openAppInNew:zo,closeTab:Yo,closeApp:yo}=S.actions,$o=S.reducer,Mo=B({app:$o}),E=H(),So=(e={})=>V({reducer:Mo,middleware:t=>t().prepend(E.middleware),preloadedState:e}),d=So(),Fo=()=>W(),qo=J,A=E.startListening;window.rmgStore=d;const Eo=e=>new Promise(t=>{setTimeout(t,e,"Timeout after ".concat(e/1e3," seconds"))}),Go="rmt-instance-checker",G="ping",D="pong",L="restart",u=new BroadcastChannel(Go),N=e=>{e.data===G&&(console.log("[rmt] Received ping from another RMT instance."),u.postMessage(D))};u.addEventListener("message",N);u.addEventListener("message",e=>{e.data===L&&(console.log("[rmt] Received restart from another RMT instance. Closing current session..."),u.close(),d.dispatch(ko()),d.dispatch(y()))});const Xo=()=>{u.postMessage(L)},Do=async()=>{let e=!0;u.addEventListener("message",o=>{o.data===D&&(console.warn("[rmt] Received pong from another RMT instance. This instance is not primary."),e=!1,u.removeEventListener("message",N))}),u.postMessage(G);let t=5;for(;t--;)if(await Eo(500),!e)return!1;return console.log("[rmt] This instance is primary."),!0},Lo=e=>{try{const t=window.localStorage.getItem(R.OPENED_TABS);if(t){const o=JSON.parse(t);if(Array.isArray(o)){const s=o.filter(i=>i.app in T);e.dispatch(Ao(s))}else console.warn("initOpenedTabs():: Cannot parse invalid opened tabs state from local storage")}}catch(t){console.warn("initOpenedTabs():: cannot parse opened apps state from local storage",t)}},No=e=>{var s;const t=window.localStorage.getItem(R.ACTIVE_TAB),o=e.getState().app.openedTabs;t&&o.some(({id:i})=>i===t)?e.dispatch(k(t)):e.dispatch(k((s=o[0])==null?void 0:s.id))},Oo=e=>{const o=new URLSearchParams(window.location.search).get("app");console.log("openSearchedApp():: searchParams app=".concat(o)),w(p.getEnv()).includes(o)?e.dispatch(f({appId:o})):console.warn("openSearchedApp():: app ".concat(o," not found"))};function xo(e){Lo(e),No(e),A({predicate:(t,o,s)=>JSON.stringify(o.app.openedTabs)!==JSON.stringify(s.app.openedTabs),effect:(t,o)=>{window.localStorage.setItem(R.OPENED_TABS,JSON.stringify(o.getState().app.openedTabs))}}),A({predicate:(t,o,s)=>o.app.activeTab!==s.app.activeTab,effect:(t,o)=>{const s=o.getState().app.activeTab;s!==void 0&&window.localStorage.setItem(R.ACTIVE_TAB,s)}}),Oo(e),Do().then(t=>{e.dispatch(vo(t)),t||e.dispatch(y())})}let P;const Io=$.lazy(()=>X(()=>import("./app-root-OBAQNEkk.js"),__vite__mapDeps([0,1,2,3,4,5]))),_o=()=>{P=O(document.getElementById("root")),P.render(g.jsx($.StrictMode,{children:g.jsx(z,{store:d,children:g.jsx(Y,{i18n:Co,children:g.jsx(x,{children:g.jsx(I,{suspenseFallback:g.jsx(_,{isIndeterminate:!0}),allowReset:!0,children:g.jsx(Io,{})})})})})}))};p.ready().then(()=>{xo(d),_o(),p.onAppOpen(e=>{const t=w(p.getEnv());typeof e=="object"?t.includes(e.appId)&&d.dispatch(f({appId:e.appId,url:e.url})):t.includes(e)&&d.dispatch(f({appId:e}))}),p.onAppClose(e=>{w(p.getEnv()).includes(e)&&d.dispatch(yo(e))}),p.onUrlUpdate((e,t)=>{if(t){const o=t.slice(wo.length);console.log("Received URL update for frame=".concat(o,", url=").concat(e)),d.dispatch(Po({id:o,url:e}))}}),p.event(M.APP_LOAD,{openedApps:d.getState().app.openedTabs.map(e=>e.app)})});export{M as E,wo as F,Vo as M,Uo as __vite_legacy_guard,Fo as a,T as b,f as c,Yo as d,yo as e,Wo as f,w as g,zo as o,Xo as r,k as s,Jo as t,qo as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/app-root-OBAQNEkk.js","assets/chakra--OYt8vue.js","assets/react-ChmrgLrp.js","assets/rmg-theme-provider-8iDCBseT.js","assets/rmg-theme-provider-YURqyO0b.css","assets/rmg-fields-dFwrnlA2.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
