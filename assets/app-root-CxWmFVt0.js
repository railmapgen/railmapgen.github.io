import{j as e,S as _,G as T,I as he,T as R,e as M,n as _e,o as W,C as K,F as ae,p as at,B as w,q as nt,u as ot,s as Y,t as N,v as it,P as ce,w as Ne,x as rt,y as ze,z as pe,D as lt,A as De,E as ct,H as dt,b as D,c as B,d as te,g as X,J as Be,K as be,O as we,Q as ut,U as ht,V as pt,l as ge,W as F,X as Z,Y as xe,Z as gt,_ as me,$ as Ve,a0 as xt,a1 as se,a2 as mt,a3 as jt,a4 as ft,r as S,a5 as St,a6 as bt,a7 as wt,N as Ct,a8 as yt,a9 as vt,aa as Me,ab as Mt,ac as Ue,ad as kt,ae as At,af as Lt,ag as Tt,ah as Rt,ai as Pt,k as Ot,aj as Et,M as It,ak as _t,al as Nt,am as zt,an as Dt,i as Bt,ao as Vt,m as Ut}from"./mantine-VgnFah2G.js";import{k as C,r as f,o as Fe,R as G,B as Ft}from"./react-UC3gAxe5.js";import{u as E,o as je,F as Gt,a as L,b as Wt,S as q,l as I,s as Ge,f as J,g as fe,c as We,n as He,d as $e,e as Ht,h as P,A as O,i as $t,j as U,k as Ce,m as Jt,p as Kt,E as z,q as qt,t as ie,r as Yt,v as Qt,w as Zt,x as Je,y as Xt,z as es,B as ts,C as ss,D as as,G as ns,H as os}from"./main-B8wPhjmN.js";import{a as ee,b as Ke,S as is,O as rs,L as de}from"./asset-enablements-CJGzI7A8.js";import"./index-C_hgTfa4.js";const ls="_burger_1y0se_1",cs={burger:ls},ds="_workspace_1nep4_1",us="_show_1nep4_13",hs="_welcome_1nep4_23",ps="_icons_1nep4_38",ne={workspace:ds,"app-container":"_app-container_1nep4_8",show:us,welcome:hs,icons:ps},gs="/assets/rmp-logo512-eHekupnf.png";function xs(){const{t}=C(),s=E();return e.jsxs(_,{className:ne.welcome,children:[e.jsxs(T,{className:ne.icons,grow:!0,children:[e.jsx(he,{src:"/logo512.png",title:t("Open")+" "+t("Rail Map Generator"),onClick:()=>s(je({appId:"rmg"}))}),e.jsx(he,{src:gs,title:t("Open")+" "+t("Rail Map Painter"),onClick:()=>s(je({appId:"rmp"}))})]}),e.jsx(R,{children:t("Welcome to Rail Map Toolkit")}),e.jsx(M,{children:t("Select an app to start your own rail map design!")})]})}function ms(t){const{tab:s,isActive:n}=t,a=f.useMemo(()=>s.url??"/"+s.app+"/",[s.app]);return e.jsx("div",{className:_e(ne["app-container"],n&&ne.show),children:e.jsx("iframe",{id:Gt+s.id,src:a,loading:"lazy",title:s.app,"data-persisted-url":s.url,"data-testid":"app-container-iframe"})})}function js({alwaysShowWelcome:t}){const{openedTabs:s,activeTab:n}=L(o=>o.app),[,a]=Fe();return f.useEffect(()=>{var o;if(n){const i=(o=s.find(c=>c.id===n))==null?void 0:o.app;a(i?{app:i}:{})}else a({})},[n]),e.jsx("div",{className:ne.workspace,children:t||s.length===0?e.jsx(xs,{}):s.map(o=>e.jsx(ms,{tab:o,isActive:n===o.id},o.id))})}const fs="_root_mj6g1_5",Ss="_wrapper_mj6g1_31",bs="_alert_mj6g1_42",ws="_header_mj6g1_49",Cs="_body_mj6g1_55",ys="_aside_mj6g1_62",vs="_main_mj6g1_75",H={root:fs,"show-menu":"_show-menu_mj6g1_15",wrapper:Ss,alert:bs,header:ws,body:Cs,aside:ys,main:vs},Ms="_card_15zs0_1",ke={card:Ms},Ae=(t,s,n)=>{const a=new Blob([n],{type:s});ks(t,a)},ks=(t,s)=>{const n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n)},As=()=>{const{t}=C(),{token:s,refreshToken:n,currentSaveId:a}=L(j=>j.account),{resolveConflictModal:{isOpen:o,lastChangedAtTimeStamp:i,lastUpdatedAtTimeStamp:c,cloudData:g}}=L(j=>j.rmpSave),d=E(),[h,u]=G.useState(!1),p=()=>d(Ht()),r=()=>{We(q.RMP,g),He(),d($e(c)),p()},m=()=>{Ae(`RMP_${c}.json`,"application/json",g)},y=async()=>{if(!a||!s||!n)return;u(!0);const j=await Wt(a,s,n,q.RMP);if(!j){d(I()),u(!1);return}if(j.status===409){d(Ge()),u(!1);return}j.status===200&&(d(J()),u(!1),p())},b=async()=>{const{data:j}=await fe(q.RMP);Ae(`RMP_${i}.json`,"application/json",j)};return e.jsxs(W,{opened:o,onClose:()=>{},size:"lg",title:t("Oops! It seems there's a conflict"),withCloseButton:!1,closeOnClickOutside:!1,closeOnEscape:!1,centered:!0,children:[e.jsx(M,{children:t("The local save is newer than the cloud one. Which one would you like to keep?")}),e.jsxs(T,{my:"xs",children:[e.jsx(K,{withBorder:!0,className:ke.card,children:e.jsxs(_,{children:[e.jsxs(ae,{children:[e.jsx(at,{}),e.jsx(M,{span:!0,children:t("Local save")})]}),e.jsxs(M,{span:!0,children:[t("Update at:")," ",new Date(i).toLocaleString()]}),e.jsx(w,{color:"red",loading:h,onClick:()=>y(),children:t("Replace cloud with local")}),e.jsx(w,{onClick:()=>b(),children:t("Download Local save")})]})}),e.jsx(K,{withBorder:!0,className:ke.card,children:e.jsxs(_,{children:[e.jsxs(ae,{children:[e.jsx(nt,{}),e.jsx(M,{span:!0,children:t("Cloud save")})]}),e.jsxs(M,{span:!0,children:[t("Update at:")," ",new Date(c).toLocaleString()]}),e.jsx(w,{color:"red",onClick:()=>r(),children:t("Replace local with cloud")}),e.jsx(w,{onClick:()=>m(),children:t("Download Cloud save")})]})})]})]})},Ls="_body_yczk0_1",Ts={body:Ls};function qe(t){const{initialValue:s,onSave:n,fontWeight:a="bold",iconVariant:o,textInputWidth:i,placeholder:c="...",emptyPlaceholder:g="(empty)"}=t,d=ot(),[h,u]=f.useState(!1),[p,r]=f.useState(s),m=f.useRef(null),[y,b]=f.useState("");f.useEffect(()=>{h&&m.current&&(m.current.focus(),m.current.select())},[h]);const j=()=>{b(p),u(!0)},x=()=>{p!==y&&n(p),u(!1)},k=()=>{r(y),u(!1)},V=A=>{r(A.currentTarget.value)},l=A=>{A.key==="Enter"?x():A.key==="Escape"&&k()},v=()=>{x()};return h?e.jsx(T,{gap:"xs",wrap:"nowrap",style:{width:i},children:e.jsx(Y,{ref:m,value:p,onChange:V,onKeyDown:l,onBlur:v,placeholder:c,styles:{input:{fontWeight:a}}})}):e.jsxs(T,{gap:"xs",wrap:"nowrap",flex:"1",p:"0",onClick:j,style:{cursor:"pointer",padding:`calc(${d.spacing.xs} / 2) ${d.spacing.xs}`,minHeight:"36px",display:"flex",alignItems:"center",borderRadius:d.radius.sm,"&:hover":{backgroundColor:d.colors.gray[0]}},children:[e.jsx(M,{fw:a,style:{flexGrow:1,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p||g}),e.jsx(N,{variant:o,color:o=="subtle"?"gray":void 0,onClick:A=>{A.stopPropagation(),j()},title:"Edit",children:e.jsx(it,{size:16})})]})}function Le({meets:t,label:s}){return e.jsxs(M,{c:t?"teal":"red",style:{display:"flex",alignItems:"center"},mt:7,size:"sm",children:[t?e.jsx(ze,{size:14}):e.jsx(pe,{size:14}),e.jsx(lt,{ml:10,children:s})]})}const Se=[{re:/[0-9]/,label:"Includes number"},{re:/[a-zA-Z]/,label:"Includes letter"}];function Rs(t){let s=t.length>=8?0:1;return Se.forEach(n=>{n.re.test(t)||(s+=1)}),Math.max(100-100/(Se.length+1)*s,10)}function ye({value:t,onChange:s}){const{t:n}=C(),[a,o]=f.useState(!1),i=Se.map((d,h)=>e.jsx(Le,{label:d.label,meets:d.re.test(t)},h)),c=Rs(t),g=c===100?"teal":c>50?"yellow":"red";return e.jsxs(ce,{opened:a,position:"bottom",width:"target",transitionProps:{transition:"pop"},children:[e.jsx(ce.Target,{children:e.jsx("div",{onFocusCapture:()=>o(!0),onBlurCapture:()=>o(!1),children:e.jsx(Ne,{label:n("Password"),value:t,onChange:d=>s(d.currentTarget.value)})})}),e.jsxs(ce.Dropdown,{children:[e.jsx(rt,{color:g,value:c,size:5,mb:"xs"}),e.jsx(Le,{label:n("Includes at least 8 characters"),meets:t.length>=8}),i]})]})}const Ps=()=>{const{t}=C(),s=E(),{isLoggedIn:n,id:a,email:o,name:i,token:c,refreshToken:g}=L(j=>j.account),[d,h]=G.useState(void 0),[u,p]=G.useState(""),r=async()=>{n&&(await P(O.AUTH_LOGOUT,{method:"POST",body:JSON.stringify({refreshToken:g})}),s(I()))},m=j=>s(U({title:t("Unable to update account info"),message:j,type:"error",duration:9e3})),y=async j=>{if(n)try{const x=await P(O.USER+"/"+a,{method:"PATCH",body:JSON.stringify({name:j})},c);if(x.status===401){m(t("Login status expired")),s(I());return}if(x.status!==200){m(await x.text());return}s($t(j))}catch(x){m(x.message)}},b=async()=>{if(n)try{const j=await P(O.USER+"/"+a,{method:"PATCH",body:JSON.stringify({password:u})},c);if(j.status===401){m(t("Login status expired")),s(I());return}if(j.status!==200){m(await j.text());return}s(I()),h(void 0)}catch(j){m(j.message)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{py:"xs",align:"center",wrap:"wrap",children:[e.jsx(De,{size:"lg",name:i,color:"initials"}),e.jsxs(_,{justify:"center",ml:"md",gap:"0",flex:"1",children:[e.jsxs(T,{children:[e.jsx(qe,{initialValue:i??"",onSave:j=>y(j),iconVariant:"subtle",textInputWidth:"181px"}),e.jsx(N,{variant:"subtle",color:"gray",size:"sm",onClick:()=>h("password"),"aria-label":t("Change password"),title:t("Change password"),children:e.jsx(ct,{})}),e.jsx(N,{variant:"subtle",color:"gray",size:"sm",onClick:r,"aria-label":t("Log out"),title:t("Log out"),children:e.jsx(dt,{})})]}),e.jsx(M,{span:!0,size:"sm",children:o})]})]}),e.jsxs(W,{opened:!!d,onClose:()=>h(void 0),title:t("Update account info"),closeOnEscape:!1,children:[e.jsx(ye,{value:u,onChange:j=>p(j)}),e.jsx(T,{mt:"xs",children:e.jsx(w,{ml:"auto",onClick:b,children:t("Change")})})]})]})},Os=/^\S+@\S+\.\S+$/,re=t=>!!t.match(Os),Ye=t=>t.length>=8&&!!t.match(/\d/)&&!!t.match(/[a-zA-Z]/),Te=60;function Qe({value:t,onChange:s,onVerify:n,otpSent:a,allowResendOtp:o,...i}){const{t:c}=C(),[g,d]=f.useState(!1),[h,u]=f.useState(Te),p=!!t&&re(t),r=()=>{o&&(d(!0),u(Te)),n()};return f.useEffect(()=>{let m;return g&&h>0?m=window.setTimeout(()=>{u(h-1)},1e3):h===0&&d(!1),()=>clearTimeout(m)},[g,h]),e.jsx(Y,{type:"email",label:c("Email"),value:t,onChange:({currentTarget:{value:m}})=>s(m),error:t&&!re(t),rightSection:a?e.jsx(w,{variant:"transparent",size:"xs",leftSection:e.jsx(ze,{}),disabled:!0,children:c("Verification code sent")}):e.jsx(w,{variant:"subtle",size:"xs",onClick:r,disabled:!p||g,children:g?`${h}s`:c("Send verification code")}),rightSectionWidth:"fit-content",...i})}const Es=t=>{const{t:s}=C(),n=E(),[a,o]=f.useState(""),[i,c]=f.useState(""),[g,d]=f.useState(""),[h,u]=f.useState(""),[p,r]=f.useState(!1),y=!!a&&re(a)&&!!g&&!!i&&Ye(i),b=k=>n(U({title:s("Unable to reset your password"),message:k,type:"error",duration:9e3})),j=async()=>{try{const k=await P(O.AUTH_SEND_RESET_PASSWORD_EMAIL,{method:"POST",body:JSON.stringify({email:a})});k.status===204?u(a):k.status>400&&u("error")}catch{u("error")}},x=async()=>{r(!0);const k=new URLSearchParams({token:g}),V=`${O.AUTH_RESET_PASSWORD}?${k.toString()}`;try{const l=await P(V,{method:"POST",body:JSON.stringify({password:i})});if(l.status!==204){b(await l.text());return}const{error:v,username:A}=(await n(Ce({email:a,password:i}))).payload;v?b(v):n(U({title:s("Welcome ")+A,message:s("Your password has been reset successfully."),type:"success",duration:5e3}))}catch(l){b(l.message)}finally{r(!1)}};return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:3,size:"h5",children:s("Forgot password")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[h==="error"&&e.jsx(X,{color:"red",icon:e.jsx(Be,{}),title:s("Check your email again!")}),h&&h!=="error"&&e.jsx(X,{color:"blue",icon:e.jsx(be,{}),title:s("Email with reset link is sent to")+" "+h}),e.jsx(Qe,{value:a,onChange:o,onVerify:j,otpSent:h}),e.jsx(Y,{label:s("Reset password token"),value:g,onChange:({currentTarget:{value:k}})=>d(k)}),e.jsx(ye,{value:i,onChange:c}),e.jsx(w,{onClick:x,loading:p,disabled:!y||p,children:s("Reset password")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("login"),disabled:p,children:s("Back to log in")})]})]})},Is=/^\S+@\S+\.\S+$/,Re=t=>!!t.match(Is),_s=t=>{const{t:s}=C(),n=E(),[a,o]=f.useState(""),[i,c]=f.useState(""),[g,d]=f.useState(!1),h=!!a&&Re(a)&&!!i,u=async()=>{d(!0);try{const{error:p,username:r}=(await n(Ce({email:a,password:i}))).payload;n(p?U({title:s("Unable to login"),message:p,type:"error",duration:9e3}):U({title:s("Welcome ")+r,message:s("Login success"),type:"success",duration:5e3}))}finally{d(!1)}};return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:3,size:"h5",children:s("Log in")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[e.jsx(Y,{type:"email",label:s("Email"),value:a,onChange:({currentTarget:{value:p}})=>o(p),error:a&&!Re(a)}),e.jsx(Ne,{label:s("Password"),value:i,onChange:({currentTarget:{value:p}})=>c(p)}),e.jsx(we,{component:"button",ml:"auto",onClick:()=>t.setLoginState("forgot-password"),children:s("Forgot password")+"?"}),e.jsx(w,{onClick:u,loading:g,disabled:!h||g,children:s("Log in")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("register"),disabled:g,children:s("Create an account")})]})]})},Ns=t=>{const{t:s}=C(),n=E(),[a,o]=f.useState(""),[i,c]=f.useState(""),[g,d]=f.useState(""),[h,u]=f.useState(""),[p,r]=f.useState(""),[m,y]=f.useState(!1),b=!!i&&re(i),j=!!a&&b&&!!h&&!!g&&Ye(g),x=l=>n(U({title:s("Unable to create your account"),message:l,type:"error",duration:9e3})),k=async()=>{try{const l=await P(O.AUTH_SEND_VERIFICATION_EMAIL,{method:"POST",body:JSON.stringify({email:i})});l.status===204?r(i):l.status>400&&r("error")}catch{r("error")}},V=async()=>{y(!0);try{const l=await P(O.AUTH_REGISTER,{method:"POST",body:JSON.stringify({name:a,email:i,password:g,emailVerificationToken:Number(h)})});if(l.status!==201){x(await l.text());return}const{error:v,username:A}=(await n(Ce({email:i,password:g}))).payload;v?x(v):n(U({title:s("Welcome ")+A,message:s("Your account is created successfully."),type:"success",duration:5e3}))}catch(l){x(l.message)}finally{y(!1)}};return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:3,size:"h5",children:s("Create an account")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[p==="error"&&e.jsx(X,{color:"red",icon:e.jsx(Be,{}),title:s("The email is not valid!")}),p&&p!=="error"&&e.jsx(X,{color:"blue",icon:e.jsx(be,{}),title:s("Verification email is sent to")+" "+p}),e.jsx(Y,{label:s("Name"),description:s("You may always change it later."),value:a,onChange:({currentTarget:{value:l}})=>o(l)}),e.jsx(Qe,{description:s("We'll never share your email."),value:i,onChange:c,onVerify:k,otpSent:p,allowResendOtp:!0}),e.jsx(Y,{label:s("Verification code"),value:h,onChange:({currentTarget:{value:l}})=>u(l)}),e.jsx(ye,{value:g,onChange:d}),e.jsx(w,{onClick:V,loading:m,disabled:!j||m,children:s("Sign up")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("login"),disabled:m,children:s("Back to log in")})]})]})},zs=1,Ds=10,Bs=()=>{const{t}=C(),s=E(),{isLoggedIn:n,token:a,activeSubscriptions:o,currentSaveId:i,saves:c}=L(l=>l.account),{lastChangedAtTimeStamp:g}=L(l=>l.rmpSave),d=n&&c&&(o.RMP_CLOUD?c.length<Ds:c.length<zs),h=Math.min(...(c??[]).map(l=>l.id)),u=l=>!o.RMP_CLOUD&&l!==h,[p,r]=G.useState(void 0),[m,y]=G.useState(void 0),b=l=>s(U({title:t("Unable to sync your save"),message:l,type:"error",duration:9e3})),j=async()=>{const l=await fe(q.RMP);if(!n||!l||!a){b(t("Failed to get the RMP save!"));return}const{data:v,hash:A}=l,oe=Vs();try{const $=await P(O.SAVES,{method:"POST",body:JSON.stringify({index:oe,data:v,hash:A})},a);if($.status===401){b(t("Login status expired")),s(I());return}if($.status!==200){b(await $.text());return}s(J())}catch($){b($.message)}},x=async l=>{if(!(!n||!a)){if(l===i){if(r(i),!i||u(i)){b(t("Can not sync this save!")),r(void 0);return}const v=await s(J());if(v.meta.requestStatus!=="fulfilled"){b(t("Login status expired")),r(void 0);return}const oe=v.payload.saves.filter(st=>st.id===i).at(0);if(!oe){b(t("Current save id is not in saveList!")),r(void 0);return}const $=new Date(oe.lastUpdateAt);if(new Date(g)<$){ge.warn(`Save id: ${i} is newer in the cloud via local compare.`),s(Ge()),r(void 0);return}const ve=await fe(q.RMP);if(!ve){b(t("Failed to get the RMP save!")),r(void 0);return}const{data:et,hash:tt}=ve,le=await P(O.SAVES+"/"+i,{method:"PATCH",body:JSON.stringify({data:et,hash:tt})},a);if(le.status===401){b(t("Login status expired")),r(void 0),s(I());return}if(le.status!==200){b(await le.text()),r(void 0);return}r(void 0)}else{r(l);const v=await P(O.SAVES+"/"+l,{},a);if(v.status===401){b(t("Login status expired")),r(void 0),s(I());return}if(v.status!==200){b(await v.text()),r(void 0);return}ge.info(`Set ${q.RMP} with save id: ${l}`),We(q.RMP,await v.text()),s($e(new Date().valueOf())),He(),r(void 0)}s(J())}},k=async l=>{if(!n||!l||!a)return;y(l);const v=await P(O.SAVES+"/"+i,{method:"DELETE"},a);if(v.status===401){b(t("Login status expired")),y(void 0),s(I());return}if(v.status!==200){b(await v.text()),y(void 0);return}s(J()),y(void 0)},V=async(l,v)=>{if(!n||!l||!a)return;const A=await P(`${O.SAVES}/${l}/metadata`,{method:"PATCH",body:JSON.stringify({index:v})},a);if(A.status===401){b(t("Login status expired")),s(I());return}if(A.status!==200){b(await A.text());return}s(J())};return e.jsxs(D,{children:[e.jsxs(B,{align:"center",children:[e.jsx(R,{order:3,size:"h5",flex:"1",children:t("Synced saves")}),e.jsx(w,{variant:"subtle",size:"xs",ml:"xs",disabled:!d,onClick:j,children:t(d?"Create":"Subscribe to sync more")})]}),e.jsx(te,{direction:"column",gap:"xs",children:c==null?void 0:c.map(l=>e.jsxs(K,{withBorder:!0,shadow:"sm",children:[e.jsxs(T,{children:[e.jsx(qe,{initialValue:l.index,onSave:v=>V(l.id,v),textInputWidth:"207px"}),e.jsx(N,{disabled:u(l.id),loading:p===l.id,onClick:()=>x(l.id),title:l.id===i?t("Sync now"):t("Sync this slot"),children:l.id===i?e.jsx(ut,{}):e.jsx(ht,{})}),e.jsx(N,{color:"red",loading:m===l.id,onClick:()=>k(l.id),title:t("Delete"),children:e.jsx(pt,{})})]}),e.jsxs(T,{justify:"space-between",mt:"md",mb:"md",children:[e.jsxs(M,{children:[t("ID"),": ",l.id]}),e.jsxs(M,{children:[t("Status"),": ",l.id===i?t("Current save"):t("Cloud save")]})]}),e.jsxs(M,{children:[t("Last update at"),": ",new Date(l.lastUpdateAt).toLocaleString()]})]},l.id))})]})},Pe=["Tokyo","Paris","London","New York","Shanghai","Dubai","Sydney","Rio de Janeiro","Cairo","Moscow","Rome","Berlin","Madrid","Seoul","Singapore","Hong Kong","Beijing","Mexico City","Buenos Aires","Istanbul","Lagos","Jakarta","Osaka","Manila","Chongqing","Karachi","Dhaka","Lima","Bangkok","Lahore","Ho Chi Minh City","Shenzhen","Tianjin","Taipei","Bogota","Baghdad","Riyadh","Santiago","Guangzhou","Yangon","Johannesburg","Toronto","Montreal","Vancouver","Sao Paulo","Kuala Lumpur","Athens","Lisbon","Dublin","Amsterdam","Vienna","Prague","Budapest","Warsaw","Stockholm","Oslo","Helsinki","Copenhagen","Brussels","Geneva","Zurich","Barcelona","Milan","Florence","Venice","Munich","Hamburg","Frankfurt","Kyoto","Nairobi","Cape Town","Casablanca","Marrakesh","Accra","Addis Ababa","Alexandria","Ankara","Jerusalem","Tel Aviv","Beirut","Abu Dhabi","Doha","Kuwait City","Muscat","Amman","Baku","Tbilisi","Yerevan","Almaty","Tashkent","Kabul","Tehran","Damascus","Sana'a","Aden","Manama","Jeddah","Mecca","Medina","Salalah","Nicosia","Thessaloniki","Sofia","Bucharest","Belgrade","Zagreb","Sarajevo","Skopje","Tirana","Pristina","Podgorica","Ljubljana","Bratislava","Krakow","Gdansk","Wroclaw","Poznan","Vilnius","Riga","Tallinn","Reykjavik","Manchester","Birmingham","Glasgow","Edinburgh","Cardiff","Belfast","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Bordeaux","Lille","Cologne","Stuttgart","Dusseldorf","Dortmund","Essen","Leipzig","Dresden","Hanover","Nuremberg","Bremen","Rotterdam","The Hague","Utrecht","Eindhoven","Porto","Valencia","Seville","Zaragoza","Malaga","Murcia","Palma de Mallorca","Las Palmas de Gran Canaria","Antwerp","Ghent","Charleroi","Liège","Bern","Basel","Lausanne","Graz","Linz","Salzburg","Innsbruck","Naples","Turin","Palermo","Genoa","Bologna","Bari","Catania","Verona","Melbourne","Brisbane","Perth","Adelaide","Gold Coast","Canberra","Auckland","Wellington","Christchurch","Dunedin","Suva","Port Moresby","Noumea","Papeete","Honolulu","Quezon City","Davao City","Cebu City","Chiang Mai","Phuket","George Town","Ipoh","Johor Bahru","Surabaya","Bandung","Medan","Semarang","Santiago","Lima","Bogota","Caracas","Quito","La Paz","Sucre","Buenos Aires","Cordoba","Rosario","Mendoza","Valparaiso","Concepcion","Arequipa","Trujillo","Chiclayo","Piura","Medellin","Cali","Barranquilla","Cartagena","Maracaibo","Valencia","Barquisimeto","Ciudad Guayana","Guayaquil","Cuenca","Santo Domingo","Santa Cruz de la Sierra","Cochabamba","Guadalajara","Monterrey","Puebla","Tijuana","Leon","Juarez","Ecatepec","Zapopan","Nezahualcoyotl","Chihuahua","Naucalpan","Merida","Aguascalientes","San Luis Potosi","Hermosillo","Saltillo","Mexicali","Culiacan","Acapulco","Guadalupe","Cancun","Torreon","El Paso","Tucson","Phoenix","Los Angeles","San Diego","San Jose","San Francisco","Seattle","Portland","Las Vegas","Denver","Chicago","Houston","Dallas","San Antonio","Austin","Philadelphia","Washington D.C.","Boston","Miami","Atlanta","Orlando","Tampa","Detroit","Cleveland","Minneapolis","St. Louis","Kansas City","New Orleans","Charlotte","Nashville","Indianapolis","Columbus","Cincinnati","Pittsburgh","Milwaukee","Calgary","Edmonton","Winnipeg","Ottawa","Quebec City","Halifax","Chengdu","Wuhan","Hangzhou","Suzhou","Xian","Nanjing","Zhengzhou","Jinan","Qingdao","Hefei","Fuzhou","Xiamen","Ningbo","Wuxi","Kunming","Changsha","Nanchang","Shijiazhuang","Harbin","Changchun","Taiyuan","Urumqi","Lanzhou","Yinchuan","Xining","Guiyang","Lhasa","Hohhot","Nanning","Haikou","Sanya","Zhuhai","Foshan","Dongguan","Zhongshan","Shantou","Wenzhou","Jiaxing","Shaoxing","Taizhou","Jinhua","Quanzhou","Putian","Zhangzhou","Longyan","Sanming","Nanping","Yingtan","Shangrao","Jiujiang","Jingdezhen","Pingxiang","Xinyu","Yichun","Ganzhou","Qingyuan","Shaoguan","Heyuan","Meizhou","Shanwei","Yangjiang","Zhanjiang","Maoming","Zhaoqing","Yunfu","Laibin","Chongzuo","Hechi","Baise","Wuzhou","Fangchenggang","Qinzhou","Beihai","Guigang","Yulin","Cenxi","Dongxing","Anshan","Fushun","Jilin City","Qiqihar","Daqing","Mudanjiang","Jixi"],Vs=()=>{const t=Math.floor(Math.random()*Pe.length);return Pe[t]},Us=t=>{const{t:s}=C(),{opened:n,onClose:a,getSubscriptions:o}=t,{isLoggedIn:i,token:c}=L(r=>r.account),g=E(),[d,h]=G.useState(""),u=r=>g(U({title:s("Unable to redeem"),message:r,type:"error",duration:9e3})),p=async r=>{if(!i)return;const m=await P(O.SUBSCRIPTION_REDEEM,{method:"POST",body:JSON.stringify({cdkey:r.trim()})},c);if(m.status===401){u(s("Login status expired")),g(I());return}if(m.status!==202){const y=(await m.json()).message;u(s(y));return}await o(),a()};return e.jsxs(W,{opened:n,onClose:a,title:s("Redeem your subscription"),children:[e.jsx(M,{children:s("CDKey could be purchased in the following sites:")}),e.jsx(F,{withPadding:!0,mt:"xs",children:e.jsx(F.Item,{children:e.jsxs(we,{href:"https://afdian.com/item/9c8b220c614311efab2d52540025c377",target:"_blank",children:["爱发电 ",e.jsx(Z,{})]})})}),e.jsxs(T,{align:"flex-end",gap:"sm",mt:"xs",children:[e.jsx(Y,{label:"CDKey",placeholder:s("Enter your CDKey here"),value:d,onChange:({currentTarget:{value:r}})=>h(r),style:{minWidth:240}}),e.jsx(w,{onClick:()=>p(d),children:s("Redeem")})]})]})},Fs=()=>{const{t}=C(),{isLoggedIn:s,token:n}=L(u=>u.account),a=E(),[o,i]=G.useState([]),[c,g]=G.useState(!1),d=u=>a(U({title:t("Unable to retrieve your subscriptions"),message:u,type:"error",duration:9e3})),h=async()=>{if(!s)return;const u=await P(O.SUBSCRIPTION,{},n);if(u.status===401){d(t("Login status expired")),a(I());return}if(u.status!==200){d(await u.text());return}const p=(await u.json()).subscriptions;if(!p.map(m=>m.type).includes("RMP_CLOUD"))return;i([{type:"RMP",expires:p[0].expires}]);const r=structuredClone(Jt);for(const m of p){const y=m.type;y in r&&(r[y]=!0)}a(Kt(r))};return G.useEffect(()=>{h()},[]),e.jsxs(D,{children:[e.jsxs(B,{align:"center",children:[e.jsx(R,{order:3,size:"h5",children:t("All subscriptions")}),e.jsx(w,{variant:"subtle",size:"xs",ml:"auto",onClick:()=>g(!0),children:t("Redeem")})]}),e.jsxs(te,{direction:"column",gap:"xs",children:[o.length===0&&e.jsxs(K,{withBorder:!0,shadow:"sm",children:[e.jsx(K.Section,{p:"xs",children:e.jsx(R,{order:4,size:"h3",children:t("Rail Map Painter")})}),e.jsxs(_,{gap:"xs",children:[e.jsx(M,{children:t("With this subscription, the following features are unlocked:")}),e.jsxs(F,{withPadding:!0,children:[e.jsx(F.Item,{children:t("PRO features")}),e.jsx(F.Item,{children:t("Sync 9 more saves")}),e.jsx(F.Item,{children:t("Unlimited master nodes")}),e.jsx(F.Item,{children:t("Unlimited parallel lines")})]}),e.jsxs(M,{children:[t("Expires at:")," ",t("Not applicable")]})]})]}),o.map(u=>e.jsxs(K,{withBorder:!0,shadow:"sm",children:[e.jsx(K.Section,{p:"xs",children:e.jsx(R,{order:4,size:"h3",children:t(u.type==="RMP"?"Rail Map Painter":u.type)})}),e.jsxs(_,{gap:"xs",children:[e.jsxs(M,{children:[t("Expires at:")," ",new Date(u.expires).toLocaleString()]}),e.jsx(w,{color:"blue",onClick:()=>g(!0),children:t("Renew")})]})]},u.type))]}),e.jsx(Us,{opened:c,onClose:()=>g(!1),getSubscriptions:h})]})},Gs=()=>{const{t}=C(),{isLoggedIn:s}=L(o=>o.account),[n,a]=f.useState("login");return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:t("Account")})}),s?e.jsxs(te,{className:Ts.body,children:[e.jsx(Ps,{}),e.jsx(xe,{}),e.jsx(Fs,{}),e.jsx(Bs,{})]}):n==="login"?e.jsx(_s,{setLoginState:a}):n==="register"?e.jsx(Ns,{setLoginState:a}):e.jsx(Es,{setLoginState:a})]})},Ws="_button_1hzui_1",Hs="_label_1hzui_11",Q={button:Ws,label:Hs,"sub-label":"_sub-label_1hzui_17"};function Ze(){return gt("(min-width: 36em)")}function $s(t){var j;const{appId:s,onAboutOpen:n}=t,{t:a}=C(),o=E(),i=Ze(),{activeTab:c,openedTabs:g}=L(x=>x.app),d=ee[s],h=d.name.split(" - ").map(x=>a(x)).join(" - "),u=g.some(x=>x.app===s),p=!d.allowMultiInstances&&((j=g.find(x=>x.id===c))==null?void 0:j.app)===s,r=x=>{u||S.event(z.OPEN_APP,{appId:s,isOpenInNew:x}),o(x?qt(s):je({appId:s})),i||(o(ie()),S.toggleNavMenu(!1))},m=x=>{o(Yt(x)),i||(o(ie()),S.toggleNavMenu(!1))},y=x=>{o(Qt(x)),S.event(z.CLOSE_APP,{app:s})},b=x=>{o(Zt(x)),S.event(z.CLOSE_APP,{app:x})};return e.jsx(me,{component:"div",role:"button",variant:"filled",label:h,active:p,classNames:{root:Q.button,label:Q.label},leftSection:u?e.jsx(ft,{title:a("Running")}):void 0,rightSection:e.jsxs(e.Fragment,{children:[d.allowMultiInstances&&e.jsx(N,{"aria-label":a("New tab"),title:a("New tab"),variant:"subtle",color:p?"white":"gray",mr:4,onClick:x=>{x.stopPropagation(),r(!0)},children:e.jsx(xt,{})}),e.jsxs(se,{children:[e.jsx(se.Target,{children:e.jsx(N,{variant:"subtle",color:p?"white":"gray",onClick:x=>x.stopPropagation(),children:e.jsx(mt,{})})}),e.jsxs(se.Dropdown,{children:[u&&e.jsx(se.Item,{leftSection:e.jsx(pe,{}),onClick:x=>{x.stopPropagation(),b(s)},children:d.allowMultiInstances?a("Close all tabs"):a("Close app")}),e.jsx(se.Item,{leftSection:e.jsx(jt,{}),onClick:x=>{x.stopPropagation(),n()},children:a("About")})]})]})]}),disableRightSectionRotation:!0,opened:!0,onClick:()=>r(!1),children:d.allowMultiInstances&&g.filter(x=>x.app===s).map((x,k)=>{const V=x.id===c;return e.jsx(me,{component:"div",role:"button",variant:"filled",active:V,label:e.jsxs(e.Fragment,{children:[e.jsx(Ve,{color:"lightgray",c:"black",mr:"xs",circle:!0,display:"inline-flex",children:k+1}),x.title??a("Tab")+" "+(k+1).toString()+" - "+h]}),classNames:{root:Q.button,label:Q["sub-label"]},rightSection:e.jsx(N,{variant:"subtle",color:V?"white":"gray","aria-label":a("Close tab"),title:a("Close tab"),onClick:l=>{l.stopPropagation(),y(x.id)},children:e.jsx(pe,{})}),onClick:()=>m(x.id)},x.id)})})}const Js=async t=>{const s=`/${t}/info.json`;try{return(await(await fetch(s)).json()).version}catch(n){return ge.info(`Failed to get version of ${t}`,n),"unknown"}};function Ks(t){var g,d,h;const{appId:s,onClose:n}=t,{t:a}=C(),[o,i]=f.useState("Unknown"),c=s?(h=(d=(g=ee[s])==null?void 0:g.url)==null?void 0:d.split("/"))==null?void 0:h[1]:void 0;return f.useEffect(()=>{c?Js(c).then(u=>i(u)):i("Unknown")},[c]),e.jsx(W,{opened:!!s,onClose:n,size:"xl",title:e.jsxs(e.Fragment,{children:[a("About")+" "+(s?ee[s].name.split(" - ").map(u=>a(u)).join(" - "):""),e.jsx(Ve,{color:"gray",radius:"sm",ml:"xs",children:o})]}),children:e.jsx(w,{component:"a",href:"https://github.com/railmapgen/"+c,target:"_blank",children:a("Visit GitHub")})})}function Oe({assetType:t}){const{t:s}=C(),[n,a]=f.useState(),o=Ke(t,S.getEnv(),S.getInstance());return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:s(t==="devtool"?"Devtools":"Apps")})}),e.jsx(ae,{direction:"column",children:o.map(i=>e.jsx($s,{appId:i,onAboutOpen:()=>a(i)},i))}),e.jsx(Ks,{appId:n,onClose:()=>a(void 0)})]})}function qs(){const{t}=C(),s=Ke("link",S.getEnv(),S.getInstance()),n=a=>{S.event(z.OPEN_LINK,{id:a})};return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:t("Useful links")})}),e.jsx(ae,{direction:"column",children:s.map(a=>e.jsx(me,{variant:"filled",label:t(ee[a].name),classNames:{root:Q.button,label:Q.label},rightSection:e.jsx(Z,{}),href:ee[a].url,target:"_blank",onClick:()=>n(a)},a))})]})}const Ee={"textarea-label":"_textarea-label_kau51_1","textarea-input":"_textarea-input_kau51_5"};function Ys(t){var d;const{opened:s,onClose:n}=t,{t:a}=C(),[o,i]=f.useState(),c=Object.entries(localStorage),g=()=>{o&&(window.localStorage.removeItem(o),window.location.reload())};return e.jsxs(W,{opened:s,onClose:n,size:"xl",title:a("Local Storage"),children:[e.jsx(_,{gap:"xs",children:c.map(h=>e.jsx(St,{label:e.jsxs(T,{align:"center",gap:"xs",children:[h[0],e.jsx(N,{variant:"default",size:"xs",title:a("Remove this item"),"aria-label":a("Remove this item"),onClick:()=>i(h[0]),children:e.jsx(bt,{})})]}),value:h[1],readOnly:!0,rows:4,classNames:{label:Ee["textarea-label"],input:Ee["textarea-input"]}},h[0]))}),e.jsx(T,{pt:"xs",children:e.jsx(w,{ml:"auto",onClick:n,children:a("Go back")})}),o&&e.jsxs(W,{opened:!0,onClose:()=>i(void 0),centered:!0,title:a("Warning"),children:[e.jsxs(M,{children:[a("LocalStorageModal.text1"),e.jsx(wt,{children:o}),a("LocalStorageModal.text2"),e.jsx(M,{span:!0,fw:500,children:a(((d=ee[o.split("__")[0]])==null?void 0:d.name)??"Unknown app")}),a("LocalStorageModal.text3"),e.jsx("br",{}),a("LocalStorageModal.text4")]}),e.jsxs(T,{gap:"xs",mt:"xs",children:[e.jsx(w,{variant:"default",ml:"auto",onClick:()=>i(void 0),children:a("Back")}),e.jsx(w,{color:"red",onClick:g,children:a("Delete and reload")})]})]})]})}function Xe(t){const{t:s}=C(),n=[{group:s("Main languages"),items:is.map(a=>({value:a,label:de[a][a]}))},{group:s("Other languages"),items:rs.map(a=>({value:a,label:de[a][a]??de[a].en}))}];return e.jsx(Ct,{label:s("Language"),defaultValue:S.getLanguage(),onChange:({currentTarget:{value:a}})=>{const o=a;S.setLanguage(o),S.getI18nInstance().changeLanguage(o),S.event(z.CHANGE_LANGUAGE,{language:o})},data:n,...t})}function Qs(){const{t}=C(),{setColorScheme:s}=yt(),n=E(),{lastShowDevtools:a,refreshRequired:o}=L(r=>r.app),[i,c]=f.useState(S.isAllowAnalytics()),[g,d]=f.useState(!1),h=Je(a),u=r=>{c(r),S.allowAnalytics(r).refreshRequired&&n(ts())},p=[{value:"light",label:t("Light")},{value:"dark",label:t("Dark")},{value:"system",label:t("System")}];return e.jsxs(D,{children:[o&&e.jsx(X,{color:"blue",icon:e.jsx(be,{}),mb:"xs",children:t("Refreshing is required for changes to take effect.")}),e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:t("Settings")})}),e.jsxs(_,{gap:"xs",py:"xs",children:[e.jsx(Xe,{}),e.jsx(vt,{size:"sm",label:t("Appearance"),defaultValue:S.getColourMode(),onChange:r=>{s(r==="system"?"auto":r),S.setColourMode(r)},data:p}),e.jsx(Me,{label:t("Allow cookies to help improve our website"),labelPosition:"left",checked:i,onChange:({currentTarget:{checked:r}})=>u(r),disabled:o,styles:{labelWrapper:{flex:1}}}),e.jsx(Me,{label:t("Show dev tools for 1 day"),labelPosition:"left",checked:h,onChange:({currentTarget:{checked:r}})=>{r?(n(Xt()),S.event(z.SHOW_DEVTOOLS)):n(es())},styles:{labelWrapper:{flex:1}}}),h&&e.jsx(w,{variant:"default",leftSection:e.jsx(Mt,{}),onClick:()=>d(!0),children:t("Export Local Storage")})]}),h&&e.jsx(Ys,{opened:g,onClose:()=>d(!1)})]})}function Zs(){const{t}=C(),{remoteFonts:s}=L(n=>n.app);return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:t("Web fonts")})}),e.jsxs(_,{gap:"xs",children:[e.jsxs(M,{fs:"italic",children:[t("FontsSection.text1")," ",t("FontsSection.text2")," ",t("FontsSection.text3")," (",t("FontsSection.safari"),")"]}),Object.entries(s).map(([n,a])=>e.jsx(w,{variant:"default",rightSection:a.url?e.jsx(Z,{}):void 0,disabled:!a.url,onClick:()=>{window.open(a.url,"_blank"),S.event(z.DOWNLOAD_FONT,{family:n})},children:a.displayName?`${a.displayName} (${n})`:n},n))]})]})}const Xs="_bilibili_5ep1h_1",ea={bilibili:Xs};function ta(t){return Ue({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9a17.56 17.56 0 0 0 3.8.4c8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1a102.4 102.4 0 0 1-22.6 2.7c-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1a63 63 0 0 0 25.6-6c2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8a18.64 18.64 0 0 1 5-.5c8.1 0 26.4 3.1 56.6 24.1a208.21 208.21 0 0 1 112.2 0c30.2-21 48.5-24.1 56.6-24.1a18.64 18.64 0 0 1 5 .5c12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5a19.35 19.35 0 0 0 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"},child:[]}]})(t)}function sa(t){return Ue({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M126.12 315.1A47.06 47.06 0 1 1 79.06 268h47.06zm23.72 0a47.06 47.06 0 0 1 94.12 0v117.84a47.06 47.06 0 1 1-94.12 0zm47.06-188.98A47.06 47.06 0 1 1 244 79.06v47.06zm0 23.72a47.06 47.06 0 0 1 0 94.12H79.06a47.06 47.06 0 0 1 0-94.12zm188.98 47.06a47.06 47.06 0 1 1 47.06 47.1h-47.06zm-23.72 0a47.06 47.06 0 0 1-94.12 0V79.06a47.06 47.06 0 1 1 94.12 0zM315.1 385.88a47.06 47.06 0 1 1-47.1 47.06v-47.06zm0-23.72a47.06 47.06 0 0 1 0-94.12h117.84a47.06 47.06 0 1 1 0 94.12z"},child:[]}]})(t)}function aa(){const{t}=C();return e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(R,{order:2,size:"h4",children:t("Help & support")})}),e.jsxs(_,{gap:"xs",children:[e.jsx(w,{variant:"default",leftSection:e.jsx(ta,{}),rightSection:e.jsx(Z,{}),onClick:()=>{window.open("https://github.com/railmapgen/railmapgen.github.io/issues","_blank"),S.event(z.RAISE_ISSUE)},children:t("Raise an Issue on GitHub")}),e.jsx(w,{variant:"default",leftSection:e.jsx(sa,{}),rightSection:e.jsx(Z,{}),onClick:()=>{window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),S.event(z.JOIN_SLACK)},children:t("Join us on Slack")}),e.jsx(w,{variant:"default",leftSection:e.jsx(he,{className:ea.bilibili,src:"images/bilibili.svg"}),rightSection:e.jsx(Z,{}),onClick:()=>{window.open("https://space.bilibili.com/10124055","_blank"),S.event(z.FOLLOW_BILIBILI)},children:t("Follow us on Bilibili")})]})]})}function na(){const{t}=C(),{isShowMenu:s,menuView:n,lastShowDevtools:a}=L(p=>p.app),{isLoggedIn:o,name:i}=L(p=>p.account),c=E(),g=Ze(),[d]=Fe(),h=(S.getInstance()==="GitLab"?"https://railmapgen.gitlab.io/":"https://railmapgen.github.io/")+"?"+d.toString();f.useEffect(()=>{o&&c(J())},[o]);const u=[{key:"apps",label:t("Apps"),Icon:e.jsx(kt,{size:22})},{key:"links",label:t("Useful links"),Icon:e.jsx(At,{size:22})},{key:"devtools",label:t("Devtools"),Icon:e.jsx(Lt,{size:22}),ActionIconProps:{style:{display:Je(a)?"inline-flex":"none"}}},{key:"account",label:t("Account"),Icon:e.jsx(De,{variant:"light",name:o?i:void 0,size:"sm",color:"initials"}),ActionIconProps:{mt:"auto"}},{key:"contributors",label:t("Contributors"),Icon:e.jsx(Tt,{size:22}),ActionIconProps:{onClick:()=>{c(ss("contributors")),g||(c(ie()),S.toggleNavMenu(!1))}}},{key:"support",label:t("Help & support"),Icon:e.jsx(Rt,{size:22})},{key:"settings",label:t("Settings"),Icon:e.jsx(Pt,{size:22})}];return e.jsx("nav",{className:_e(H.root,s&&H["show-menu"]),children:e.jsxs("div",{className:H.wrapper,children:[e.jsxs(Ot,{className:H.header,children:[e.jsx(R,{children:t("Rail Map Toolkit")}),e.jsx(Et,{env:S.getEnv(),ver:S.getAppVersion()})]}),e.jsx(xe,{}),S.getEnv()!=="PRD"&&e.jsxs(X,{color:"yellow",icon:e.jsx(It,{}),className:H.alert,children:[t("You're currently viewing a testing environment.")," ",e.jsx(we,{size:"sm",href:h,target:"_blank",children:t("Back to production environment")})]}),e.jsxs("div",{className:H.body,children:[e.jsx("div",{className:H.aside,children:u.map(({key:p,label:r,Icon:m,ActionIconProps:y})=>e.jsx(_t,{label:r,position:"right",withArrow:!0,children:e.jsx(N,{variant:n===p?"light":"subtle",color:n===p?void 0:"gray",size:"lg",onClick:()=>c(as(p)),...y,children:m})},p))}),e.jsx(xe,{orientation:"vertical"}),e.jsxs("div",{className:H.main,children:[n==="apps"?e.jsx(Oe,{assetType:"app"}):n==="links"?e.jsx(qs,{}):n==="devtools"?e.jsx(Oe,{assetType:"devtool"}):n==="settings"?e.jsx(Qs,{}):n==="support"?e.jsxs(e.Fragment,{children:[e.jsx(aa,{}),e.jsx(Zs,{})]}):n==="account"?e.jsx(Gs,{}):e.jsx(e.Fragment,{}),e.jsx(As,{})]})]})]})})}function oa(t){const{opened:s,onClose:n}=t,{t:a}=C(),o=()=>{S.allowAnalytics(!0),n()},i=()=>{S.allowAnalytics(!1).refreshRequired?window.location.reload():n()};return e.jsxs(W,{opened:s,onClose:()=>{},title:a("CookiesModal.header"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:[e.jsx(T,{children:e.jsx(Xe,{ml:"auto"})}),e.jsxs(_,{gap:"xs",py:"xs",children:[e.jsx(M,{children:a("CookiesModal.text1")}),e.jsx(M,{mt:2,children:a("CookiesModal.text2")}),e.jsx(F,{withPadding:!0,children:e.jsxs(F.Item,{children:[" ",a("CookiesModal.item1")]})}),e.jsx(M,{mt:2,children:a("CookiesModal.text3")})]}),e.jsxs(T,{gap:"sm",children:[e.jsx(w,{variant:"default",ml:"auto",onClick:i,children:a("CookiesModal.reject")}),e.jsx(w,{onClick:o,children:a("CookiesModal.accept")})]})]})}const ia=()=>{};function ra(){const{t}=C(),[s,n]=f.useState(!1),a=()=>{n(!0),ns(),setTimeout(()=>{window.location.reload()},1e3)};return e.jsxs(W,{opened:!0,onClose:ia,title:t("Rail Map Toolkit is opened in another window"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:[e.jsx(M,{children:t("You cannot open multiple Rail Map Toolkit at the same time. Please close this window.")}),e.jsx(T,{mt:"xs",children:e.jsx(w,{variant:"default",onClick:a,loading:s,disabled:s,children:t("Restart RMT in this window")})})]})}const la=()=>{};function ca(){const{t}=C();return e.jsx(W,{opened:!0,onClose:la,title:t("Rail Map Toolkit is opened in another window"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:e.jsx(M,{children:t("Current session has been terminated. Please close this window.")})})}const da="_root_nos1z_1",ua={root:da},ha={info:void 0,success:"green",warning:"yellow",error:"red"},ue=200,Ie=400;function pa({notification:t}){const s=E(),[n,a]=f.useState(!1);return f.useEffect(()=>{setTimeout(()=>{a(!0)},ue);const o=setTimeout(()=>{a(!1)},ue+t.duration);return setTimeout(()=>{s(os(t.id))},ue+t.duration+Ie),()=>{clearTimeout(o)}},[]),e.jsx(Nt,{mounted:n,transition:"slide-left",duration:Ie,timingFunction:"ease",children:o=>e.jsx(zt,{color:ha[t.type],title:t.title,onClose:()=>a(!1),withBorder:!0,style:o,children:t.message})})}function ga(){const{notifications:t}=L(s=>s.notification);return e.jsx(Dt,{children:e.jsx(_,{className:ua.root,children:t.map(s=>e.jsx(pa,{notification:s},s.id))})})}function wa(){const{t}=C(),s=E(),{isPrimary:n,isTerminated:a,isShowMenu:o}=L(d=>d.app),[i,c]=f.useState(!1);f.useEffect(()=>{S.isAnalyticsQADone()||c(!0)},[]);const g=()=>{S.toggleNavMenu(!o),s(ie()),S.event(z.TOGGLE_NAV_MENU)};return e.jsx(Ft,{basename:"/",children:e.jsxs(Bt,{className:o?"show-menu":"",children:[e.jsx(N,{className:cs.burger,variant:o?"subtle":"filled",color:o?"gray":void 0,"aria-label":t("Toggle menu"),title:t("Toggle menu"),onClick:g,children:e.jsx(Vt,{})}),e.jsxs(Ut,{direction:"row",children:[e.jsx(na,{}),e.jsx(js,{alwaysShowWelcome:a||n===!1})]}),e.jsx(ga,{}),a&&e.jsx(ca,{}),n===!1&&e.jsx(ra,{}),e.jsx(oa,{opened:i,onClose:()=>c(!1)})]})})}export{wa as default};
