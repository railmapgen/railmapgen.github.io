import{j as e,ap as ce,aq as he,ar as X,H as b,$ as j,B as D,as as v,ad as we,al as Me,at as ee,a1 as f,ae as I,au as He,av as Ce,aw as ye,ax as te,M as de,ay as M,V as L,az as H,Y as C,Z as F,_ as y,a0 as _,F as z,aA as ue,aB as S,aC as N,aD as E,aE as $,W,g as Y,a5 as R,a6 as P,D as Ae,a4 as T,a8 as ne,aF as Se,aG as Re}from"./chakra--OYt8vue.js";import{l as g,r as h,m as pe,B as _e}from"./react-ChmrgLrp.js";import{F as Ie,u as q,a as ge,b as w,E as k,o as Ee,c as Te,t as U,s as De,d as Le,e as Pe,g as Oe,M as Be,f as se,r as Ne}from"./main-BCjpan9Q.js";import{r as l,f as O,g as B,d as xe,u as $e,j as Ge,h as G,i as Ve}from"./rmg-theme-provider-8iDCBseT.js";import{R as me}from"./rmg-fields-dFwrnlA2.js";var Ue=["en","zh-Hans","zh-Hant"],Fe=["ja","ko"],ae={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const We="/assets/rmp-logo512-Hh3pLqZ3.png",Ye={flex:1,justifyContent:"center",mb:10,"& > div":{mb:3},"& img":{w:120,p:2,backgroundColor:"white",borderRadius:12}};function qe(){const{t}=g();return e.jsxs(ce,{sx:Ye,children:[e.jsxs(he,{spacing:3,children:[e.jsx(X,{src:"/logo512.png"}),e.jsx(X,{src:We,backgroundColor:"white"})]}),e.jsx(b,{children:t("Welcome to Rail Map Toolkit")}),e.jsx(j,{fontSize:"lg",textAlign:"center",children:t("Select an app to start your own rail map design!")})]})}function Qe(t){var a;const{tab:n,isActive:o}=t,[s]=h.useState((a=n.url)!=null?a:"/"+n.app+"/");return e.jsx(D,{display:o?"block":"none",flex:1,children:e.jsx("iframe",{id:Ie+n.id,src:s,loading:"lazy",title:n.app,width:"100%",height:"100%"})})}function Ze(){const{openedTabs:t,activeTab:n}=q(a=>a.app),[o,s]=pe();return h.useEffect(()=>{var a;if(n){const i=(a=t.find(r=>r.id===n))==null?void 0:a.app;s(i?{app:i}:{})}else s({})},[n]),t.length===0?e.jsx(qe,{}):e.jsx(e.Fragment,{children:t.map(a=>e.jsx(Qe,{tab:a,isActive:n===a.id},a.id))})}function Je(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},child:[]}]})(t)}function Ke(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"},child:[]}]})(t)}function Xe(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v2h-2V7zm0 4h2v6h-2v-6z"},child:[]}]})(t)}function et(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(t)}function tt(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"},child:[]}]})(t)}function oe(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(t)}function nt(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(t)}function st(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(t)}function at(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"},child:[]}]})(t)}function ot(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3 1 9l11 6 9-4.91V17h2V9L12 3z"},child:[]}]})(t)}const ie={"& button:first-of-type":{w:"100%",overflow:"hidden",justifyContent:"flex-start",textOverflow:"ellipsis",textAlign:"start","& span.chakra-button__icon":{ml:-1,color:"orange.300",'[data-theme="dark"] &':{color:"orange.200"}}},'&[aria-current="true"] > button':{bg:"primary.50",_hover:{bg:"primary.100"},'[data-theme="dark"] &':{bg:"primary.700",_hover:{bg:"primary.600"}}}};function it(t){var Z;const{appId:n,onAboutOpen:o}=t,{t:s}=g(),a=ge(),i=we("(min-width: ".concat(Me.breakpoints.sm,")")),{activeTab:r,openedTabs:d}=q(c=>c.app),p=w[n],u=p.name.split(" - ").map(c=>s(c)).join(" - "),x=d.some(c=>c.app===n),m=!p.allowMultiInstances&&((Z=d.find(c=>c.id===r))==null?void 0:Z.app)===n,A=c=>{x||l.event(k.OPEN_APP,{appId:n,isOpenInNew:c}),a(c?Ee(n):Te({appId:n})),i[0]||(a(U()),l.toggleNavMenu(!1))},ve=c=>{a(De(c)),i[0]||(a(U()),l.toggleNavMenu(!1))},be=c=>{a(Le(c)),l.event(k.CLOSE_APP,{app:n})},ke=c=>{a(Pe(c)),l.event(k.CLOSE_APP,{app:c})};return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{variant:m?"solid":"ghost",size:"md",isAttached:!0,"aria-current":m,sx:ie,children:[e.jsx(f,{onClick:()=>A(!1),leftIcon:x?e.jsx(tt,{title:s("Running")}):e.jsx(D,{w:4}),children:u}),p.allowMultiInstances&&e.jsx(I,{"aria-label":s("New tab"),title:s("New tab"),icon:e.jsx(et,{}),onClick:()=>A(!0)}),e.jsxs(He,{children:[e.jsx(Ce,{as:I,icon:e.jsx(st,{}),"aria-label":s("More"),title:s("More")}),e.jsxs(ye,{children:[x&&e.jsx(te,{icon:e.jsx(oe,{}),onClick:()=>ke(n),children:p.allowMultiInstances?s("Close all tabs"):s("Close app")}),e.jsx(te,{icon:e.jsx(Je,{}),onClick:o,children:s("About")})]})]})]}),p.allowMultiInstances&&d.filter(c=>c.app===n).map((c,J)=>{const K=c.id===r;return e.jsxs(ee,{variant:K?"solid":"ghost",size:"sm",ml:8,mr:1,isAttached:!0,"aria-current":K,sx:ie,children:[e.jsxs(f,{onClick:()=>ve(c.id),children:[e.jsx(de,{mr:2,children:J+1}),s("Tab")+" "+(J+1).toString()+" - "+u]}),e.jsx(I,{"aria-label":s("Close tab"),title:s("Close tab"),icon:e.jsx(oe,{}),onClick:()=>be(c.id)})]},c.id)})]})}const rt=async t=>{const n="/".concat(t,"/info.json");try{return(await(await fetch(n)).json()).version}catch(o){return console.log("Failed to get version for ".concat(t)),"unknown"}},lt=async(t,n)=>{const o="/".concat(t,"/legacy-contributor-list.txt");return(await(await fetch(o,{signal:n})).text()).split("\n")};function ct(t){var d,p,u;const{appId:n,onClose:o}=t,{t:s}=g(),[a,i]=h.useState("Unknown"),r=n?(u=(p=(d=w[n])==null?void 0:d.url)==null?void 0:p.split("/"))==null?void 0:u[1]:void 0;return h.useEffect(()=>{r?rt(r).then(x=>i(x)):i("Unknown")},[r]),e.jsxs(M,{isOpen:!!n,onClose:o,size:"xl",scrollBehavior:"inside",children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsxs(C,{children:[s("About")+" "+(n?w[n].name.split(" - ").map(x=>s(x)).join(" - "):""),e.jsx(de,{ml:1,children:a})]}),e.jsx(F,{}),e.jsx(y,{}),e.jsx(_,{children:e.jsx(f,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/"+r,"_blank"),children:s("Visit GitHub")})})]})]})}const ht={flexDirection:"column","& h4":{mx:3,my:2},"& > div":{flexDirection:"column"}};function dt(){const{t}=g(),[n,o]=h.useState(),s=Oe(l.getEnv());return e.jsxs(z,{sx:ht,children:[e.jsx(b,{as:"h4",size:"md",children:t("Apps")}),e.jsx(z,{children:s.map(a=>e.jsx(it,{appId:a,onAboutOpen:()=>o(a)},a))}),e.jsx(ct,{appId:n,onClose:()=>o(void 0)})]})}const ut={flexDirection:"column",py:1,"& h4":{mx:3,my:2},"& > div":{px:2,"& button":{w:"100%"}}};function pt(){const{t}=g(),n=Be.filter(s=>s!==l.getInstance()),o=s=>{if(s==="Tauri"){const a=new Date;"".concat(a.getFullYear()).concat(String(a.getMonth()+1).padStart(2,"0"),"01"),"".concat(String(a.getFullYear()).slice(-2),".").concat(a.getMonth()+1,".1");const i=navigator.platform;i.includes("Linux")||i.includes("Mac");const r=se[s]+"/tauri-${tag}/railmapgen_${ver}_${suffix}";window.open(r,"_blank"),l.event(k.DOWNLOAD_APP,{})}else{const a=se[s];window.open(a,"_blank"),l.event(k.SWITCH_MIRROR,{url:a})}};return e.jsxs(z,{sx:ut,children:[e.jsx(b,{as:"h4",size:"md",children:t("More mirrors")}),e.jsx(ue,{templateColumns:"repeat(".concat(n.length,", auto)"),gap:2,children:n.map(s=>e.jsx(S,{children:e.jsx(f,{variant:"outline",size:"xs",rightIcon:e.jsx(Ke,{}),onClick:()=>o(s),children:t(s==="Tauri"?"Download desktop app":s)},s)},s))})]})}const gt={"& > span":{minW:"75%",borderRadius:"lg",cursor:"pointer","& > span:last-of-type":{display:"block"},"& p":{fontSize:"sm","&:first-of-type":{fontSize:"lg",fontWeight:"bold",mb:1}}},"& .chakra-avatar":{ml:1,mr:3,my:4}};function xt(){const{t}=g();return e.jsxs(O,{children:[e.jsx(B,{children:e.jsx(b,{as:"h5",size:"sm",children:t("Developer team")})}),e.jsxs(ce,{sx:gt,children:[e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/wongchito","_blank"),children:[e.jsx(E,{src:"https://github.com/wongchito.png",size:"lg"}),e.jsxs($,{children:[e.jsx(j,{children:"Chito Wong"}),e.jsx(j,{children:"Author of Rail Map Toolkit platform"}),e.jsx(j,{children:"Author of Rail Map Generator"})]})]}),e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),children:[e.jsx(E,{src:"https://github.com/thekingofcity.png",size:"lg"}),e.jsxs($,{children:[e.jsx(j,{children:"thekingofcity"}),e.jsx(j,{children:"Author of Rail Map Painter"}),e.jsx(j,{children:"Author of RMG (Shanghai Metro style)"})]})]}),e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/langonginc","_blank"),children:[e.jsx(E,{src:"https://github.com/langonginc.png",size:"lg"}),e.jsxs($,{children:[e.jsx(j,{children:"5+1"}),e.jsx(j,{children:"Author of RMP2RMG conversion"})]})]})]})]})}function Q(t){const{login:n,urlRepo:o,...s}=t,a=o?"https://github.com/railmapgen/".concat(o,"/issues?q=is:issue+author:").concat(n):"https://github.com/".concat(n);return e.jsx(E,{name:n,title:n,src:"https://github.com/".concat(n,".png"),loading:"lazy",onClick:()=>window.open(a,"_blank"),cursor:"pointer",...s})}const mt=["52PD","linchen1965","28yfang","Windows-Taskmgr"];function jt(){const{t}=g();return e.jsxs(O,{children:[e.jsx(B,{children:e.jsx(b,{as:"h5",size:"sm",children:t("Resource administrators")})}),e.jsx(W,{spacing:1.5,px:2,children:mt.map(n=>e.jsx(Y,{children:e.jsx(Q,{login:n,size:"md"})},n))})]})}const je="https://api.github.com/repos/railmapgen",V={},fe=async(t,n)=>{if(t in V)return V[t];const s=await(await fetch(t,n)).json();return V[t]=s,s},ft=async(t,n,o)=>{const s="".concat(je,"/").concat(t,"/contributors"),a=new URLSearchParams({per_page:"100",page:n.toString()});return(await fe(s+"?"+a.toString(),{signal:o})).map(r=>r.login)},zt=async(t,n,o)=>{const s="".concat(je,"/").concat(t,"/issues"),a=new URLSearchParams({state:"closed",labels:"donation",per_page:"100",page:n.toString()});return(await fe(s+"?"+a.toString(),{signal:o})).filter(r=>r.state_reason==="completed").map(r=>{var d;return(d=r.user)==null?void 0:d.login})};function ze(t){const[n,o]=h.useState(t!=null?t:[]);return[n,a=>{o(i=>{const r=new Set(i?i.concat(a):a);return Array.from(r)})}]}const vt=["","wongchito","thekingofcity","github-actions[bot]"],re=t=>!vt.includes(t);function bt(t){const[n,o]=ze(),[s,a]=h.useState(!0),[i,r]=h.useState(!1),d=h.useRef(),p=async()=>{var x;let u=1;for(;;){d.current=new AbortController;const m=await ft(t,u,(x=d.current)==null?void 0:x.signal);if(o(m.filter(re)),m.length<100)break;u++}};return h.useEffect(()=>(p().then(()=>{var u;return w[t].legacyContributors?(d.current=new AbortController,lt(t,(u=d.current)==null?void 0:u.signal)):[]}).then(u=>o(u.filter(re))).catch(u=>{console.error("[rmt] unable to fetch contributors for:",t,u),r(!0)}).finally(()=>a(!1)),()=>{var u;(u=d.current)==null||u.abort(),a(!0),r(!1)}),[t]),{contributors:n,isLoading:s,isError:i}}const kt={position:"relative",minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function wt(t){const{appId:n}=t,{t:o}=g(),{contributors:s,isLoading:a,isError:i}=bt(n);return e.jsxs(z,{sx:kt,children:[a&&e.jsx(xe,{isIndeterminate:!0}),i&&e.jsxs(R,{status:"warning",children:[e.jsx(P,{}),o("Unable to load contributors")]}),!i&&s&&e.jsx(W,{spacing:1.5,children:s==null?void 0:s.map(r=>e.jsx(Y,{children:e.jsx(Q,{login:r,urlRepo:n,size:"sm"})},r))})]})}const Mt={"& > *:not(.rmg-section__header)":{px:2},"& h6":{my:2}};function Ht(){const{t}=g();return e.jsxs(O,{sx:Mt,children:[e.jsx(B,{children:e.jsx(b,{as:"h5",size:"sm",children:t("Resource contributors")})}),Object.entries(w).filter(([n,o])=>o.showContributors).map(([n,o])=>e.jsxs(h.Fragment,{children:[e.jsx(b,{as:"h6",size:"xs",children:t(o.name)}),e.jsx(wt,{appId:n},n)]},n)),e.jsx(j,{as:"i",fontSize:"xs",mt:3,children:t("Notes: Contributors are sorted by number of commits and commit time.")})]})}function Ct(){const[t,n]=ze(),[o,s]=h.useState(!0),[a,i]=h.useState(!1),r=h.useRef(),d=async()=>{var u;const p=Object.entries(w).filter(([x,m])=>m.showDonators).map(([x])=>x);for(const x of p)try{let m=1;for(;;){r.current=new AbortController;const A=await zt(x,m,(u=r.current)==null?void 0:u.signal);if(n(A),A.length<100)break;m++}}catch(m){throw console.error("[rmt] unable to fetch donators for:",x,m),m}};return h.useEffect(()=>(d().catch(()=>i(!0)).finally(()=>s(!1)),()=>{var p;(p=r.current)==null||p.abort(),s(!0),i(!1)}),[]),{donators:t,isLoading:o,isError:a}}const yt={position:"relative",px:2,minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function At(){const{t}=g(),{donators:n,isLoading:o,isError:s}=Ct();return e.jsxs(O,{children:[e.jsx(B,{children:e.jsx(b,{as:"h5",size:"sm",children:"❤️ "+t("Donators")})}),e.jsxs(z,{sx:yt,children:[o&&e.jsx(xe,{isIndeterminate:!0}),s&&e.jsxs(R,{status:"warning",children:[e.jsx(P,{}),t("Unable to load donators")]}),!s&&n&&e.jsx(W,{spacing:1.5,children:n==null?void 0:n.map(a=>e.jsx(Y,{children:e.jsx(Q,{login:a,size:"sm"})},a))})]})]})}const St={bg:"inherit",py:0,"& section:not(:last-of-type)":{mb:4}};function Rt(t){const{isOpen:n,onClose:o}=t,{t:s}=g();return e.jsxs(M,{isOpen:n,onClose:o,size:"xl",scrollBehavior:"inside",children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsx(C,{children:s("Contributors")}),e.jsx(F,{}),e.jsxs(y,{sx:St,children:[e.jsx(xt,{}),e.jsx(At,{}),e.jsx(jt,{}),e.jsx(Ht,{})]}),e.jsx(_,{children:e.jsx(f,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/rmg/wiki/How-to-add-color-palette-and-line-templates","_blank"),children:s("Contribution Wiki")})})]})]})}function _t(t){const{isOpen:n,onClose:o}=t,{t:s}=g(),[a,i]=h.useState(l.isAllowAnalytics()),[r,d]=h.useState();h.useEffect(()=>{n||d(void 0)},[n]);const p=[{type:"switch",label:s("Allow cookies to help improve our website"),isChecked:a,onChange:i,oneLine:!0}],u=()=>{l.allowAnalytics(a).refreshRequired?d("Refreshing is required for changes to take effect."):o()};return e.jsxs(M,{isOpen:n,onClose:o,children:[e.jsx(L,{}),e.jsxs(H,{children:[r&&e.jsxs(R,{status:"info",variant:"solid",size:"xs",children:[e.jsx(P,{}),s(r)]}),e.jsxs(D,{position:"relative",children:[e.jsx(C,{children:s("Privacy settings")}),e.jsx(F,{})]}),e.jsx(y,{children:e.jsx(me,{fields:p})}),e.jsx(_,{children:e.jsx(f,{colorScheme:"primary",isDisabled:!!r,onClick:u,children:s("Save")})})]})]})}function It(t){return v({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M126.12 315.1A47.06 47.06 0 1 1 79.06 268h47.06zm23.72 0a47.06 47.06 0 0 1 94.12 0v117.84a47.06 47.06 0 1 1-94.12 0zm47.06-188.98A47.06 47.06 0 1 1 244 79.06v47.06zm0 23.72a47.06 47.06 0 0 1 0 94.12H79.06a47.06 47.06 0 0 1 0-94.12zm188.98 47.06a47.06 47.06 0 1 1 47.06 47.1h-47.06zm-23.72 0a47.06 47.06 0 0 1-94.12 0V79.06a47.06 47.06 0 1 1 94.12 0zM315.1 385.88a47.06 47.06 0 1 1-47.1 47.06v-47.06zm0-23.72a47.06 47.06 0 0 1 0-94.12h117.84a47.06 47.06 0 1 1 0 94.12z"},child:[]}]})(t)}function Et(){const{t}=g(),[n,o]=h.useState(!1),[s,a]=h.useState(!1);return e.jsxs(z,{direction:"column",children:[e.jsx(Ae,{}),e.jsxs(ue,{templateColumns:"repeat(4, auto)",children:[e.jsx(S,{children:e.jsx(f,{as:T,variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(It,{}),target:"_blank",href:"https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A",children:"Slack"})}),e.jsx(S,{children:e.jsx(f,{variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(at,{}),onClick:()=>o(!0),children:t("Contributors")})}),e.jsx(S,{children:e.jsx(f,{variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(Xe,{}),onClick:()=>a(!0),children:t("Privacy")})}),e.jsx(S,{children:e.jsx(f,{as:T,variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(ot,{}),target:"_blank",href:"https://rmttutorial.wordpress.com",children:t("Tutorial")})})]}),e.jsx(Rt,{isOpen:n,onClose:()=>o(!1)}),e.jsx(_t,{isOpen:s,onClose:()=>a(!1)})]})}const Tt={flexDirection:"column",py:1,"& h4":{mx:3,my:2},"& > div":{px:2}};function Dt(){const{t}=g(),{setColourMode:n}=$e(),o={light:t("Light"),dark:t("Dark"),system:t("System")},s=[{type:"select",label:t("Language"),value:l.getLanguage(),options:{[t("Main languages")]:Ue.reduce((a,i)=>({...a,[i]:ae[i][i]}),{}),[t("Other languages")]:Fe.reduce((a,i)=>({...a,[i]:ae[i][i]}),{})},onChange:a=>{const i=a;l.setLanguage(i),l.getI18nInstance().changeLanguage(i),l.event(k.CHANGE_LANGUAGE,{language:i})}},{type:"select",label:t("Appearance"),value:l.getColourMode(),options:o,onChange:a=>n(a)}];return e.jsxs(z,{sx:Tt,children:[e.jsx(b,{as:"h4",size:"md",children:t("Settings")}),e.jsx(D,{children:e.jsx(me,{fields:s})})]})}const le=420,Lt={flexShrink:0,flexDirection:"column",overflow:"hidden",alignItems:"flex-end",transition:"0.3s ease-in-out",maxW:0,visibility:"hidden",boxShadow:"lg",zIndex:100,".show-menu &":{maxW:{base:"100%",md:le},w:{base:"100%",md:"unset"},visibility:"initial"},"& > div":{flexDirection:"column",h:"100%",w:{base:"100vw",md:le},"& .nav-menu__header":{flex:0,flexDirection:"row",alignItems:"center",minHeight:10,pl:12},"& .nav-menu__body":{flexDirection:"column",flex:1,overflow:"hidden","& > div:first-of-type":{flex:1,overflowY:"auto"}}},"& .chakra-alert":{flexGrow:0,pl:3,pr:2,py:2,"& a":{fontWeight:"bold",textDecoration:"underline","&:hover, &:focus":{textDecoration:"none"}}}};function Pt(){const{t}=g(),[n]=pe(),o=(l.getInstance()==="GitLab"?"https://railmapgen.gitlab.io/":"https://railmapgen.github.io/")+"?"+n.toString();return e.jsx(z,{as:"section",sx:Lt,children:e.jsxs(z,{children:[e.jsxs(z,{className:"nav-menu__header",children:[e.jsx(b,{as:"h4",size:"md",children:t("Rail Map Toolkit")}),e.jsx(Ge,{environment:l.getEnv(),version:l.getAppVersion()})]}),l.getEnv()!=="PRD"&&e.jsxs(R,{status:"warning",children:[e.jsx(P,{}),e.jsxs(ne,{children:[t("You're currently viewing a testing environment.")," ",e.jsx(T,{href:o,isExternal:!0,children:t("Back to production environment")})]})]}),e.jsx(R,{status:"error",children:e.jsxs(ne,{children:["🎇"," ",e.jsx(T,{href:"https://en.wikipedia.org/wiki/Chinese_New_Year",isExternal:!0,children:t("Happy Chinese New Year!")})]})}),e.jsxs(z,{className:"nav-menu__body",children:[e.jsx(dt,{}),e.jsx(Dt,{}),e.jsx(pt,{})]}),e.jsx(Et,{})]})})}function Ot(t){const{isOpen:n,onClose:o}=t,{t:s}=g(),a=h.useRef(null),i=()=>{l.allowAnalytics(!0),o()},r=()=>{l.allowAnalytics(!1).refreshRequired?window.location.reload():o()};return e.jsxs(M,{initialFocusRef:a,isOpen:n,onClose:()=>{},children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsx(C,{children:s("CookiesModal.header")}),e.jsxs(y,{children:[e.jsx(j,{children:s("CookiesModal.text1")}),e.jsx(j,{mt:2,children:s("CookiesModal.text2")}),e.jsx(Se,{children:e.jsxs(Re,{children:[" ",s("CookiesModal.item1")]})}),e.jsx(j,{mt:2,children:s("CookiesModal.text3")})]}),e.jsx(_,{children:e.jsxs(he,{children:[e.jsx(f,{variant:"ghost",onClick:r,children:s("CookiesModal.reject")}),e.jsx(f,{ref:a,colorScheme:"primary",onClick:i,children:s("CookiesModal.accept")})]})})]})]})}const Bt=()=>{};function Nt(){const{t}=g(),[n,o]=h.useState(!1),s=()=>{o(!0),Ne(),setTimeout(()=>{window.location.reload()},1e3)};return e.jsx(M,{isOpen:!0,onClose:Bt,children:e.jsxs(H,{children:[e.jsx(C,{children:t("Rail Map Toolkit is opened in another window")}),e.jsx(y,{children:t("You cannot open multiple Rail Map Toolkit at the same time. Please close this window.")}),e.jsx(_,{children:e.jsx(f,{colorScheme:"primary",onClick:s,isLoading:n,children:t("Restart RMT in this window")})})]})})}const $t=()=>{};function Gt(){const{t}=g();return e.jsx(M,{isOpen:!0,onClose:$t,children:e.jsxs(H,{children:[e.jsx(C,{children:t("Rail Map Toolkit is opened in another window")}),e.jsx(y,{children:t("Current session has been terminated. Please close this window.")})]})})}function qt(){const{t}=g(),n=ge(),{isPrimary:o,isTerminated:s,isShowMenu:a}=q(p=>p.app),[i,r]=h.useState(!1);h.useEffect(()=>{l.isAnalyticsQADone()||r(!0)},[]);const d=()=>{l.toggleNavMenu(!a),n(U()),l.event(k.TOGGLE_NAV_MENU,{})};return s?e.jsx(G,{children:e.jsx(Gt,{})}):o===!1?e.jsx(G,{children:e.jsx(Nt,{})}):e.jsx(_e,{basename:"/",children:e.jsxs(G,{className:a?"show-menu":"",children:[e.jsx(I,{variant:a?"ghost":"solid",colorScheme:a?void 0:"primary",size:"md","aria-label":t("Toggle menu"),title:t("Toggle menu"),icon:e.jsx(nt,{}),position:"absolute",zIndex:110,borderRadius:0,onClick:d}),e.jsxs(Ve,{sx:{flexDirection:"row"},children:[e.jsx(Pt,{}),e.jsx(Ze,{})]}),e.jsx(Ot,{isOpen:i,onClose:()=>r(!1)})]})})}export{qt as default};
