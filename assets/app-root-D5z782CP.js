import{j as e,S as _,G as R,I as he,T as O,e as C,n as Ie,o as W,C as J,F as ae,p as nt,B as w,q as ot,u as it,s as q,t as N,v as lt,P as ce,w as Ne,x as rt,y as De,z as pe,D as ct,A as ze,E as dt,H as ut,b as z,c as B,d as te,g as Y,J as Be,K as be,O as we,Q as ht,U as pt,V as gt,l as ge,W as U,X,M as Ve,Y as xe,Z as xt,_ as me,$ as Ue,a0 as mt,a1 as se,a2 as jt,a3 as ft,a4 as St,r as f,a5 as bt,a6 as wt,a7 as Ct,N as yt,a8 as vt,a9 as Mt,aa as Me,ab as kt,ac as We,ad as At,ae as Lt,af as Rt,ag as Tt,ah as Et,ai as Ot,k as Pt,aj as _t,ak as It,al as Nt,am as Dt,an as zt,i as Bt,ao as Vt,m as Ut}from"./mantine-CPpwgZl0.js";import{k as y,r as j,o as Fe,R as Q,B as Wt}from"./react-D-S1_Irw.js";import{u as P,o as je,F as Ft,a as L,b as Gt,S as K,l as I,s as Ge,f as $,g as fe,c as He,n as $e,d as Je,e as Ht,h as T,A as E,i as $t,j as F,k as Ce,m as Jt,E as D,p as Kt,t as ie,q as qt,r as Yt,v as Qt,w as Ke,x as Zt,y as Xt,z as es,B as ts,C as ss,D as as,G as ns}from"./main-BwnU7KOv.js";import{a as ee,b as qe,S as os,O as is,L as de}from"./asset-enablements-B6JIMksJ.js";import"./index-CaNY-TcG.js";const ls="_burger_1y0se_1",rs={burger:ls},cs="_workspace_1nep4_1",ds="_show_1nep4_13",us="_welcome_1nep4_23",hs="_icons_1nep4_38",ne={workspace:cs,"app-container":"_app-container_1nep4_8",show:ds,welcome:us,icons:hs},ps="/assets/rmp-logo512-eHekupnf.png";function gs(){const{t}=y(),s=P();return e.jsxs(_,{className:ne.welcome,children:[e.jsxs(R,{className:ne.icons,grow:!0,children:[e.jsx(he,{src:"/logo512.png",title:t("Open")+" "+t("Rail Map Generator"),onClick:()=>s(je({appId:"rmg"}))}),e.jsx(he,{src:ps,title:t("Open")+" "+t("Rail Map Painter"),onClick:()=>s(je({appId:"rmp"}))})]}),e.jsx(O,{children:t("Welcome to Rail Map Toolkit")}),e.jsx(C,{children:t("Select an app to start your own rail map design!")})]})}function xs(t){const{tab:s,isActive:n}=t,a=j.useMemo(()=>s.url??"/"+s.app+"/",[s.app]);return e.jsx("div",{className:Ie(ne["app-container"],n&&ne.show),children:e.jsx("iframe",{id:Ft+s.id,src:a,loading:"lazy",title:s.app,"data-persisted-url":s.url,"data-testid":"app-container-iframe"})})}function ms({alwaysShowWelcome:t}){const{openedTabs:s,activeTab:n}=L(o=>o.app),[,a]=Fe();return j.useEffect(()=>{var o;if(n){const i=(o=s.find(r=>r.id===n))==null?void 0:o.app;a(i?{app:i}:{})}else a({})},[n]),e.jsx("div",{className:ne.workspace,children:t||s.length===0?e.jsx(gs,{}):s.map(o=>e.jsx(xs,{tab:o,isActive:n===o.id},o.id))})}const js="_root_mj6g1_5",fs="_wrapper_mj6g1_31",Ss="_alert_mj6g1_42",bs="_header_mj6g1_49",ws="_body_mj6g1_55",Cs="_aside_mj6g1_62",ys="_main_mj6g1_75",G={root:js,"show-menu":"_show-menu_mj6g1_15",wrapper:fs,alert:Ss,header:bs,body:ws,aside:Cs,main:ys},vs="_card_15zs0_1",ke={card:vs},Ae=(t,s,n)=>{const a=new Blob([n],{type:s});Ms(t,a)},Ms=(t,s)=>{const n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n)},ks=()=>{const{t}=y(),{token:s,refreshToken:n,currentSaveId:a}=L(m=>m.account),{resolveConflictModal:{isOpen:o,lastChangedAtTimeStamp:i,lastUpdatedAtTimeStamp:r,cloudData:g}}=L(m=>m.rmpSave),u=P(),[h,x]=Q.useState(!1),c=()=>u(Ht()),d=()=>{He(K.RMP,g),$e(),u(Je(r)),c()},S=()=>{Ae(`RMP_${r}.json`,"application/json",g)},M=async()=>{if(!a||!s||!n)return;x(!0);const m=await Gt(a,s,n,K.RMP);if(!m){u(I()),x(!1);return}if(m.status===409){u(Ge()),x(!1);return}m.status===200&&(u($()),x(!1),c())},b=async()=>{const{data:m}=await fe(K.RMP);Ae(`RMP_${i}.json`,"application/json",m)};return e.jsxs(W,{opened:o,onClose:()=>{},size:"lg",title:t("Oops! It seems there's a conflict"),withCloseButton:!1,closeOnClickOutside:!1,closeOnEscape:!1,centered:!0,children:[e.jsx(C,{children:t("The local save is newer than the cloud one. Which one would you like to keep?")}),e.jsxs(R,{my:"xs",children:[e.jsx(J,{withBorder:!0,className:ke.card,children:e.jsxs(_,{children:[e.jsxs(ae,{children:[e.jsx(nt,{}),e.jsx(C,{span:!0,children:t("Local save")})]}),e.jsxs(C,{span:!0,children:[t("Update at:")," ",new Date(i).toLocaleString()]}),e.jsx(w,{color:"red",loading:h,onClick:()=>M(),children:t("Replace cloud with local")}),e.jsx(w,{onClick:()=>b(),children:t("Download Local save")})]})}),e.jsx(J,{withBorder:!0,className:ke.card,children:e.jsxs(_,{children:[e.jsxs(ae,{children:[e.jsx(ot,{}),e.jsx(C,{span:!0,children:t("Cloud save")})]}),e.jsxs(C,{span:!0,children:[t("Update at:")," ",new Date(r).toLocaleString()]}),e.jsx(w,{color:"red",onClick:()=>d(),children:t("Replace local with cloud")}),e.jsx(w,{onClick:()=>S(),children:t("Download Cloud save")})]})})]})]})},As="_body_yczk0_1",Ls={body:As};function Ye(t){const{initialValue:s,onSave:n,fontWeight:a="bold",iconVariant:o,textInputWidth:i,placeholder:r="...",emptyPlaceholder:g="(empty)"}=t,u=it(),[h,x]=j.useState(!1),[c,d]=j.useState(s),S=j.useRef(null),[M,b]=j.useState("");j.useEffect(()=>{h&&S.current&&(S.current.focus(),S.current.select())},[h]);const m=()=>{b(c),x(!0)},p=()=>{c!==M&&n(c),x(!1)},k=()=>{d(M),x(!1)},V=A=>{d(A.currentTarget.value)},l=A=>{A.key==="Enter"?p():A.key==="Escape"&&k()},v=()=>{p()};return h?e.jsx(R,{gap:"xs",wrap:"nowrap",style:{width:i},children:e.jsx(q,{ref:S,value:c,onChange:V,onKeyDown:l,onBlur:v,placeholder:r,styles:{input:{fontWeight:a}}})}):e.jsxs(R,{gap:"xs",wrap:"nowrap",flex:"1",p:"0",onClick:m,style:{cursor:"pointer",padding:`calc(${u.spacing.xs} / 2) ${u.spacing.xs}`,minHeight:"36px",display:"flex",alignItems:"center",borderRadius:u.radius.sm,"&:hover":{backgroundColor:u.colors.gray[0]}},children:[e.jsx(C,{fw:a,style:{flexGrow:1,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c||g}),e.jsx(N,{variant:o,color:o=="subtle"?"gray":void 0,onClick:A=>{A.stopPropagation(),m()},title:"Edit",children:e.jsx(lt,{size:16})})]})}function Le({meets:t,label:s}){return e.jsxs(C,{c:t?"teal":"red",style:{display:"flex",alignItems:"center"},mt:7,size:"sm",children:[t?e.jsx(De,{size:14}):e.jsx(pe,{size:14}),e.jsx(ct,{ml:10,children:s})]})}const Se=[{re:/[0-9]/,label:"Includes number"},{re:/[a-zA-Z]/,label:"Includes letter"}];function Rs(t){let s=t.length>=8?0:1;return Se.forEach(n=>{n.re.test(t)||(s+=1)}),Math.max(100-100/(Se.length+1)*s,10)}function ye({value:t,onChange:s}){const{t:n}=y(),[a,o]=j.useState(!1),i=Se.map((u,h)=>e.jsx(Le,{label:u.label,meets:u.re.test(t)},h)),r=Rs(t),g=r===100?"teal":r>50?"yellow":"red";return e.jsxs(ce,{opened:a,position:"bottom",width:"target",transitionProps:{transition:"pop"},children:[e.jsx(ce.Target,{children:e.jsx("div",{onFocusCapture:()=>o(!0),onBlurCapture:()=>o(!1),children:e.jsx(Ne,{label:n("Password"),value:t,onChange:u=>s(u.currentTarget.value)})})}),e.jsxs(ce.Dropdown,{children:[e.jsx(rt,{color:g,value:r,size:5,mb:"xs"}),e.jsx(Le,{label:n("Includes at least 8 characters"),meets:t.length>=8}),i]})]})}const Ts=()=>{const{t}=y(),s=P(),{isLoggedIn:n,id:a,email:o,name:i,token:r,refreshToken:g}=L(m=>m.account),[u,h]=Q.useState(void 0),[x,c]=Q.useState(""),d=async()=>{n&&(await T(E.AUTH_LOGOUT,{method:"POST",body:JSON.stringify({refreshToken:g})}),s(I()))},S=m=>s(F({title:t("Unable to update account info"),message:m,type:"error",duration:9e3})),M=async m=>{if(n)try{const p=await T(E.USER+"/"+a,{method:"PATCH",body:JSON.stringify({name:m})},r);if(p.status===401){S(t("Login status expired.")),s(I());return}if(p.status!==200){S(await p.text());return}s($t(m))}catch(p){S(p.message)}},b=async()=>{if(n)try{const m=await T(E.USER+"/"+a,{method:"PATCH",body:JSON.stringify({password:x})},r);if(m.status===401){S(t("Login status expired.")),s(I());return}if(m.status!==200){S(await m.text());return}s(I()),h(void 0)}catch(m){S(m.message)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{py:"xs",align:"center",wrap:"wrap",children:[e.jsx(ze,{size:"lg",name:i,color:"initials"}),e.jsxs(_,{justify:"center",ml:"md",gap:"0",flex:"1",children:[e.jsxs(R,{children:[e.jsx(Ye,{initialValue:i??"",onSave:m=>M(m),iconVariant:"subtle",textInputWidth:"181px"}),e.jsx(N,{variant:"subtle",color:"gray",size:"sm",onClick:()=>h("password"),"aria-label":t("Change password"),title:t("Change password"),children:e.jsx(dt,{})}),e.jsx(N,{variant:"subtle",color:"gray",size:"sm",onClick:d,"aria-label":t("Log out"),title:t("Log out"),children:e.jsx(ut,{})})]}),e.jsx(C,{span:!0,size:"sm",children:o})]})]}),e.jsxs(W,{opened:!!u,onClose:()=>h(void 0),title:t("Update account info"),closeOnEscape:!1,children:[e.jsx(ye,{value:x,onChange:m=>c(m)}),e.jsx(R,{mt:"xs",children:e.jsx(w,{ml:"auto",onClick:b,children:t("Change")})})]})]})},Es=/^\S+@\S+\.\S+$/,le=t=>!!t.match(Es),Qe=t=>t.length>=8&&!!t.match(/\d/)&&!!t.match(/[a-zA-Z]/),Re=60;function Ze({value:t,onChange:s,onVerify:n,otpSent:a,allowResendOtp:o,...i}){const{t:r}=y(),[g,u]=j.useState(!1),[h,x]=j.useState(Re),c=!!t&&le(t),d=()=>{o&&(u(!0),x(Re)),n()};return j.useEffect(()=>{let S;return g&&h>0?S=window.setTimeout(()=>{x(h-1)},1e3):h===0&&u(!1),()=>clearTimeout(S)},[g,h]),e.jsx(q,{type:"email",label:r("Email"),value:t,onChange:({currentTarget:{value:S}})=>s(S),error:t&&!le(t),rightSection:a?e.jsx(w,{variant:"transparent",size:"xs",leftSection:e.jsx(De,{}),disabled:!0,children:r("Verification code sent")}):e.jsx(w,{variant:"subtle",size:"xs",onClick:d,disabled:!c||g,children:g?`${h}s`:r("Send verification code")}),rightSectionWidth:"fit-content",...i})}const Os=t=>{const{t:s}=y(),n=P(),[a,o]=j.useState(""),[i,r]=j.useState(""),[g,u]=j.useState(""),[h,x]=j.useState(""),[c,d]=j.useState(!1),M=!!a&&le(a)&&!!g&&!!i&&Qe(i),b=k=>n(F({title:s("Unable to reset your password"),message:k,type:"error",duration:9e3})),m=async()=>{try{const k=await T(E.AUTH_SEND_RESET_PASSWORD_EMAIL,{method:"POST",body:JSON.stringify({email:a})});k.status===204?x(a):k.status>400&&x("error")}catch{x("error")}},p=async()=>{d(!0);const k=new URLSearchParams({token:g}),V=`${E.AUTH_RESET_PASSWORD}?${k.toString()}`;try{const l=await T(V,{method:"POST",body:JSON.stringify({password:i})});if(l.status!==204){b(await l.text());return}const{error:v,username:A}=(await n(Ce({email:a,password:i}))).payload;v?b(v):n(F({title:s("Welcome ")+A,message:s("Your password has been reset successfully."),type:"success",duration:5e3}))}catch(l){b(l.message)}finally{d(!1)}};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:3,size:"h5",children:s("Forgot password")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[h==="error"&&e.jsx(Y,{color:"red",icon:e.jsx(Be,{}),title:s("Check your email again!")}),h&&h!=="error"&&e.jsx(Y,{color:"blue",icon:e.jsx(be,{}),title:s("Email with reset link is sent to")+" "+h}),e.jsx(Ze,{value:a,onChange:o,onVerify:m,otpSent:h}),e.jsx(q,{label:s("Reset password token"),value:g,onChange:({currentTarget:{value:k}})=>u(k)}),e.jsx(ye,{value:i,onChange:r}),e.jsx(w,{onClick:p,loading:c,disabled:!M||c,children:s("Reset password")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("login"),disabled:c,children:s("Back to log in")})]})]})},Ps=/^\S+@\S+\.\S+$/,Te=t=>!!t.match(Ps),_s=t=>{const{t:s}=y(),n=P(),[a,o]=j.useState(""),[i,r]=j.useState(""),[g,u]=j.useState(!1),h=!!a&&Te(a)&&!!i,x=async()=>{u(!0);try{const{error:c,username:d}=(await n(Ce({email:a,password:i}))).payload;n(c?F({title:s("Unable to login"),message:c,type:"error",duration:9e3}):F({title:s("Welcome ")+d,message:s("Login success"),type:"success",duration:5e3}))}finally{u(!1)}};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:3,size:"h5",children:s("Log in")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[e.jsx(q,{type:"email",label:s("Email"),value:a,onChange:({currentTarget:{value:c}})=>o(c),error:a&&!Te(a)}),e.jsx(Ne,{label:s("Password"),value:i,onChange:({currentTarget:{value:c}})=>r(c)}),e.jsx(we,{component:"button",ml:"auto",onClick:()=>t.setLoginState("forgot-password"),children:s("Forgot password")+"?"}),e.jsx(w,{onClick:x,loading:g,disabled:!h||g,children:s("Log in")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("register"),disabled:g,children:s("Create an account")})]})]})},Is=t=>{const{t:s}=y(),n=P(),[a,o]=j.useState(""),[i,r]=j.useState(""),[g,u]=j.useState(""),[h,x]=j.useState(""),[c,d]=j.useState(""),[S,M]=j.useState(!1),b=!!i&&le(i),m=!!a&&b&&!!h&&!!g&&Qe(g),p=l=>n(F({title:s("Unable to create your account"),message:l,type:"error",duration:9e3})),k=async()=>{try{const l=await T(E.AUTH_SEND_VERIFICATION_EMAIL,{method:"POST",body:JSON.stringify({email:i})});l.status===204?d(i):l.status>400&&d("error")}catch{d("error")}},V=async()=>{M(!0);try{const l=await T(E.AUTH_REGISTER,{method:"POST",body:JSON.stringify({name:a,email:i,password:g,emailVerificationToken:Number(h)})});if(l.status!==201){p(await l.text());return}const{error:v,username:A}=(await n(Ce({email:i,password:g}))).payload;v?p(v):n(F({title:s("Welcome ")+A,message:s("Your account is created successfully."),type:"success",duration:5e3}))}catch(l){p(l.message)}finally{M(!1)}};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:3,size:"h5",children:s("Create an account")})}),e.jsxs(te,{direction:"column",gap:"xs",children:[c==="error"&&e.jsx(Y,{color:"red",icon:e.jsx(Be,{}),title:s("The email is not valid!")}),c&&c!=="error"&&e.jsx(Y,{color:"blue",icon:e.jsx(be,{}),title:s("Verification email is sent to")+" "+c}),e.jsx(q,{label:s("Name"),description:s("You may always change it later."),value:a,onChange:({currentTarget:{value:l}})=>o(l)}),e.jsx(Ze,{description:s("We'll never share your email."),value:i,onChange:r,onVerify:k,otpSent:c,allowResendOtp:!0}),e.jsx(q,{label:s("Verification code"),value:h,onChange:({currentTarget:{value:l}})=>x(l)}),e.jsx(ye,{value:g,onChange:u}),e.jsx(w,{onClick:V,loading:S,disabled:!m||S,children:s("Sign up")}),e.jsx(w,{variant:"default",onClick:()=>t.setLoginState("login"),disabled:S,children:s("Back to log in")})]})]})},Ns=1,Ds=10,zs=()=>{const{t}=y(),s=P(),{isLoggedIn:n,token:a,activeSubscriptions:o,currentSaveId:i,saves:r}=L(l=>l.account),{lastChangedAtTimeStamp:g}=L(l=>l.rmpSave),u=n&&r&&(o.RMP_CLOUD?r.length<Ds:r.length<Ns),h=Math.min(...(r??[]).map(l=>l.id)),x=l=>!o.RMP_CLOUD&&l!==h,[c,d]=Q.useState(void 0),[S,M]=Q.useState(void 0),b=l=>s(F({title:t("Unable to sync your save"),message:l,type:"error",duration:9e3})),m=async()=>{const l=await fe(K.RMP);if(!n||!l||!a){b(t("Failed to get the RMP save!"));return}const{data:v,hash:A}=l,oe=Bs();try{const H=await T(E.SAVES,{method:"POST",body:JSON.stringify({index:oe,data:v,hash:A})},a);if(H.status===401){b(t("Login status expired.")),s(I());return}if(H.status!==200){b(await H.text());return}s($())}catch(H){b(H.message)}},p=async l=>{if(!(!n||!a)){if(l===i){if(d(i),!i||x(i)){b(t("Can not sync this save!")),d(void 0);return}const v=await s($());if(v.meta.requestStatus!=="fulfilled"){b(t("Login status expired.")),d(void 0);return}const oe=v.payload.saves.filter(at=>at.id===i).at(0);if(!oe){b(t("Current save id is not in saveList!")),d(void 0);return}const H=new Date(oe.lastUpdateAt);if(new Date(g)<H){ge.warn(`Save id: ${i} is newer in the cloud via local compare.`),s(Ge()),d(void 0);return}const ve=await fe(K.RMP);if(!ve){b(t("Failed to get the RMP save!")),d(void 0);return}const{data:tt,hash:st}=ve,re=await T(E.SAVES+"/"+i,{method:"PATCH",body:JSON.stringify({data:tt,hash:st})},a);if(re.status===401){b(t("Login status expired.")),d(void 0),s(I());return}if(re.status!==200){b(await re.text()),d(void 0);return}d(void 0)}else{d(l);const v=await T(E.SAVES+"/"+l,{},a);if(v.status===401){b(t("Login status expired.")),d(void 0),s(I());return}if(v.status!==200){b(await v.text()),d(void 0);return}ge.info(`Set ${K.RMP} with save id: ${l}`),He(K.RMP,await v.text()),s(Je(new Date().valueOf())),$e(),d(void 0)}s($())}},k=async l=>{if(!n||!l||!a)return;M(l);const v=await T(E.SAVES+"/"+i,{method:"DELETE"},a);if(v.status===401){b(t("Login status expired.")),M(void 0),s(I());return}if(v.status!==200){b(await v.text()),M(void 0);return}s($()),M(void 0)},V=async(l,v)=>{if(!n||!l||!a)return;const A=await T(`${E.SAVES}/${l}/metadata`,{method:"PATCH",body:JSON.stringify({index:v})},a);if(A.status===401){b(t("Login status expired.")),s(I());return}if(A.status!==200){b(await A.text());return}s($())};return e.jsxs(z,{children:[e.jsxs(B,{align:"center",children:[e.jsx(O,{order:3,size:"h5",flex:"1",children:t("Synced saves")}),e.jsx(w,{variant:"subtle",size:"xs",ml:"xs",disabled:!u,onClick:m,children:t(u?"Create":"Subscribe to sync more")})]}),e.jsx(te,{direction:"column",gap:"xs",children:r==null?void 0:r.map(l=>e.jsxs(J,{withBorder:!0,shadow:"sm",children:[e.jsxs(R,{children:[e.jsx(Ye,{initialValue:l.index,onSave:v=>V(l.id,v),textInputWidth:"207px"}),e.jsx(N,{disabled:x(l.id),loading:c===l.id,onClick:()=>p(l.id),title:l.id===i?t("Sync now"):t("Sync this slot"),children:l.id===i?e.jsx(ht,{}):e.jsx(pt,{})}),e.jsx(N,{color:"red",loading:S===l.id,onClick:()=>k(l.id),title:t("Delete"),children:e.jsx(gt,{})})]}),e.jsxs(R,{justify:"space-between",mt:"md",mb:"md",children:[e.jsxs(C,{children:[t("ID"),": ",l.id]}),e.jsxs(C,{children:[t("Status"),": ",l.id===i?t("Current save"):t("Cloud save")]})]}),e.jsxs(C,{children:[t("Last update at"),": ",new Date(l.lastUpdateAt).toLocaleString()]})]},l.id))})]})},Ee=["Tokyo","Paris","London","New York","Shanghai","Dubai","Sydney","Rio de Janeiro","Cairo","Moscow","Rome","Berlin","Madrid","Seoul","Singapore","Hong Kong","Beijing","Mexico City","Buenos Aires","Istanbul","Lagos","Jakarta","Osaka","Manila","Chongqing","Karachi","Dhaka","Lima","Bangkok","Lahore","Ho Chi Minh City","Shenzhen","Tianjin","Taipei","Bogota","Baghdad","Riyadh","Santiago","Guangzhou","Yangon","Johannesburg","Toronto","Montreal","Vancouver","Sao Paulo","Kuala Lumpur","Athens","Lisbon","Dublin","Amsterdam","Vienna","Prague","Budapest","Warsaw","Stockholm","Oslo","Helsinki","Copenhagen","Brussels","Geneva","Zurich","Barcelona","Milan","Florence","Venice","Munich","Hamburg","Frankfurt","Kyoto","Nairobi","Cape Town","Casablanca","Marrakesh","Accra","Addis Ababa","Alexandria","Ankara","Jerusalem","Tel Aviv","Beirut","Abu Dhabi","Doha","Kuwait City","Muscat","Amman","Baku","Tbilisi","Yerevan","Almaty","Tashkent","Kabul","Tehran","Damascus","Sana'a","Aden","Manama","Jeddah","Mecca","Medina","Salalah","Nicosia","Thessaloniki","Sofia","Bucharest","Belgrade","Zagreb","Sarajevo","Skopje","Tirana","Pristina","Podgorica","Ljubljana","Bratislava","Krakow","Gdansk","Wroclaw","Poznan","Vilnius","Riga","Tallinn","Reykjavik","Manchester","Birmingham","Glasgow","Edinburgh","Cardiff","Belfast","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Bordeaux","Lille","Cologne","Stuttgart","Dusseldorf","Dortmund","Essen","Leipzig","Dresden","Hanover","Nuremberg","Bremen","Rotterdam","The Hague","Utrecht","Eindhoven","Porto","Valencia","Seville","Zaragoza","Malaga","Murcia","Palma de Mallorca","Las Palmas de Gran Canaria","Antwerp","Ghent","Charleroi","Liège","Bern","Basel","Lausanne","Graz","Linz","Salzburg","Innsbruck","Naples","Turin","Palermo","Genoa","Bologna","Bari","Catania","Verona","Melbourne","Brisbane","Perth","Adelaide","Gold Coast","Canberra","Auckland","Wellington","Christchurch","Dunedin","Suva","Port Moresby","Noumea","Papeete","Honolulu","Quezon City","Davao City","Cebu City","Chiang Mai","Phuket","George Town","Ipoh","Johor Bahru","Surabaya","Bandung","Medan","Semarang","Santiago","Lima","Bogota","Caracas","Quito","La Paz","Sucre","Buenos Aires","Cordoba","Rosario","Mendoza","Valparaiso","Concepcion","Arequipa","Trujillo","Chiclayo","Piura","Medellin","Cali","Barranquilla","Cartagena","Maracaibo","Valencia","Barquisimeto","Ciudad Guayana","Guayaquil","Cuenca","Santo Domingo","Santa Cruz de la Sierra","Cochabamba","Guadalajara","Monterrey","Puebla","Tijuana","Leon","Juarez","Ecatepec","Zapopan","Nezahualcoyotl","Chihuahua","Naucalpan","Merida","Aguascalientes","San Luis Potosi","Hermosillo","Saltillo","Mexicali","Culiacan","Acapulco","Guadalupe","Cancun","Torreon","El Paso","Tucson","Phoenix","Los Angeles","San Diego","San Jose","San Francisco","Seattle","Portland","Las Vegas","Denver","Chicago","Houston","Dallas","San Antonio","Austin","Philadelphia","Washington D.C.","Boston","Miami","Atlanta","Orlando","Tampa","Detroit","Cleveland","Minneapolis","St. Louis","Kansas City","New Orleans","Charlotte","Nashville","Indianapolis","Columbus","Cincinnati","Pittsburgh","Milwaukee","Calgary","Edmonton","Winnipeg","Ottawa","Quebec City","Halifax","Chengdu","Wuhan","Hangzhou","Suzhou","Xian","Nanjing","Zhengzhou","Jinan","Qingdao","Hefei","Fuzhou","Xiamen","Ningbo","Wuxi","Kunming","Changsha","Nanchang","Shijiazhuang","Harbin","Changchun","Taiyuan","Urumqi","Lanzhou","Yinchuan","Xining","Guiyang","Lhasa","Hohhot","Nanning","Haikou","Sanya","Zhuhai","Foshan","Dongguan","Zhongshan","Shantou","Wenzhou","Jiaxing","Shaoxing","Taizhou","Jinhua","Quanzhou","Putian","Zhangzhou","Longyan","Sanming","Nanping","Yingtan","Shangrao","Jiujiang","Jingdezhen","Pingxiang","Xinyu","Yichun","Ganzhou","Qingyuan","Shaoguan","Heyuan","Meizhou","Shanwei","Yangjiang","Zhanjiang","Maoming","Zhaoqing","Yunfu","Laibin","Chongzuo","Hechi","Baise","Wuzhou","Fangchenggang","Qinzhou","Beihai","Guigang","Yulin","Cenxi","Dongxing","Anshan","Fushun","Jilin City","Qiqihar","Daqing","Mudanjiang","Jixi"],Bs=()=>{const t=Math.floor(Math.random()*Ee.length);return Ee[t]},Vs=t=>{const{t:s}=y(),{opened:n,onClose:a}=t,{isLoggedIn:o,token:i}=L(c=>c.account),r=P(),[g,u]=Q.useState(""),h=c=>r(F({title:s("Unable to redeem"),message:c,type:"error",duration:9e3})),x=async c=>{if(!o)return;const d=await T(E.SUBSCRIPTION_REDEEM,{method:"POST",body:JSON.stringify({cdkey:c.trim()})},i);if(d.status===401){h(s("Login status expired.")),r(I());return}if(d.status!==202){const S=(await d.json()).message;h(s(S));return}r(Jt()),a()};return e.jsxs(W,{opened:n,onClose:a,title:s("Redeem your subscription"),children:[e.jsx(C,{children:s("CDKey could be purchased in the following sites:")}),e.jsx(U,{withPadding:!0,mt:"xs",children:e.jsx(U.Item,{children:e.jsxs(we,{href:"https://afdian.com/item/9c8b220c614311efab2d52540025c377",target:"_blank",children:["爱发电 ",e.jsx(X,{})]})})}),e.jsxs(R,{align:"flex-end",gap:"sm",mt:"xs",children:[e.jsx(q,{label:"CDKey",placeholder:s("Enter your CDKey here"),value:g,onChange:({currentTarget:{value:c}})=>u(c),style:{minWidth:240}}),e.jsx(w,{onClick:()=>x(g),children:s("Redeem")})]})]})},Us=90,Ws=Us*24*60*60*1e3,Fs=()=>{const{t}=y(),{activeSubscriptions:s}=L(i=>i.account),[n,a]=Q.useState(!1),o=!s.RMP_CLOUD&&!s.RMP_EXPORT;return e.jsxs(z,{children:[e.jsxs(B,{align:"center",children:[e.jsx(O,{order:3,size:"h5",children:t("All subscriptions")}),e.jsx(w,{variant:"subtle",size:"xs",ml:"auto",onClick:()=>a(!0),children:t("Redeem")})]}),e.jsxs(te,{direction:"column",gap:"xs",children:[o&&e.jsxs(J,{withBorder:!0,shadow:"sm",children:[e.jsx(J.Section,{p:"xs",children:e.jsx(C,{fw:"bold",children:t("Rail Map Painter")})}),e.jsxs(_,{gap:"xs",children:[e.jsx(C,{children:t("With this subscription, the following features are unlocked:")}),e.jsxs(U,{withPadding:!0,children:[e.jsx(U.Item,{children:t("PRO features")}),e.jsx(U.Item,{children:t("Sync 9 more saves")}),e.jsx(U.Item,{children:t("Unlimited master nodes")}),e.jsx(U.Item,{children:t("Unlimited parallel lines")}),e.jsx(U.Item,{children:t("Random station names")})]}),e.jsxs(C,{children:[t("Expires at:")," ",t("Not applicable")]})]})]}),!o&&e.jsxs(J,{withBorder:!0,shadow:"sm",children:[e.jsx(J.Section,{p:"xs",children:e.jsx(C,{fw:"bold",children:t("Rail Map Painter")})}),e.jsxs(_,{gap:"xs",children:[e.jsxs(C,{children:[t("Expires at:")," ",new Date(s.RMP_CLOUD).toLocaleString()]}),e.jsx(w,{color:"blue",onClick:()=>a(!0),children:t("Renew")}),new Date(s.RMP_CLOUD).getTime()-new Date().getTime()<Ws&&e.jsx(Y,{title:t("Renew now and get an extra 45 days!"),color:"yellow",icon:e.jsx(Ve,{})})]})]})]}),e.jsx(Vs,{opened:n,onClose:()=>a(!1)})]})},Gs=()=>{const{t}=y(),{isLoggedIn:s}=L(o=>o.account),[n,a]=j.useState("login");return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:t("Account")})}),s?e.jsxs(te,{className:Ls.body,children:[e.jsx(Ts,{}),e.jsx(xe,{}),e.jsx(Fs,{}),e.jsx(zs,{})]}):n==="login"?e.jsx(_s,{setLoginState:a}):n==="register"?e.jsx(Is,{setLoginState:a}):e.jsx(Os,{setLoginState:a})]})},Hs="_button_1hzui_1",$s="_label_1hzui_11",Z={button:Hs,label:$s,"sub-label":"_sub-label_1hzui_17"};function Xe(){return xt("(min-width: 36em)")}function Js(t){var m;const{appId:s,onAboutOpen:n}=t,{t:a}=y(),o=P(),i=Xe(),{activeTab:r,openedTabs:g}=L(p=>p.app),u=ee[s],h=u.name.split(" - ").map(p=>a(p)).join(" - "),x=g.some(p=>p.app===s),c=!u.allowMultiInstances&&((m=g.find(p=>p.id===r))==null?void 0:m.app)===s,d=p=>{x||f.event(D.OPEN_APP,{appId:s,isOpenInNew:p}),o(p?Kt(s):je({appId:s})),i||(o(ie()),f.toggleNavMenu(!1))},S=p=>{o(qt(p)),i||(o(ie()),f.toggleNavMenu(!1))},M=p=>{o(Yt(p)),f.event(D.CLOSE_APP,{app:s})},b=p=>{o(Qt(p)),f.event(D.CLOSE_APP,{app:p})};return e.jsx(me,{component:"div",role:"button",variant:"filled",label:h,active:c,classNames:{root:Z.button,label:Z.label},leftSection:x?e.jsx(St,{title:a("Running")}):void 0,rightSection:e.jsxs(e.Fragment,{children:[u.allowMultiInstances&&e.jsx(N,{"aria-label":a("New tab"),title:a("New tab"),variant:"subtle",color:c?"white":"gray",mr:4,onClick:p=>{p.stopPropagation(),d(!0)},children:e.jsx(mt,{})}),e.jsxs(se,{children:[e.jsx(se.Target,{children:e.jsx(N,{variant:"subtle",color:c?"white":"gray",onClick:p=>p.stopPropagation(),children:e.jsx(jt,{})})}),e.jsxs(se.Dropdown,{children:[x&&e.jsx(se.Item,{leftSection:e.jsx(pe,{}),onClick:p=>{p.stopPropagation(),b(s)},children:u.allowMultiInstances?a("Close all tabs"):a("Close app")}),e.jsx(se.Item,{leftSection:e.jsx(ft,{}),onClick:p=>{p.stopPropagation(),n()},children:a("About")})]})]})]}),disableRightSectionRotation:!0,opened:!0,onClick:()=>d(!1),children:u.allowMultiInstances&&g.filter(p=>p.app===s).map((p,k)=>{const V=p.id===r;return e.jsx(me,{component:"div",role:"button",variant:"filled",active:V,label:e.jsxs(e.Fragment,{children:[e.jsx(Ue,{color:"lightgray",c:"black",mr:"xs",circle:!0,display:"inline-flex",children:k+1}),p.title??a("Tab")+" "+(k+1).toString()+" - "+h]}),classNames:{root:Z.button,label:Z["sub-label"]},rightSection:e.jsx(N,{variant:"subtle",color:V?"white":"gray","aria-label":a("Close tab"),title:a("Close tab"),onClick:l=>{l.stopPropagation(),M(p.id)},children:e.jsx(pe,{})}),onClick:()=>S(p.id)},p.id)})})}const Ks=async t=>{const s=`/${t}/info.json`;try{return(await(await fetch(s)).json()).version}catch(n){return ge.info(`Failed to get version of ${t}`,n),"unknown"}};function qs(t){var g,u,h;const{appId:s,onClose:n}=t,{t:a}=y(),[o,i]=j.useState("Unknown"),r=s?(h=(u=(g=ee[s])==null?void 0:g.url)==null?void 0:u.split("/"))==null?void 0:h[1]:void 0;return j.useEffect(()=>{r?Ks(r).then(x=>i(x)):i("Unknown")},[r]),e.jsx(W,{opened:!!s,onClose:n,size:"xl",title:e.jsxs(e.Fragment,{children:[a("About")+" "+(s?ee[s].name.split(" - ").map(x=>a(x)).join(" - "):""),e.jsx(Ue,{color:"gray",radius:"sm",ml:"xs",children:o})]}),children:e.jsx(w,{component:"a",href:"https://github.com/railmapgen/"+r,target:"_blank",children:a("Visit GitHub")})})}function Oe({assetType:t}){const{t:s}=y(),[n,a]=j.useState(),o=qe(t,f.getEnv(),f.getInstance());return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:s(t==="devtool"?"Devtools":"Apps")})}),e.jsx(ae,{direction:"column",children:o.map(i=>e.jsx(Js,{appId:i,onAboutOpen:()=>a(i)},i))}),e.jsx(qs,{appId:n,onClose:()=>a(void 0)})]})}function Ys(){const{t}=y(),s=qe("link",f.getEnv(),f.getInstance()),n=a=>{f.event(D.OPEN_LINK,{id:a})};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:t("Useful links")})}),e.jsx(ae,{direction:"column",children:s.map(a=>e.jsx(me,{variant:"filled",label:t(ee[a].name),classNames:{root:Z.button,label:Z.label},rightSection:e.jsx(X,{}),href:ee[a].url,target:"_blank",onClick:()=>n(a)},a))})]})}const Pe={"textarea-label":"_textarea-label_kau51_1","textarea-input":"_textarea-input_kau51_5"};function Qs(t){var u;const{opened:s,onClose:n}=t,{t:a}=y(),[o,i]=j.useState(),r=Object.entries(localStorage),g=()=>{o&&(window.localStorage.removeItem(o),window.location.reload())};return e.jsxs(W,{opened:s,onClose:n,size:"xl",title:a("Local Storage"),children:[e.jsx(_,{gap:"xs",children:r.map(h=>e.jsx(bt,{label:e.jsxs(R,{align:"center",gap:"xs",children:[h[0],e.jsx(N,{variant:"default",size:"xs",title:a("Remove this item"),"aria-label":a("Remove this item"),onClick:()=>i(h[0]),children:e.jsx(wt,{})})]}),value:h[1],readOnly:!0,rows:4,classNames:{label:Pe["textarea-label"],input:Pe["textarea-input"]}},h[0]))}),e.jsx(R,{pt:"xs",children:e.jsx(w,{ml:"auto",onClick:n,children:a("Go back")})}),o&&e.jsxs(W,{opened:!0,onClose:()=>i(void 0),centered:!0,title:a("Warning"),children:[e.jsxs(C,{children:[a("LocalStorageModal.text1"),e.jsx(Ct,{children:o}),a("LocalStorageModal.text2"),e.jsx(C,{span:!0,fw:500,children:a(((u=ee[o.split("__")[0]])==null?void 0:u.name)??"Unknown app")}),a("LocalStorageModal.text3"),e.jsx("br",{}),a("LocalStorageModal.text4")]}),e.jsxs(R,{gap:"xs",mt:"xs",children:[e.jsx(w,{variant:"default",ml:"auto",onClick:()=>i(void 0),children:a("Back")}),e.jsx(w,{color:"red",onClick:g,children:a("Delete and reload")})]})]})]})}function et(t){const{t:s}=y(),n=[{group:s("Main languages"),items:os.map(a=>({value:a,label:de[a][a]}))},{group:s("Other languages"),items:is.map(a=>({value:a,label:de[a][a]??de[a].en}))}];return e.jsx(yt,{label:s("Language"),defaultValue:f.getLanguage(),onChange:({currentTarget:{value:a}})=>{const o=a;f.setLanguage(o),f.getI18nInstance().changeLanguage(o),f.event(D.CHANGE_LANGUAGE,{language:o})},data:n,...t})}function Zs(){const{t}=y(),{setColorScheme:s}=vt(),n=P(),{lastShowDevtools:a,refreshRequired:o}=L(d=>d.app),[i,r]=j.useState(f.isAllowAnalytics()),[g,u]=j.useState(!1),h=Ke(a),x=d=>{r(d),f.allowAnalytics(d).refreshRequired&&n(es())},c=[{value:"light",label:t("Light")},{value:"dark",label:t("Dark")},{value:"system",label:t("System")}];return e.jsxs(z,{children:[o&&e.jsx(Y,{color:"blue",icon:e.jsx(be,{}),mb:"xs",children:t("Refreshing is required for changes to take effect.")}),e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:t("Settings")})}),e.jsxs(_,{gap:"xs",py:"xs",children:[e.jsx(et,{}),e.jsx(Mt,{size:"sm",label:t("Appearance"),defaultValue:f.getColourMode(),onChange:d=>{s(d==="system"?"auto":d),f.setColourMode(d)},data:c}),e.jsx(Me,{label:t("Allow cookies to help improve our website"),labelPosition:"left",checked:i,onChange:({currentTarget:{checked:d}})=>x(d),disabled:o,styles:{labelWrapper:{flex:1}}}),e.jsx(Me,{label:t("Show dev tools for 1 day"),labelPosition:"left",checked:h,onChange:({currentTarget:{checked:d}})=>{d?(n(Zt()),f.event(D.SHOW_DEVTOOLS)):n(Xt())},styles:{labelWrapper:{flex:1}}}),h&&e.jsx(w,{variant:"default",leftSection:e.jsx(kt,{}),onClick:()=>u(!0),children:t("Export Local Storage")})]}),h&&e.jsx(Qs,{opened:g,onClose:()=>u(!1)})]})}function Xs(){const{t}=y(),{remoteFonts:s}=L(n=>n.app);return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:t("Web fonts")})}),e.jsxs(_,{gap:"xs",children:[e.jsxs(C,{fs:"italic",children:[t("FontsSection.text1")," ",t("FontsSection.text2")," ",t("FontsSection.text3")," (",t("FontsSection.safari"),")"]}),Object.entries(s).map(([n,a])=>e.jsx(w,{variant:"default",rightSection:a.url?e.jsx(X,{}):void 0,disabled:!a.url,onClick:()=>{window.open(a.url,"_blank"),f.event(D.DOWNLOAD_FONT,{family:n})},children:a.displayName?`${a.displayName} (${n})`:n},n))]})]})}const ea="_bilibili_5ep1h_1",ta={bilibili:ea};function sa(t){return We({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9a17.56 17.56 0 0 0 3.8.4c8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1a102.4 102.4 0 0 1-22.6 2.7c-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1a63 63 0 0 0 25.6-6c2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8a18.64 18.64 0 0 1 5-.5c8.1 0 26.4 3.1 56.6 24.1a208.21 208.21 0 0 1 112.2 0c30.2-21 48.5-24.1 56.6-24.1a18.64 18.64 0 0 1 5 .5c12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5a19.35 19.35 0 0 0 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"},child:[]}]})(t)}function aa(t){return We({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M126.12 315.1A47.06 47.06 0 1 1 79.06 268h47.06zm23.72 0a47.06 47.06 0 0 1 94.12 0v117.84a47.06 47.06 0 1 1-94.12 0zm47.06-188.98A47.06 47.06 0 1 1 244 79.06v47.06zm0 23.72a47.06 47.06 0 0 1 0 94.12H79.06a47.06 47.06 0 0 1 0-94.12zm188.98 47.06a47.06 47.06 0 1 1 47.06 47.1h-47.06zm-23.72 0a47.06 47.06 0 0 1-94.12 0V79.06a47.06 47.06 0 1 1 94.12 0zM315.1 385.88a47.06 47.06 0 1 1-47.1 47.06v-47.06zm0-23.72a47.06 47.06 0 0 1 0-94.12h117.84a47.06 47.06 0 1 1 0 94.12z"},child:[]}]})(t)}function na(){const{t}=y();return e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(O,{order:2,size:"h4",children:t("Help & support")})}),e.jsxs(_,{gap:"xs",children:[e.jsx(w,{variant:"default",leftSection:e.jsx(sa,{}),rightSection:e.jsx(X,{}),onClick:()=>{window.open("https://github.com/railmapgen/railmapgen.github.io/issues","_blank"),f.event(D.RAISE_ISSUE)},children:t("Raise an Issue on GitHub")}),e.jsx(w,{variant:"default",leftSection:e.jsx(aa,{}),rightSection:e.jsx(X,{}),onClick:()=>{window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),f.event(D.JOIN_SLACK)},children:t("Join us on Slack")}),e.jsx(w,{variant:"default",leftSection:e.jsx(he,{className:ta.bilibili,src:"images/bilibili.svg"}),rightSection:e.jsx(X,{}),onClick:()=>{window.open("https://space.bilibili.com/10124055","_blank"),f.event(D.FOLLOW_BILIBILI)},children:t("Follow us on Bilibili")})]})]})}function oa(){const{t}=y(),{isShowMenu:s,menuView:n,lastShowDevtools:a}=L(c=>c.app),{isLoggedIn:o,name:i}=L(c=>c.account),r=P(),g=Xe(),[u]=Fe(),h=(f.getInstance()==="GitLab"?"https://railmapgen.gitlab.io/":"https://railmapgen.github.io/")+"?"+u.toString();j.useEffect(()=>{o&&r($())},[o]);const x=[{key:"apps",label:t("Apps"),Icon:e.jsx(At,{size:22})},{key:"links",label:t("Useful links"),Icon:e.jsx(Lt,{size:22})},{key:"devtools",label:t("Devtools"),Icon:e.jsx(Rt,{size:22}),ActionIconProps:{style:{display:Ke(a)?"inline-flex":"none"}}},{key:"account",label:t("Account"),Icon:e.jsx(ze,{variant:"light",name:o?i:void 0,size:"sm",color:"initials"}),ActionIconProps:{mt:"auto"}},{key:"contributors",label:t("Contributors"),Icon:e.jsx(Tt,{size:22}),ActionIconProps:{onClick:()=>{r(ts("contributors")),g||(r(ie()),f.toggleNavMenu(!1))}}},{key:"support",label:t("Help & support"),Icon:e.jsx(Et,{size:22})},{key:"settings",label:t("Settings"),Icon:e.jsx(Ot,{size:22})}];return e.jsx("nav",{className:Ie(G.root,s&&G["show-menu"]),children:e.jsxs("div",{className:G.wrapper,children:[e.jsxs(Pt,{className:G.header,children:[e.jsx(O,{children:t("Rail Map Toolkit")}),e.jsx(_t,{env:f.getEnv(),ver:f.getAppVersion()})]}),e.jsx(xe,{}),f.getEnv()!=="PRD"&&e.jsxs(Y,{color:"yellow",icon:e.jsx(Ve,{}),className:G.alert,children:[t("You're currently viewing a testing environment.")," ",e.jsx(we,{size:"sm",href:h,target:"_blank",children:t("Back to production environment")})]}),e.jsxs("div",{className:G.body,children:[e.jsx("div",{className:G.aside,children:x.map(({key:c,label:d,Icon:S,ActionIconProps:M})=>e.jsx(It,{label:d,position:"right",withArrow:!0,children:e.jsx(N,{variant:n===c?"light":"subtle",color:n===c?void 0:"gray",size:"lg",onClick:()=>r(ss(c)),...M,children:S})},c))}),e.jsx(xe,{orientation:"vertical"}),e.jsxs("div",{className:G.main,children:[n==="apps"?e.jsx(Oe,{assetType:"app"}):n==="links"?e.jsx(Ys,{}):n==="devtools"?e.jsx(Oe,{assetType:"devtool"}):n==="settings"?e.jsx(Zs,{}):n==="support"?e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsx(Xs,{})]}):n==="account"?e.jsx(Gs,{}):e.jsx(e.Fragment,{}),e.jsx(ks,{})]})]})]})})}function ia(t){const{opened:s,onClose:n}=t,{t:a}=y(),o=()=>{f.allowAnalytics(!0),n()},i=()=>{f.allowAnalytics(!1).refreshRequired?window.location.reload():n()};return e.jsxs(W,{opened:s,onClose:()=>{},title:a("CookiesModal.header"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:[e.jsx(R,{children:e.jsx(et,{ml:"auto"})}),e.jsxs(_,{gap:"xs",py:"xs",children:[e.jsx(C,{children:a("CookiesModal.text1")}),e.jsx(C,{mt:2,children:a("CookiesModal.text2")}),e.jsx(U,{withPadding:!0,children:e.jsxs(U.Item,{children:[" ",a("CookiesModal.item1")]})}),e.jsx(C,{mt:2,children:a("CookiesModal.text3")})]}),e.jsxs(R,{gap:"sm",children:[e.jsx(w,{variant:"default",ml:"auto",onClick:i,children:a("CookiesModal.reject")}),e.jsx(w,{onClick:o,children:a("CookiesModal.accept")})]})]})}const la=()=>{};function ra(){const{t}=y(),[s,n]=j.useState(!1),a=()=>{n(!0),as(),setTimeout(()=>{window.location.reload()},1e3)};return e.jsxs(W,{opened:!0,onClose:la,title:t("Rail Map Toolkit is opened in another window"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:[e.jsx(C,{children:t("You cannot open multiple Rail Map Toolkit at the same time. Please close this window.")}),e.jsx(R,{mt:"xs",children:e.jsx(w,{variant:"default",onClick:a,loading:s,disabled:s,children:t("Restart RMT in this window")})})]})}const ca=()=>{};function da(){const{t}=y();return e.jsx(W,{opened:!0,onClose:ca,title:t("Rail Map Toolkit is opened in another window"),withCloseButton:!1,closeOnEscape:!1,closeOnClickOutside:!1,centered:!0,children:e.jsx(C,{children:t("Current session has been terminated. Please close this window.")})})}const ua="_root_nos1z_1",ha={root:ua},pa={info:void 0,success:"green",warning:"yellow",error:"red"},ue=200,_e=400;function ga({notification:t}){const s=P(),[n,a]=j.useState(!1);return j.useEffect(()=>{setTimeout(()=>{a(!0)},ue);const o=setTimeout(()=>{a(!1)},ue+t.duration);return setTimeout(()=>{s(ns(t.id))},ue+t.duration+_e),()=>{clearTimeout(o)}},[]),e.jsx(Nt,{mounted:n,transition:"slide-left",duration:_e,timingFunction:"ease",children:o=>e.jsx(Dt,{color:pa[t.type],title:t.title,onClose:()=>a(!1),withBorder:!0,style:o,children:t.message})})}function xa(){const{notifications:t}=L(s=>s.notification);return e.jsx(zt,{children:e.jsx(_,{className:ha.root,children:t.map(s=>e.jsx(ga,{notification:s},s.id))})})}function Ca(){const{t}=y(),s=P(),{isPrimary:n,isTerminated:a,isShowMenu:o}=L(u=>u.app),[i,r]=j.useState(!1);j.useEffect(()=>{f.isAnalyticsQADone()||r(!0)},[]);const g=()=>{f.toggleNavMenu(!o),s(ie()),f.event(D.TOGGLE_NAV_MENU)};return e.jsx(Wt,{basename:"/",children:e.jsxs(Bt,{className:o?"show-menu":"",children:[e.jsx(N,{className:rs.burger,variant:o?"subtle":"filled",color:o?"gray":void 0,"aria-label":t("Toggle menu"),title:t("Toggle menu"),onClick:g,children:e.jsx(Vt,{})}),e.jsxs(Ut,{direction:"row",children:[e.jsx(oa,{}),e.jsx(ms,{alwaysShowWelcome:a||n===!1})]}),e.jsx(xa,{}),a&&e.jsx(da,{}),n===!1&&e.jsx(ra,{}),e.jsx(ia,{opened:i,onClose:()=>r(!1)})]})})}export{Ca as default};
