import{a1 as ze,H as e,a as ke,F as v,ao as we,ap as he,aq as F,ar as ne,as as z,_ as f,B as _,at as b,ac as Me,ak as Ce,au as te,a0 as j,ad as I,av as He,aw as ye,ax as Se,ay as se,L as de,az as C,U as L,aA as H,X as y,Y as q,Z as S,$ as A,aB as N,aC as D,aD as G,W as Y,g as Q,a4 as T,a5 as E,D as Ae,aE as Re,aF as R,a3 as V,a7 as Ie,aG as De,aH as _e}from"./chakra-wsdJ9xX1.js";import{r as p,l as m,m as ue,B as Le}from"./react-Ee-ZCU_z.js";import{R as Te,a as Ee,b as Oe,c as Pe,d as Be,F as Ne,u as Z,e as pe,f as M,r as u,E as w,o as Ge,g as $e,t as U,s as We,h as Ve,i as Ue,j as Fe,k as qe,m as Ye,l as Qe,n as O,p as P,q as ge,v as Ze,w as Je,x as $,y as Ke}from"./index-2LyeDGuu.js";var Xe=["en","zh-Hans","zh-Hant"],en=["ja","ko"],ae={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}},nn=function(n){var t=n.children,i=n.noWrap,s=ze("RmgOutput",{noWrap:i});return e.jsx(ke.output,{sx:s,children:t})};function xe(n){var t=n.fields,i=n.noLabel,s=n.minW;return e.jsx(v,{wrap:"wrap",children:t.map(function(o,c){if(o.hidden)return e.jsx(p.Fragment,{},c);var r=o.minW||s,h=r==="full";return e.jsx(Te,{className:h?"mw-full":"",label:o.label,flex:h?void 0:1,minW:h?void 0:r,noLabel:i,oneLine:o.oneLine,children:function(a){switch(a.type){case"input":return e.jsx(Be,{placeholder:a.placeholder,defaultValue:a.value,type:a.variant,validator:a.validator,onDebouncedChange:a.onChange,delay:a.debouncedDelay,optionList:a.optionList,isDisabled:a.isDisabled});case"output":return e.jsx(nn,{noWrap:!0,children:a.value});case"textarea":return e.jsx(Pe,{placeholder:a.placeholder,defaultValue:a.value,onDebouncedChange:a.onChange,isDisabled:a.isDisabled});case"slider":return e.jsx(Oe,{defaultValue:a.value,min:a.min,max:a.max,step:a.step,onThrottledChange:a.onChange,leftIcon:a.leftIcon,rightIcon:a.rightIcon,isDisabled:a.isDisabled});case"select":return e.jsx(Ee,{defaultValue:a.value,onChange:function(l){var d,x=l.target.value;return(d=a.onChange)===null||d===void 0?void 0:d.call(a,typeof a.value=="number"?Number(x):x.toString())},options:a.options,disabledOptions:a.disabledOptions,isInvalid:a.isInvalid,isDisabled:a.isDisabled});case"switch":return e.jsx(we,{isChecked:a.isChecked,isDisabled:a.isDisabled,onChange:function(l){var d,x=l.target.checked;return(d=a.onChange)===null||d===void 0?void 0:d.call(a,x)}});case"custom":return a.component;default:return e.jsx("div",{})}}(o)},c)})})}const tn="/assets/rmp-logo512-Hh3pLqZ3.png",sn={flex:1,justifyContent:"center",mb:10,"& > div":{mb:3},"& img":{w:120,p:2,backgroundColor:"white",borderRadius:12}};function an(){const{t:n}=m();return e.jsxs(he,{sx:sn,children:[e.jsxs(F,{spacing:3,children:[e.jsx(ne,{src:"/logo512.png"}),e.jsx(ne,{src:tn,backgroundColor:"white"})]}),e.jsx(z,{children:n("Welcome to Rail Map Toolkit")}),e.jsx(f,{fontSize:"lg",textAlign:"center",children:n("Select an app to start your own rail map design!")})]})}function on(n){var o;const{tab:t,isActive:i}=n,[s]=p.useState((o=t.url)!=null?o:"/"+t.app+"/");return e.jsx(_,{display:i?"block":"none",flex:1,children:e.jsx("iframe",{id:Ne+t.id,src:s,loading:"lazy",title:t.app,width:"100%",height:"100%"})})}function rn(){const{openedTabs:n,activeTab:t}=Z(o=>o.app),[i,s]=ue();return p.useEffect(()=>{var o;if(t){const c=(o=n.find(r=>r.id===t))==null?void 0:o.app;s(c?{app:c}:{})}else s({})},[t]),n.length===0?e.jsx(an,{}):e.jsx(e.Fragment,{children:n.map(o=>e.jsx(on,{tab:o,isActive:t===o.id},o.id))})}function ln(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},child:[]}]})(n)}function oe(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"},child:[]}]})(n)}function cn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v2h-2V7zm0 4h2v6h-2v-6z"},child:[]}]})(n)}function hn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(n)}function dn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"},child:[]}]})(n)}function ie(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(n)}function un(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(n)}function pn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(n)}function gn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"},child:[]}]})(n)}function xn(n){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3 1 9l11 6 9-4.91V17h2V9L12 3z"},child:[]}]})(n)}const re={"& button:first-of-type":{w:"100%",overflow:"hidden",justifyContent:"flex-start",textOverflow:"ellipsis",textAlign:"start","& span.chakra-button__icon":{ml:-1,color:"orange.300",'[data-theme="dark"] &':{color:"orange.200"}}},'&[aria-current="true"] > button':{bg:"primary.50",_hover:{bg:"primary.100"},'[data-theme="dark"] &':{bg:"primary.700",_hover:{bg:"primary.600"}}}};function mn(n){var K;const{appId:t,onAboutOpen:i}=n,{t:s}=m(),o=pe(),c=Me("(min-width: ".concat(Ce.breakpoints.sm,")")),{activeTab:r,openedTabs:h}=Z(g=>g.app),a=M[t],l=a.name.split(" - ").map(g=>s(g)).join(" - "),d=h.some(g=>g.app===t),x=!a.allowMultiInstances&&((K=h.find(g=>g.id===r))==null?void 0:K.app)===t,k=g=>{d||u.event(w.OPEN_APP,{appId:t,isOpenInNew:g}),o(g?Ge(t):$e({appId:t})),c[0]||(o(U()),u.toggleNavMenu(!1))},B=g=>{o(We(g)),c[0]||(o(U()),u.toggleNavMenu(!1))},ve=g=>{o(Ve(g)),u.event(w.CLOSE_APP,{app:t})},be=g=>{o(Ue(g)),u.event(w.CLOSE_APP,{app:g})};return e.jsxs(e.Fragment,{children:[e.jsxs(te,{variant:x?"solid":"ghost",size:"md",isAttached:!0,"aria-current":x,sx:re,children:[e.jsx(j,{onClick:()=>k(!1),leftIcon:d?e.jsx(dn,{title:s("Running")}):e.jsx(_,{w:4}),children:l}),a.allowMultiInstances&&e.jsx(I,{"aria-label":s("New tab"),title:s("New tab"),icon:e.jsx(hn,{}),onClick:()=>k(!0)}),e.jsxs(He,{children:[e.jsx(ye,{as:I,icon:e.jsx(pn,{}),"aria-label":s("More"),title:s("More")}),e.jsxs(Se,{children:[d&&e.jsx(se,{icon:e.jsx(ie,{}),onClick:()=>be(t),children:a.allowMultiInstances?s("Close all tabs"):s("Close app")}),e.jsx(se,{icon:e.jsx(ln,{}),onClick:i,children:s("About")})]})]})]}),a.allowMultiInstances&&h.filter(g=>g.app===t).map((g,X)=>{const ee=g.id===r;return e.jsxs(te,{variant:ee?"solid":"ghost",size:"sm",ml:8,mr:1,isAttached:!0,"aria-current":ee,sx:re,children:[e.jsxs(j,{onClick:()=>B(g.id),children:[e.jsx(de,{mr:2,children:X+1}),s("Tab")+" "+(X+1).toString()+" - "+l]}),e.jsx(I,{"aria-label":s("Close tab"),title:s("Close tab"),icon:e.jsx(ie,{}),onClick:()=>ve(g.id)})]},g.id)})]})}const jn=async n=>{const t="/".concat(n,"/info.json");try{return(await(await fetch(t)).json()).version}catch(i){return console.log("Failed to get version for ".concat(n)),"unknown"}},fn=async(n,t)=>{const i="/".concat(n,"/legacy-contributor-list.txt");return(await(await fetch(i,{signal:t})).text()).split("\n")};function vn(n){var h,a,l;const{appId:t,onClose:i}=n,{t:s}=m(),[o,c]=p.useState("Unknown"),r=t?(l=(a=(h=M[t])==null?void 0:h.url)==null?void 0:a.split("/"))==null?void 0:l[1]:void 0;return p.useEffect(()=>{r?jn(r).then(d=>c(d)):c("Unknown")},[r]),e.jsxs(C,{isOpen:!!t,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsxs(y,{children:[s("About")+" "+(t?M[t].name.split(" - ").map(d=>s(d)).join(" - "):""),e.jsx(de,{ml:1,children:o})]}),e.jsx(q,{}),e.jsx(S,{}),e.jsx(A,{children:e.jsx(j,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/"+r,"_blank"),children:s("Visit GitHub")})})]})]})}const bn={flexDirection:"column","& h4":{mx:3,my:2},"& > div":{flexDirection:"column"}};function zn(){const{t:n}=m(),[t,i]=p.useState(),s=Fe(u.getEnv());return e.jsxs(v,{sx:bn,children:[e.jsx(z,{as:"h4",size:"md",children:n("Apps")}),e.jsx(v,{children:s.map(o=>e.jsx(mn,{appId:o,onAboutOpen:()=>i(o)},o))}),e.jsx(vn,{appId:t,onClose:()=>i(void 0)})]})}const kn={flexDirection:"column",py:1,"& h4":{mx:3,my:2},"& > div":{px:2},"& .chakra-stack > button":{flex:1}};function wn(){const{t:n}=m(),{setColourMode:t}=qe(),i={light:n("Light"),dark:n("Dark"),system:n("System")},o=u.getInstance()==="GitHub"?"GitLab":"GitHub",c=()=>{const a=Qe(o,u.getEnv());window.open(a,"_blank"),u.event(w.SWITCH_MIRROR,{mirrorUrl:a})},r=()=>{const a=new Date,l="".concat(a.getFullYear()).concat(String(a.getMonth()+1).padStart(2,"0"),"01"),d="".concat(String(a.getFullYear()).slice(-2),".").concat(a.getMonth()+1,".1"),x=navigator.platform,k=x.includes("Linux")?"amd64.deb":x.includes("Mac")?"x64.dmg":"x64-setup.exe",B="https://mirror.ghproxy.com/https://github.com/railmapgen/railmapgen.github.io/releases/download/tauri-".concat(l,"/railmapgen_").concat(d,"_").concat(k);window.open(B,"_blank"),u.event(w.DOWNLOAD_APP,{})},h=[{type:"select",label:n("Language"),value:u.getLanguage(),options:{[n("Main languages")]:Xe.reduce((a,l)=>({...a,[l]:ae[l][l]}),{}),[n("Other languages")]:en.reduce((a,l)=>({...a,[l]:ae[l][l]}),{})},onChange:a=>{const l=a;u.setLanguage(l),u.getI18nInstance().changeLanguage(l),u.event(w.CHANGE_LANGUAGE,{language:l})}},{type:"select",label:n("Appearance"),value:u.getColourMode(),options:i,onChange:a=>t(a)}];return e.jsxs(v,{sx:kn,children:[e.jsx(z,{as:"h4",size:"md",children:n("Settings")}),e.jsxs(_,{children:[e.jsx(xe,{fields:h}),e.jsxs(F,{children:[e.jsx(j,{variant:"outline",size:"xs",rightIcon:e.jsx(oe,{}),onClick:c,children:n("Switch to")+" "+Ye[o]}),e.jsx(j,{variant:"outline",size:"xs",rightIcon:e.jsx(oe,{}),onClick:r,children:n("Download offline app")})]})]})]})}const Mn={"& > span":{minW:"75%",borderRadius:"lg",cursor:"pointer","& > span:last-of-type":{display:"block"},"& p":{fontSize:"sm","&:first-of-type":{fontSize:"lg",fontWeight:"bold",mb:1}}},"& .chakra-avatar":{ml:1,mr:3,my:4}};function Cn(){const{t:n}=m();return e.jsxs(O,{children:[e.jsx(P,{children:e.jsx(z,{as:"h5",size:"sm",children:n("Developer team")})}),e.jsxs(he,{sx:Mn,children:[e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/wongchito","_blank"),children:[e.jsx(D,{src:"https://github.com/wongchito.png",size:"lg"}),e.jsxs(G,{children:[e.jsx(f,{children:"Chito Wong"}),e.jsx(f,{children:"Author of Rail Map Toolkit platform"}),e.jsx(f,{children:"Author of Rail Map Generator"})]})]}),e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),children:[e.jsx(D,{src:"https://github.com/thekingofcity.png",size:"lg"}),e.jsxs(G,{children:[e.jsx(f,{children:"thekingofcity"}),e.jsx(f,{children:"Author of Rail Map Painter"}),e.jsx(f,{children:"Author of RMG (Shanghai Metro style)"})]})]}),e.jsxs(N,{size:"lg",onClick:()=>window.open("https://github.com/langonginc","_blank"),children:[e.jsx(D,{src:"https://github.com/langonginc.png",size:"lg"}),e.jsxs(G,{children:[e.jsx(f,{children:"5+1"}),e.jsx(f,{children:"Author of RMP2RMG conversion"})]})]})]})]})}function J(n){const{login:t,urlRepo:i,...s}=n,o=i?"https://github.com/railmapgen/".concat(i,"/issues?q=is:issue+author:").concat(t):"https://github.com/".concat(t);return e.jsx(D,{name:t,title:t,src:"https://github.com/".concat(t,".png"),loading:"lazy",onClick:()=>window.open(o,"_blank"),cursor:"pointer",...s})}const Hn=["52PD","linchen1965","28yfang","Windows-Taskmgr"];function yn(){const{t:n}=m();return e.jsxs(O,{children:[e.jsx(P,{children:e.jsx(z,{as:"h5",size:"sm",children:n("Resource administrators")})}),e.jsx(Y,{spacing:1.5,px:2,children:Hn.map(t=>e.jsx(Q,{children:e.jsx(J,{login:t,size:"md"})},t))})]})}const me="https://api.github.com/repos/railmapgen",W={},je=async(n,t)=>{if(n in W)return W[n];const s=await(await fetch(n,t)).json();return W[n]=s,s},Sn=async(n,t,i)=>{const s="".concat(me,"/").concat(n,"/contributors"),o=new URLSearchParams({per_page:"100",page:t.toString()});return(await je(s+"?"+o.toString(),{signal:i})).map(r=>r.login)},An=async(n,t,i)=>{const s="".concat(me,"/").concat(n,"/issues"),o=new URLSearchParams({state:"closed",labels:"donation",per_page:"100",page:t.toString()});return(await je(s+"?"+o.toString(),{signal:i})).filter(r=>r.state_reason==="completed").map(r=>{var h;return(h=r.user)==null?void 0:h.login})};function fe(n){const[t,i]=p.useState(n!=null?n:[]);return[t,o=>{i(c=>{const r=new Set(c?c.concat(o):o);return Array.from(r)})}]}const Rn=["","wongchito","thekingofcity","github-actions[bot]"],le=n=>!Rn.includes(n);function In(n){const[t,i]=fe(),[s,o]=p.useState(!0),[c,r]=p.useState(!1),h=p.useRef(),a=async()=>{var d;let l=1;for(;;){h.current=new AbortController;const x=await Sn(n,l,(d=h.current)==null?void 0:d.signal);if(i(x.filter(le)),x.length<100)break;l++}};return p.useEffect(()=>(a().then(()=>{var l;return M[n].legacyContributors?(h.current=new AbortController,fn(n,(l=h.current)==null?void 0:l.signal)):[]}).then(l=>i(l.filter(le))).catch(l=>{console.error("[rmt] unable to fetch contributors for:",n,l),r(!0)}).finally(()=>o(!1)),()=>{var l;(l=h.current)==null||l.abort(),o(!0),r(!1)}),[n]),{contributors:t,isLoading:s,isError:c}}const Dn={position:"relative",minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function _n(n){const{appId:t}=n,{t:i}=m(),{contributors:s,isLoading:o,isError:c}=In(t);return e.jsxs(v,{sx:Dn,children:[o&&e.jsx(ge,{isIndeterminate:!0}),c&&e.jsxs(T,{status:"warning",children:[e.jsx(E,{}),i("Unable to load contributors")]}),!c&&s&&e.jsx(Y,{spacing:1.5,children:s==null?void 0:s.map(r=>e.jsx(Q,{children:e.jsx(J,{login:r,urlRepo:t,size:"sm"})},r))})]})}const Ln={"& > *:not(.rmg-section__header)":{px:2},"& h6":{my:2}};function Tn(){const{t:n}=m();return e.jsxs(O,{sx:Ln,children:[e.jsx(P,{children:e.jsx(z,{as:"h5",size:"sm",children:n("Resource contributors")})}),Object.entries(M).filter(([t,i])=>i.showContributors).map(([t,i])=>e.jsxs(p.Fragment,{children:[e.jsx(z,{as:"h6",size:"xs",children:n(i.name)}),e.jsx(_n,{appId:t},t)]},t)),e.jsx(f,{as:"i",fontSize:"xs",mt:3,children:n("Notes: Contributors are sorted by number of commits and commit time.")})]})}function En(){const[n,t]=fe(),[i,s]=p.useState(!0),[o,c]=p.useState(!1),r=p.useRef(),h=async()=>{var l;const a=Object.entries(M).filter(([d,x])=>x.showDonators).map(([d])=>d);for(const d of a)try{let x=1;for(;;){r.current=new AbortController;const k=await An(d,x,(l=r.current)==null?void 0:l.signal);if(t(k),k.length<100)break;x++}}catch(x){throw console.error("[rmt] unable to fetch donators for:",d,x),x}};return p.useEffect(()=>(h().catch(()=>c(!0)).finally(()=>s(!1)),()=>{var a;(a=r.current)==null||a.abort(),s(!0),c(!1)}),[]),{donators:n,isLoading:i,isError:o}}const On={position:"relative",px:2,minH:20,"& .chakra-alert":{flexDirection:"column"},"& .chakra-alert__icon":{boxSize:7,mr:0,mb:1}};function Pn(){const{t:n}=m(),{donators:t,isLoading:i,isError:s}=En();return e.jsxs(O,{children:[e.jsx(P,{children:e.jsx(z,{as:"h5",size:"sm",children:"❤️ "+n("Donators")})}),e.jsxs(v,{sx:On,children:[i&&e.jsx(ge,{isIndeterminate:!0}),s&&e.jsxs(T,{status:"warning",children:[e.jsx(E,{}),n("Unable to load donators")]}),!s&&t&&e.jsx(Y,{spacing:1.5,children:t==null?void 0:t.map(o=>e.jsx(Q,{children:e.jsx(J,{login:o,size:"sm"})},o))})]})]})}const Bn={bg:"inherit",py:0,"& section:not(:last-of-type)":{mb:4}};function Nn(n){const{isOpen:t,onClose:i}=n,{t:s}=m();return e.jsxs(C,{isOpen:t,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsx(y,{children:s("Contributors")}),e.jsx(q,{}),e.jsxs(S,{sx:Bn,children:[e.jsx(Cn,{}),e.jsx(Pn,{}),e.jsx(yn,{}),e.jsx(Tn,{})]}),e.jsx(A,{children:e.jsx(j,{colorScheme:"primary",onClick:()=>window.open("https://github.com/railmapgen/rmg/wiki/How-to-add-color-palette-and-line-templates","_blank"),children:s("Contribution Wiki")})})]})]})}function Gn(n){const{isOpen:t,onClose:i}=n,{t:s}=m(),[o,c]=p.useState(u.isAllowAnalytics()),[r,h]=p.useState();p.useEffect(()=>{t||h(void 0)},[t]);const a=[{type:"switch",label:s("Allow cookies to help improve our website"),isChecked:o,onChange:c,oneLine:!0}],l=()=>{u.allowAnalytics(o).refreshRequired?h("Refreshing is required for changes to take effect."):i()};return e.jsxs(C,{isOpen:t,onClose:i,children:[e.jsx(L,{}),e.jsxs(H,{children:[r&&e.jsxs(T,{status:"info",variant:"solid",size:"xs",children:[e.jsx(E,{}),s(r)]}),e.jsxs(_,{position:"relative",children:[e.jsx(y,{children:s("Privacy settings")}),e.jsx(q,{})]}),e.jsx(S,{children:e.jsx(xe,{fields:a})}),e.jsx(A,{children:e.jsx(j,{colorScheme:"primary",isDisabled:!!r,onClick:l,children:s("Save")})})]})]})}function $n(n){return b({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M126.12 315.1A47.06 47.06 0 1 1 79.06 268h47.06zm23.72 0a47.06 47.06 0 0 1 94.12 0v117.84a47.06 47.06 0 1 1-94.12 0zm47.06-188.98A47.06 47.06 0 1 1 244 79.06v47.06zm0 23.72a47.06 47.06 0 0 1 0 94.12H79.06a47.06 47.06 0 0 1 0-94.12zm188.98 47.06a47.06 47.06 0 1 1 47.06 47.1h-47.06zm-23.72 0a47.06 47.06 0 0 1-94.12 0V79.06a47.06 47.06 0 1 1 94.12 0zM315.1 385.88a47.06 47.06 0 1 1-47.1 47.06v-47.06zm0-23.72a47.06 47.06 0 0 1 0-94.12h117.84a47.06 47.06 0 1 1 0 94.12z"},child:[]}]})(n)}function Wn(){const{t:n}=m(),[t,i]=p.useState(!1),[s,o]=p.useState(!1);return e.jsxs(v,{direction:"column",children:[e.jsx(Ae,{}),e.jsxs(Re,{templateColumns:"repeat(4, auto)",children:[e.jsx(R,{children:e.jsx(j,{as:V,variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx($n,{}),target:"_blank",href:"https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A",children:"Slack"})}),e.jsx(R,{children:e.jsx(j,{variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(gn,{}),onClick:()=>i(!0),children:n("Contributors")})}),e.jsx(R,{children:e.jsx(j,{variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(cn,{}),onClick:()=>o(!0),children:n("Privacy")})}),e.jsx(R,{children:e.jsx(j,{as:V,variant:"ghost",size:"sm",w:"100%",leftIcon:e.jsx(xn,{}),target:"_blank",href:"https://rmttutorial.wordpress.com",children:n("Tutorial")})})]}),e.jsx(Nn,{isOpen:t,onClose:()=>i(!1)}),e.jsx(Gn,{isOpen:s,onClose:()=>o(!1)})]})}const ce=420,Vn={flexShrink:0,flexDirection:"column",overflow:"hidden",alignItems:"flex-end",transition:"0.3s ease-in-out",maxW:0,visibility:"hidden",boxShadow:"lg",zIndex:100,".show-menu &":{maxW:{base:"100%",md:ce},w:{base:"100%",md:"unset"},visibility:"initial"},"& > div":{flexDirection:"column",h:"100%",w:{base:"100vw",md:ce},"& .nav-menu__header":{flex:0,flexDirection:"row",alignItems:"center",minHeight:10,pl:12},"& .nav-menu__body":{flexDirection:"column",flex:1,overflow:"hidden","& > div:first-of-type":{flex:1,overflowY:"auto"}}},"& .chakra-alert":{flexGrow:0,pl:3,pr:2,py:2,"& a":{fontWeight:"bold",textDecoration:"underline","&:hover, &:focus":{textDecoration:"none"}}}};function Un(){const{t:n}=m(),[t]=ue(),i=(u.getInstance()==="GitLab"?"https://railmapgen.gitlab.io/":"https://railmapgen.github.io/")+"?"+t.toString();return e.jsx(v,{as:"section",sx:Vn,children:e.jsxs(v,{children:[e.jsxs(v,{className:"nav-menu__header",children:[e.jsx(z,{as:"h4",size:"md",children:n("Rail Map Toolkit")}),e.jsx(Ze,{environment:u.getEnv(),version:u.getAppVersion()})]}),u.getEnv()!=="PRD"&&e.jsxs(T,{status:"warning",children:[e.jsx(E,{}),e.jsxs(Ie,{children:[n("You're currently viewing a testing environment.")," ",e.jsx(V,{href:i,isExternal:!0,children:n("Back to production environment")})]})]}),e.jsxs(v,{className:"nav-menu__body",children:[e.jsx(zn,{}),e.jsx(wn,{})]}),e.jsx(Wn,{})]})})}function Fn(n){const{isOpen:t,onClose:i}=n,{t:s}=m(),o=p.useRef(null),c=()=>{u.allowAnalytics(!0),i()},r=()=>{u.allowAnalytics(!1).refreshRequired?window.location.reload():i()};return e.jsxs(C,{initialFocusRef:o,isOpen:t,onClose:()=>{},children:[e.jsx(L,{}),e.jsxs(H,{children:[e.jsx(y,{children:s("CookiesModal.header")}),e.jsxs(S,{children:[e.jsx(f,{children:s("CookiesModal.text1")}),e.jsx(f,{mt:2,children:s("CookiesModal.text2")}),e.jsx(De,{children:e.jsxs(_e,{children:[" ",s("CookiesModal.item1")]})}),e.jsx(f,{mt:2,children:s("CookiesModal.text3")})]}),e.jsx(A,{children:e.jsxs(F,{children:[e.jsx(j,{variant:"ghost",onClick:r,children:s("CookiesModal.reject")}),e.jsx(j,{ref:o,colorScheme:"primary",onClick:c,children:s("CookiesModal.accept")})]})})]})]})}const qn=()=>{};function Yn(){const{t:n}=m(),[t,i]=p.useState(!1),s=()=>{i(!0),Je(),setTimeout(()=>{window.location.reload()},1e3)};return e.jsx(C,{isOpen:!0,onClose:qn,children:e.jsxs(H,{children:[e.jsx(y,{children:n("Rail Map Toolkit is opened in another window")}),e.jsx(S,{children:n("You cannot open multiple Rail Map Toolkit at the same time. Please close this window.")}),e.jsx(A,{children:e.jsx(j,{colorScheme:"primary",onClick:s,isLoading:t,children:n("Restart RMT in this window")})})]})})}const Qn=()=>{};function Zn(){const{t:n}=m();return e.jsx(C,{isOpen:!0,onClose:Qn,children:e.jsxs(H,{children:[e.jsx(y,{children:n("Rail Map Toolkit is opened in another window")}),e.jsx(S,{children:n("Current session has been terminated. Please close this window.")})]})})}function et(){const{t:n}=m(),t=pe(),{isPrimary:i,isTerminated:s,isShowMenu:o}=Z(a=>a.app),[c,r]=p.useState(!1);p.useEffect(()=>{u.isAnalyticsQADone()||r(!0)},[]);const h=()=>{u.toggleNavMenu(!o),t(U()),u.event(w.TOGGLE_NAV_MENU,{})};return s?e.jsx($,{children:e.jsx(Zn,{})}):i===!1?e.jsx($,{children:e.jsx(Yn,{})}):e.jsx(Le,{basename:"/",children:e.jsxs($,{className:o?"show-menu":"",children:[e.jsx(I,{variant:o?"ghost":"solid",colorScheme:o?void 0:"primary",size:"md","aria-label":n("Toggle menu"),title:n("Toggle menu"),icon:e.jsx(un,{}),position:"absolute",zIndex:110,borderRadius:0,onClick:h}),e.jsxs(Ke,{sx:{flexDirection:"row"},children:[e.jsx(Un,{}),e.jsx(rn,{})]}),e.jsx(Fn,{isOpen:c,onClose:()=>r(!1)})]})})}export{et as default};
